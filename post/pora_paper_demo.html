<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Text Review Page</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
        }

        .container {
            display: flex;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        .left-column, .right-column {
            padding: 20px;
            overflow-y: scroll;
            height: 100%;
            scrollbar-width: thin;
            scrollbar-color: #888 #f1f1f1;
        }

        .left-column {
            width: 60%;
            border-right: 1px solid #ddd;
            background-color: #f9f9f9;
            transition: width 0.3s ease;
        }

        .left-column.expanded {
            width: 100%;
        }

        .right-column {
            width: 40%;
            background-color: #ffffff;
            transition: width 0.3s ease;
        }

        .right-column.hidden {
            width: 0;
            padding: 0;
            overflow: hidden;
        }

        .highlight {
            background-color: #ffff99;
            padding: 2px;
            cursor: pointer;
        }

        .highlight:hover {
            background-color: #ffeb3b;
        }

        .comment {
            margin-bottom: 20px;
            padding-bottom: 10px;
            cursor: pointer;
        }

        .comment-collection {
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .comment-collection-header {
            padding: 10px 15px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            color: #333;
        }

        .header-preview {
            font-size: 0.9em;
            color: #555;
            margin-top: 4px;
        }

        .comment-collection-content {
            display: none;
            padding: 10px 15px;
        }

        .comment-collection-content.expanded {
            display: block;
        }

        .comment-status {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 8px;
        }

        .status-solved {
            background-color: #28a745;
            color: white;
        }

        .status-unsolved {
            background-color: #dc3545;
            color: white;
        }

        .vote-count {
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
        }

        .vote-stats {
            display: inline-flex;
            gap: 8px;
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
        }

        .vote-up {
            color: #28a745;
        }

        .vote-down {
            color: #dc3545;
        }

        .comment-header {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .comment-body {
            color: #555;
            margin-bottom: 10px;
        }

        /* New styles for nested comments */
        .comment-replies {
            margin-left: 20px;
            border-left: 2px solid #e0e0e0;
            padding-left: 15px;
        }

        .comment-reply {
            padding: 8px 0;
            font-size: 0.95em;
        }

        .reply-metadata {
            font-size: 0.85em;
            color: #666;
            margin-top: 4px;
        }

        h1 {
            margin: 0 0 10px 0;
        }

        p {
            line-height: 1.6;
        }

        .sticky-header {
            position: sticky;
            top: 0;
            background-color: #f1f1f1;
            z-index: 10;
            padding: 10px 20px;
            border-bottom: 1px solid #ddd;
        }

        .toggle-button {
            position: fixed;
            right: 20px;
            top: 20px;
            padding: 8px 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 100;
        }

        .toggle-button:hover {
            background-color: #45a049;
        }

        /* Update flash effect CSS */
        @keyframes flash-highlight {
            0% {
                background-color: #fff7d1;
                transform: scale(1);
            }
            50% {
                background-color: #ffe066;
                transform: scale(1.02);
            }
            100% {
                background-color: #f8f9fa;
                transform: scale(1);
            }
        }

        .comment-collection-header.flash-effect {
            animation: flash-highlight 1s ease-out;
        }

        /* Webkit scrollbar styling */
        .left-column::-webkit-scrollbar,
        .right-column::-webkit-scrollbar {
            width: 8px;
        }

        .left-column::-webkit-scrollbar-track,
        .right-column::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .left-column::-webkit-scrollbar-thumb,
        .right-column::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .left-column::-webkit-scrollbar-thumb:hover,
        .right-column::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Add toggle button -->
    <button class="toggle-button" id="toggleComments">Hide Comments</button>

    <!-- Left Column: Text Content -->
    <div class="left-column">
        <title>Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios</title>

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="./pora_paper_demo_files/bootstrap.min.css" type="text/css">
        <link rel="stylesheet" href="./pora_paper_demo_files/ar5iv.0.7.9.min.css" type="text/css">
        <link rel="stylesheet" href="./pora_paper_demo_files/ar5iv-fonts.0.7.9.min.css" type="text/css">
        <link rel="stylesheet" href="./pora_paper_demo_files/latexml_styles.css" type="text/css">
        <script src="./pora_paper_demo_files/bootstrap.bundle.min.js"></script>
        <script src="./pora_paper_demo_files/html2canvas.min.js"></script>
        <script src="./pora_paper_demo_files/addons_new.js"></script>
        <!--<script src="./pora_paper_demo_files/feedbackOverlay.js"></script>-->
        <link rel="stylesheet" href="./pora_paper_demo_files/utz6mli.css">
<!--        <link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32">-->
        </head>
        <body data-new-gr-c-s-check-loaded="14.1218.0" data-gr-ext-installed="">

        <div class="ltx_page_main" id="main">
            <!--<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>-->

            <!--      <div id="listIcon" type="button" class="hide">-->
            <!--          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">-->
            <!--          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>-->
            <!--          </svg>-->
            <!--        </div>-->
            <!--&lt;!&ndash;      <div id="arrowIcon" type="button">&ndash;&gt;-->
            <!--&lt;!&ndash;          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">&ndash;&gt;-->
            <!--&lt;!&ndash;          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>&ndash;&gt;-->
            <!--&lt;!&ndash;          </svg>&ndash;&gt;-->
            <!--&lt;!&ndash;      </div>&ndash;&gt;-->
            <!--    <ol class="ltx_toclist">-->
            <!--&lt;!&ndash;        <li class="ltx_tocentry ltx_tocentry_section">&ndash;&gt;-->
            <!--&lt;!&ndash;    <a class="ltx_ref" href="./pora_paper_demo.html#abstract" title="Abstract">&ndash;&gt;-->
            <!--&lt;!&ndash;      <span class="ltx_text ltx_ref_title">&ndash;&gt;-->
            <!--&lt;!&ndash;        <span class="ltx_tag ltx_tag_ref"></span>&ndash;&gt;-->
            <!--&lt;!&ndash;        Abstract&ndash;&gt;-->
            <!--&lt;!&ndash;      </span>&ndash;&gt;-->
            <!--&lt;!&ndash;    </a></li>&ndash;&gt;-->
            <!--<li class="ltx_tocentry ltx_tocentry_section"><a href="./pora_paper_demo.html#S1" title="In Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_section">-->
            <!--<a href="./pora_paper_demo.html#S2" title="In Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>-->
            <!--<ol class="ltx_toclist ltx_toclist_section">-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection"><a href="./pora_paper_demo.html#S2.SS1" title="In 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>General End-to-End Differentiable Architecture</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection">-->
            <!--<a href="./pora_paper_demo.html#S2.SS2" title="In 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Heatmap Prediction Framework</span></a>-->
            <!--<ol class="ltx_toclist ltx_toclist_subsection">-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S2.SS2.SSS1" title="In 2.2 Heatmap Prediction Framework ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Encoder: Transformer-based Context Extractor</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S2.SS2.SSS2" title="In 2.2 Heatmap Prediction Framework ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Decoder: GAN-based Occupancy Heatmap Generator</span></a></li>-->
            <!--</ol>-->
            <!--</li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection">-->
            <!--<a href="./pora_paper_demo.html#S2.SS3" title="In 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Modular Training Approach</span></a>-->
            <!--<ol class="ltx_toclist ltx_toclist_subsection">-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S2.SS3.SSS1" title="In 2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Independent Decoder Training</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S2.SS3.SSS2" title="In 2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Encoder Training with Fixed Decoder</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S2.SS3.SSS3" title="In 2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.3 </span>End-to-End Fine-Tuning</span></a></li>-->
            <!--</ol>-->
            <!--</li>-->
            <!--</ol>-->
            <!--</li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_section">-->
            <!--<a href="./pora_paper_demo.html#S3" title="In Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiments and Results</span></a>-->
            <!--<ol class="ltx_toclist ltx_toclist_section">-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection"><a href="./pora_paper_demo.html#S3.SS1" title="In 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experimental Setup</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection">-->
            <!--<a href="./pora_paper_demo.html#S3.SS2" title="In 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Training Procedure</span></a>-->
            <!--<ol class="ltx_toclist ltx_toclist_subsection">-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S3.SS2.SSS1" title="In 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Initial Decoder Training Using GAN</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S3.SS2.SSS2" title="In 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Encoder-Decoder Integration and Encoder Training</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="./pora_paper_demo.html#S3.SS2.SSS3" title="In 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Decoder Fine-Tuning</span></a></li>-->
            <!--</ol>-->
            <!--</li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_subsection"><a href="./pora_paper_demo.html#S3.SS3" title="In 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Comparative Analysis of Heatmap Predictions</span></a></li>-->
            <!--</ol>-->
            <!--</li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_section"><a href="./pora_paper_demo.html#S4" title="In Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Discussion</span></a></li>-->
            <!--<li class="ltx_tocentry ltx_tocentry_section">-->
            <!--    <a class="ltx_ref" href="./pora_paper_demo.html#bib" title="References">-->
            <!--      <span class="ltx_text ltx_ref_title">-->
            <!--        <span class="ltx_tag ltx_tag_ref"></span>-->
            <!--        References-->
            <!--      </span>-->
            <!--    </a></li></ol></nav>-->

            <div class="ltx_page_content">
                <article class="ltx_document ltx_authors_1line">
                    <h1 class="ltx_title ltx_title_document">Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios</h1>
                    <div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<br class="ltx_break">Han Wang,
<br class="ltx_break">University of California, Berkeley
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">hanw@berkeley.edu</span>
<br class="ltx_break">Yuneil Yeo,
<br class="ltx_break">University of California, Berkeley
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">yuneily@berkeley.edu</span>
<br class="ltx_break">Antonio R.&nbsp;Paiva,
<br class="ltx_break">Allstate D3 Analytics Innovation
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">Antonio.Paiva@allstate.com</span>
<br class="ltx_break">Jean Utke,
<br class="ltx_break">Allstate D3 Analytics Innovation
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">jutke@allstate.com</span>
<br class="ltx_break">Maria Laura Delle Monache,
<br class="ltx_break">University of California, Berkeley
<br class="ltx_break"><span id="id5.5.id5" class="ltx_text ltx_font_typewriter">mldellemonache@berkeley.edu</span>
<br class="ltx_break">
</span></span>
                    </div>

                    <div class="ltx_abstract" id="abstract">
                        <h6 class="ltx_title ltx_title_abstract">Abstract</h6>
                        <p id="id6.id1" class="ltx_p">We propose a modular modeling framework designed to enhance the capture and validation of uncertainty in autonomous vehicle (AV) trajectory prediction. Departing from traditional deterministic methods, our approach employs a flexible, end-to-end differentiable probabilistic encoder-decoder architecture. This modular design allows the encoder and decoder to be trained independently, enabling seamless adaptation to diverse traffic scenarios without retraining the entire system. Our key contributions include: (1) a probabilistic heatmap predictor that generates context-aware occupancy grids for dynamic forecasting, (2) a modular training approach that supports independent component training and flexible adaptation, and (3) a structured validation scheme leveraging uncertainty metrics to evaluate robustness under high-risk conditions. To highlight the benefits of our framework, we benchmark it against an end-to-end baseline, demonstrating faster convergence, improved stability, and flexibility. <span class="highlight" data-comment="comment5">Experimental results validate these advantages, showcasing the capacity of the framework to efficiently handle complex scenarios while ensuring reliable predictions and robust uncertainty representation. </span>This modular design offers <span class="highlight" data-comment="comment6">Asignificant practical utility and scalability</span> for real-world autonomous driving applications.</p>
                    </div>
                    <div id="p1" class="ltx_para ltx_noindent">
                        <p id="p1.1" class="ltx_p"><em id="p1.1.1" class="ltx_emph ltx_font_bold ltx_font_italic">K</em><span id="p1.1.2" class="ltx_text ltx_font_bold">eywords</span> Modular Framework,
                            Generative Model,
                            Probabilistic Motion Prediction,
                            Autonomous Vehicles
                        </p>
                    </div>
                    <section id="S1" class="ltx_section">
                        <h2 class="ltx_title ltx_title_section">
                            <span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

                        <div id="S1.p1" class="ltx_para ltx_noindent">
                            <p id="S1.p1.1" class="ltx_p"><span class="highlight" data-comment="comment1">Autonomous vehicle&nbsp;(AV) driving has emerged as a transformative technology with the potential to revolutionize transportation systems. Previous research presents the potential of improving the fuel efficiency and throughput of overall traffic flow via a small penetration rate of AV<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib1">1</a>, <a href="./pora_paper_demo_backup.html#bib.bib2" title="" class="ltx_ref">2</a>, <a href="./pora_paper_demo_backup.html#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</span> A critical component of this paradigm is trajectory prediction, which involves forecasting the future positions of vehicles and other road users. Accurate predictions are essential for ensuring safety and operational efficiency in dynamic traffic environments. However, inherent uncertainties in road conditions, driver behaviors, and sensor inaccuracies pose significant challenges to conventional trajectory prediction models.</p>
                        </div>
                        <div id="S1.p2" class="ltx_para ltx_noindent">
                            <p id="S1.p2.1" class="ltx_p"><span class="highlight" data-comment="comment2">Existing approaches in AV trajectory prediction typically rely on deterministic models, which assume a single, most likely outcome for vehicle trajectories&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</span> While these methods are computationally efficient, they fail to capture the uncertainty inherent in real-world driving scenarios. Probabilistic models have been introduced to address this limitation, offering predictions in the form of distributions or likelihoods over future trajectories&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Weng&nbsp;et&nbsp;al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib6" title="" class="ltx_ref">6</a>]</cite> proposed PARA-Drive, a modular and differentiable framework for trajectory prediction in autonomous driving, enabling interpretable multi-agent interaction modeling through occupancy prediction and action refinement. Despite these advancements, most models are limited by their monolithic training frameworks, which often compromise flexibility and adaptability across diverse traffic conditions.</p>
                        </div>
                        <div id="S1.p3" class="ltx_para ltx_noindent">
                            <p id="S1.p3.1" class="ltx_p">Several studies have identified limitations in conventional trajectory prediction systems, particularly in representing uncertainty. Probabilistic models, such as Gaussian Mixture Models&nbsp;(GMMs) and Variational Autoencoders&nbsp;(VAEs), have been employed to forecast multiple plausible future trajectories&nbsp;&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib5" title="" class="ltx_ref">5</a>, <a href="./pora_paper_demo_backup.html#bib.bib7" title="" class="ltx_ref">7</a>, <a href="./pora_paper_demo_backup.html#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. However, these approaches face challenges in dynamic traffic environments with unpredictable agent interactions&nbsp;&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib9" title="" class="ltx_ref">9</a>, <a href="./pora_paper_demo_backup.html#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
                        </div>
                        <div id="S1.p4" class="ltx_para ltx_noindent">
                            <p id="S1.p4.1" class="ltx_p">GMMs assume that data can be represented as a mixture of Gaussian distributions, which may not capture the complexity of real-world driving scenarios. This can lead to oversimplified predictions, especially in situations involving abrupt lane changes or unconventional maneuvers. For example, Wiederer et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib9" title="" class="ltx_ref">9</a>]</cite> noted that GMMs might not effectively model the intricacies of dynamic traffic environments.</p>
                        </div>
                        <div id="S1.p5" class="ltx_para ltx_noindent">
                            <p id="S1.p5.1" class="ltx_p">VAEs provide a framework for learning variational models using neural networks and can incorporate various distributional assumptions, including GMMs, within their latent spaces. The flexibility of VAEs depends on the choice of prior and variational distributions. For instance, Neumeier&nbsp;et&nbsp;al.&nbsp;&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib7" title="" class="ltx_ref">7</a>]</cite> introduced a VAE-based vehicle trajectory prediction model with an interpretable latent space, demonstrating the adaptability of VAEs in modeling complex behaviors. However, selecting the appropriate number of components in GMMs remains a challenge. An incorrect choice can result in models that either fail to capture all relevant behaviors or include redundant components, complicating the prediction process. Salzmann et al.&nbsp;&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib11" title="" class="ltx_ref">11</a>]</cite> addressed this by employing a VAE with a GMM before modeling multimodal human trajectories, highlighting the importance of choosing suitable model structures.</p>
                        </div>
                        <div id="S1.p6" class="ltx_para ltx_noindent">
                            <p id="S1.p6.1" class="ltx_p">While probabilistic models like GMMs and VAEs offer frameworks for capturing uncertainties in trajectory prediction, their effectiveness is contingent upon appropriate modeling choices and assumptions. Careful selection of model parameters and structures is essential to represent the complexities of real-world driving scenarios accurately.</p>
                        </div>
                        <div id="S1.p7" class="ltx_para ltx_noindent">
                            <p id="S1.p7.1" class="ltx_p">Another notable challenge in existing trajectory prediction methods is the flexibility of the architectures in tackling different tasks or transferring pretraining to other scenarios. Many state-of-the-art models rely on monolithic encoder-decoder frameworks trained end-to-end to maximize overall performance. While these frameworks can deliver high predictive accuracy, their lack of modularity makes it difficult to adapt individual components to task-specific requirements. For example, in situations where distinct prediction objectives such as occupancy heatmaps and precise trajectory forecasts are needed, jointly trained models cannot effectively optimize for each task independently&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. This limitation reduces the adaptability of these models when deployed in new environments or when required to incorporate additional data modalities, such as high-definition maps or updated traffic behavior models. While retraining a monolithic model might be feasible in certain offline settings, such an approach becomes impractical in scenarios requiring frequent updates or real-time adaptation. For instance, autonomous vehicle systems operating in diverse geographical regions must continuously integrate new data reflecting local traffic dynamics, infrastructure changes, or weather variations. In such cases, retraining a monolithic model incurs repeated computational costs and delays in deployment, which can be particularly detrimental for time-sensitive applications.
                            </p>
                        </div>
                        <div id="S1.p8" class="ltx_para ltx_noindent">
                            <p id="S1.p8.1" class="ltx_p">Moreover, certain edge-case scenarios necessitate on-board or online model adaptation. For example, in rapidly evolving traffic conditions, such as during natural disasters or unexpected road closures, retraining the entire model offline is infeasible due to time constraints. Modular frameworks, by contrast, allow selective retraining of specific components, such as decoders for occupancy heatmaps, without requiring end-to-end retraining. This adaptability not only reduces computational overhead but also facilitates rapid updates to maintain performance parity or even improve over monolithic models.</p>
                        </div>
                        <div id="S1.p9" class="ltx_para ltx_noindent">
                            <p id="S1.p9.1" class="ltx_p">The semantic representation method of features is also an important design dimension that affects the learning-based control systems<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib6" title="" class="ltx_ref">6</a>, <a href="./pora_paper_demo_backup.html#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Besides static prediction of deterministic trajectory, heatmap-based occupancy predictors have emerged as a promising solution to capture the probabilistic distribution of future positions&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. However, these models frequently fail to integrate contextual information from the surrounding traffic environment effectively. This limitation results in predictions that may be spatially coherent but contextually irrelevant, such as assigning high probabilities to non-drivable areas or neglecting critical cues from the trajectories of other road users&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. Furthermore, the temporal resolution of these predictors often does not align well with the dynamic nature of real-time traffic, leading to delayed or overly smoothed predictions that hinder the ability to respond to rapidly evolving scenarios&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
                        </div>
                        <div id="S1.p10" class="ltx_para ltx_noindent">
                            <p id="S1.p10.1" class="ltx_p"><span class="highlight" data-comment="comment7">To address these challenges, this paper introduces a modular framework for autonomous vehicle trajectory prediction, with a focus on probabilistic occupancy heatmap generation.</span> The proposed methodology builds on the limitations of existing models by:</p>
                            <ul id="S1.I1" class="ltx_itemize">
                                <li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
                                    <span class="ltx_tag ltx_tag_item">•</span>
                                    <div id="S1.I1.i1.p1" class="ltx_para">
                                        <p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Introducing a Modular Training Approach:</span> This framework decouples the training of encoders and decoders, allowing for independent optimization and greater adaptability to task-specific requirements.</p>
                                    </div>
                                </li>
                                <li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
                                    <span class="ltx_tag ltx_tag_item">•</span>
                                    <div id="S1.I1.i2.p1" class="ltx_para">
                                        <p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Developing a Heatmap Predictor:</span> By generating probabilistic occupancy grids, the model provides context-sensitive uncertainty representation, enhancing AV systems’ ability to anticipate and mitigate potential collisions.</p>
                                    </div>
                                </li>
                                <li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
                                    <span class="ltx_tag ltx_tag_item">•</span>
                                    <div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
                                        <p id="S1.I1.i3.p1.1" class="ltx_p"><span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Designing a Robust Validation Scheme:</span> The framework evaluates performance using uncertainty-aware metrics, demonstrating its efficacy across diverse traffic scenarios.</p>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div id="S1.p11" class="ltx_para ltx_noindent">
                            <p id="S1.p11.1" class="ltx_p">Experimental evaluations using real-world (Argoverse&nbsp;2) and simulated datasets (SUMO) demonstrate that the modular framework significantly improves spatial alignment and predictive accuracy. The model achieves state-of-the-art performance in uncertainty representation, validated through comparisons with baseline architectures.</p>
                        </div>
                        <figure id="S1.F1" class="ltx_figure"><img src="./pora_paper_demo_files/hm_flow_1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="256" alt="Refer to caption">
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Proposed Modular Framework for Autonomous Vehicle Prediction Tasks: The framework comprises an upstream perception layer, a general encoder, and task-specific decoders. The perception layer collects data from onboard sensors, V2X, and other sources, which the encoder processes into a latent matrix capturing spatial and temporal information. This matrix is shared across decoders, enabling specialized tasks like occupancy and trajectory prediction. The modular design allows independent optimization of the encoder and decoders, enhancing adaptability and supporting task-specific fine-tuning while maintaining end-to-end differentiability. This paper emphasizes the encoder and decoder levels, focusing on uncertainty modeling through occupancy heatmap generation.</figcaption>
                        </figure>
                    </section>
                    <section id="S2" class="ltx_section">
                        <h2 class="ltx_title ltx_title_section">
                            <span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>

                        <div id="S2.p1" class="ltx_para ltx_noindent">
                            <p id="S2.p1.1" class="ltx_p">In this section, we introduce our end-to-end differentiable modular framework designed for autonomous vehicle (AV) prediction tasks. This flexible architecture, illustrated in Fig.&nbsp;<a href="./pora_paper_demo_backup.html#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, consists of a general encoder that processes upstream perception data and multiple task-specialized decoders that cater to distinct prediction needs. A key novelty of our approach is the independent training of encoder and decoder components, which allows efficient adaptation to new tasks without reconfiguring the entire model. To illustrate the power of this modular framework, we focus on probabilistic occupancy heatmap prediction, a task particularly well-suited for capturing spatial uncertainty in dynamic traffic scenarios.</p>
                        </div>
                        <div id="S2.p2" class="ltx_para ltx_noindent">
                            <p id="S2.p2.1" class="ltx_p">Heatmaps provide a probabilistic view of future vehicle positions by discretizing the spatial environment into grid cells, each representing the likelihood of occupancy at specific future times. This method allows us to quantify uncertainty in vehicle trajectories and enables the AV system to anticipate potential collisions and adapt to varying traffic conditions. Figures <a href="./pora_paper_demo_backup.html#S2.F3" title="Figure 3 ‣ 2.2 Heatmap Prediction Framework ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="./pora_paper_demo_backup.html#S2.F4" title="Figure 4 ‣ 2.2 Heatmap Prediction Framework ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> detail the encoder-decoder structure and the modular training methodology used in our heatmap prediction framework.</p>
                        </div>
                        <section id="S2.SS1" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">2.1 </span>General End-to-End Differentiable Architecture</h3>

                            <div id="S2.SS1.p1" class="ltx_para ltx_noindent">
                                <p id="S2.SS1.p1.1" class="ltx_p">Our proposed architecture is a modular, end-to-end differentiable framework designed to accommodate diverse prediction tasks required for autonomous vehicle (AV) control, as shown in Figure <a href="./pora_paper_demo_backup.html#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The framework begins at the encoder level, where incoming data from perception systems (e.g., onboard sensors and V2X communication) and location-centered roadway information are processed to produce a shared latent representation. This latent representation, structured as a latent matrix or feature pool, captures spatial and temporal dependencies essential for downstream prediction tasks.</p>
                            </div>
                            <div id="S2.SS1.p2" class="ltx_para ltx_noindent">
                                <p id="S2.SS1.p2.1" class="ltx_p">The encoder level operates as a general feature extractor, transforming raw input data into high-dimensional embeddings that encapsulate relevant environmental and contextual information. This latent matrix then serves as a shared resource, providing a common feature space for multiple task-specific decoders, each tailored to a unique prediction objective, such as occupancy prediction, trajectory forecasting, or other specialized tasks.</p>
                            </div>
                            <div id="S2.SS1.p3" class="ltx_para ltx_noindent">
                                <p id="S2.SS1.p3.1" class="ltx_p">At the decoder level, the architecture supports a range of task-specialized decoders, each independently optimized for its respective prediction task. This setup allows for flexible and modular adaptation, where new decoders can be integrated or existing ones replaced without retraining the entire system. For example, distinct decoders could be tailored for predicting trajectories of specific agent types such as pedestrians, bicyclists, and motorized vehicles, each of which exhibits unique motion patterns and interaction dynamics. Additionally, task-specialized decoders may address scenarios requiring occupancy heatmaps for high-risk areas like intersections or trajectory forecasts for highway merging zones. These decoders leverage the shared latent representation generated by the encoder, ensuring the contextual richness of predictions while adapting to the specific requirements of each task.</p>
                            </div>
                            <div id="S2.SS1.p4" class="ltx_para ltx_noindent">
                                <p id="S2.SS1.p4.1" class="ltx_p">The primary advantage of this modular design is its ability to independently train encoder and decoder components, which enhances flexibility and adaptability. By allowing separate optimization of each module, the framework maintains high adaptability to new tasks and scenarios while preserving end-to-end differentiability, facilitating efficient fine-tuning when required. In this paper, we demonstrate this modular framework through a focus on probabilistic occupancy heatmap prediction, which serves as a case study to showcase the model’s ability to capture uncertainty in dynamic traffic environments.</p>
                            </div>
                            <figure id="S2.F2" class="ltx_figure"><img src="./pora_paper_demo_files/hm_elements.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="216" height="306" alt="Refer to caption">
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration of the elements in the traffic scenario: traffic (including AV), target vehicle and map.</figcaption>
                            </figure>
                        </section>
                        <section id="S2.SS2" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">2.2 </span>Heatmap Prediction Framework</h3>

                            <div id="S2.SS2.p1" class="ltx_para ltx_noindent">
                                <p id="S2.SS2.p1.1" class="ltx_p">Figure&nbsp;<a href="./pora_paper_demo_backup.html#S2.F2" title="Figure 2 ‣ 2.1 General End-to-End Differentiable Architecture ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> provides an illustration of the elements in the traffic scenario of interest. The target vehicle (green) is the subject of prediction, and the goal is to generate a probabilistic heatmap predicting the future spatial positions that are likely to be occupied by this vehicle. Surrounding traffic (orange), including the autonomous vehicle (blue, labeled as "AV"), contributes contextual information, such as trajectories and interactions, that influence the target vehicle’s motion. The map data includes lane boundaries and road structure, which provide static environmental context. This prediction task enables the AV to anticipate the target vehicle’s future positions, helping it adapt its driving strategy to avoid potential collisions, maintain safe distances, or make informed decisions about lane changes and merging in dynamic traffic environments.</p>
                            </div>
                            <div id="S2.SS2.p2" class="ltx_para ltx_noindent">
                                <p id="S2.SS2.p2.5" class="ltx_p">To implement the proposed architecture with a specific prediction task, we introduce the realtime probabilistic occupancy heatmap prediction using the map and trajectory data of target and traffic vehicles. Let <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="H_{t_{k}}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">H</mi><msub id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS2.p2.1.m1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.3.2.cmml">t</mi><mi id="S2.SS2.p2.1.m1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝐻</ci><apply id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">H_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> represent the heatmap at future time <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">t</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑡</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, where each grid cell in <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="H_{t_{k}}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">H</mi><msub id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml"><mi id="S2.SS2.p2.3.m3.1.1.3.2" xref="S2.SS2.p2.3.m3.1.1.3.2.cmml">t</mi><mi id="S2.SS2.p2.3.m3.1.1.3.3" xref="S2.SS2.p2.3.m3.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝐻</ci><apply id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.3.1.cmml" xref="S2.SS2.p2.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.3.2.cmml" xref="S2.SS2.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS2.p2.3.m3.1.1.3.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">H_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> denotes the occupancy probability of the target vehicle. At any given time <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="t_{0}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">t</mi><mn id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">t_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, the objective is to predict these heatmaps over <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.1d">italic_K</annotation></semantics></math> future time steps to anticipate potential occupancy of the target vehicle. Formally, we aim to compute the heatmap of a target vehicle (i.e., predict the motion for each of the vehicles surrounding the AV):</p>
                            </div>
                            <div id="S2.SS2.p3" class="ltx_para ltx_noindent">
                                <table id="S2.E1" class="ltx_equation ltx_eqn_table">

                                    <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="H_{t_{k}}=F(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic}},\mathbf{M};%
\theta_{e},\theta_{d})," display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml"><msub id="S2.E1.m1.2.2.1.1.6" xref="S2.E1.m1.2.2.1.1.6.cmml"><mi id="S2.E1.m1.2.2.1.1.6.2" xref="S2.E1.m1.2.2.1.1.6.2.cmml">H</mi><msub id="S2.E1.m1.2.2.1.1.6.3" xref="S2.E1.m1.2.2.1.1.6.3.cmml"><mi id="S2.E1.m1.2.2.1.1.6.3.2" xref="S2.E1.m1.2.2.1.1.6.3.2.cmml">t</mi><mi id="S2.E1.m1.2.2.1.1.6.3.3" xref="S2.E1.m1.2.2.1.1.6.3.3.cmml">k</mi></msub></msub><mo id="S2.E1.m1.2.2.1.1.5" xref="S2.E1.m1.2.2.1.1.5.cmml">=</mo><mrow id="S2.E1.m1.2.2.1.1.4" xref="S2.E1.m1.2.2.1.1.4.cmml"><mi id="S2.E1.m1.2.2.1.1.4.6" xref="S2.E1.m1.2.2.1.1.4.6.cmml">F</mi><mo id="S2.E1.m1.2.2.1.1.4.5" xref="S2.E1.m1.2.2.1.1.4.5.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.4.4.4" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.1.4.4.4.5" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">(</mo><msub id="S2.E1.m1.2.2.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml">𝐓</mi><mtext id="S2.E1.m1.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3a.cmml">target</mtext></msub><mo id="S2.E1.m1.2.2.1.1.4.4.4.6" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S2.E1.m1.2.2.1.1.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.1.1.2.2.2.2.2" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml">𝐓</mi><mtext id="S2.E1.m1.2.2.1.1.2.2.2.2.3" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3a.cmml">traffic</mtext></msub><mo id="S2.E1.m1.2.2.1.1.4.4.4.7" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">,</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐌</mi><mo id="S2.E1.m1.2.2.1.1.4.4.4.8" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">;</mo><msub id="S2.E1.m1.2.2.1.1.3.3.3.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S2.E1.m1.2.2.1.1.3.3.3.3.2" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.3.3.3.3.3" xref="S2.E1.m1.2.2.1.1.3.3.3.3.3.cmml">e</mi></msub><mo id="S2.E1.m1.2.2.1.1.4.4.4.9" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">,</mo><msub id="S2.E1.m1.2.2.1.1.4.4.4.4" xref="S2.E1.m1.2.2.1.1.4.4.4.4.cmml"><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.2" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.1.1.4.4.4.4.3" xref="S2.E1.m1.2.2.1.1.4.4.4.4.3.cmml">d</mi></msub><mo stretchy="false" id="S2.E1.m1.2.2.1.1.4.4.4.10" xref="S2.E1.m1.2.2.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1"><eq id="S2.E1.m1.2.2.1.1.5.cmml" xref="S2.E1.m1.2.2.1.1.5"></eq><apply id="S2.E1.m1.2.2.1.1.6.cmml" xref="S2.E1.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.1.cmml" xref="S2.E1.m1.2.2.1.1.6">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.6.2.cmml" xref="S2.E1.m1.2.2.1.1.6.2">𝐻</ci><apply id="S2.E1.m1.2.2.1.1.6.3.cmml" xref="S2.E1.m1.2.2.1.1.6.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.6.3.1.cmml" xref="S2.E1.m1.2.2.1.1.6.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.6.3.2.cmml" xref="S2.E1.m1.2.2.1.1.6.3.2">𝑡</ci><ci id="S2.E1.m1.2.2.1.1.6.3.3.cmml" xref="S2.E1.m1.2.2.1.1.6.3.3">𝑘</ci></apply></apply><apply id="S2.E1.m1.2.2.1.1.4.cmml" xref="S2.E1.m1.2.2.1.1.4"><times id="S2.E1.m1.2.2.1.1.4.5.cmml" xref="S2.E1.m1.2.2.1.1.4.5"></times><ci id="S2.E1.m1.2.2.1.1.4.6.cmml" xref="S2.E1.m1.2.2.1.1.4.6">𝐹</ci><vector id="S2.E1.m1.2.2.1.1.4.4.5.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4"><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.2">𝐓</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S2.E1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.3">target</mtext></ci></apply><apply id="S2.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.2">𝐓</ci><ci id="S2.E1.m1.2.2.1.1.2.2.2.2.3a.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S2.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.1.1.2.2.2.2.3">traffic</mtext></ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐌</ci><apply id="S2.E1.m1.2.2.1.1.3.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.3.3.3.3.3.cmml" xref="S2.E1.m1.2.2.1.1.3.3.3.3.3">𝑒</ci></apply><apply id="S2.E1.m1.2.2.1.1.4.4.4.4.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.4.4.4.4.1.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.2.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.2">𝜃</ci><ci id="S2.E1.m1.2.2.1.1.4.4.4.4.3.cmml" xref="S2.E1.m1.2.2.1.1.4.4.4.4.3">𝑑</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">H_{t_{k}}=F(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic}},\mathbf{M};%
                                            \theta_{e},\theta_{d}),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_F ( bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT , bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT , bold_M ; italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
                                    </tr></tbody>
                                </table>
                                <p id="S2.SS2.p3.3" class="ltx_p">where <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mi id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.1.m1.1d">italic_F</annotation></semantics></math> denotes the end-to-end differentiable function with parameters <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\theta_{e}" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><msub id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mi id="S2.SS2.p3.2.m2.1.1.2" xref="S2.SS2.p3.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS2.p3.2.m2.1.1.3" xref="S2.SS2.p3.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.2.cmml" xref="S2.SS2.p3.2.m2.1.1.2">𝜃</ci><ci id="S2.SS2.p3.2.m2.1.1.3.cmml" xref="S2.SS2.p3.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\theta_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> for the encoder and <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\theta_{d}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><msub id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS2.p3.3.m3.1.1.3" xref="S2.SS2.p3.3.m3.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">𝜃</ci><ci id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\theta_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p3.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> for the decoder. The inputs to this function are:</p>
                                <ul id="S2.I1" class="ltx_itemize">
                                    <li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
                                        <span class="ltx_tag ltx_tag_item">•</span>
                                        <div id="S2.I1.i1.p1" class="ltx_para">
                                            <p id="S2.I1.i1.p1.4" class="ltx_p"><math id="S2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{T}_{\text{target}}" display="inline"><semantics id="S2.I1.i1.p1.1.m1.1a"><msub id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml"><mi id="S2.I1.i1.p1.1.m1.1.1.2" xref="S2.I1.i1.p1.1.m1.1.1.2.cmml">𝐓</mi><mtext id="S2.I1.i1.p1.1.m1.1.1.3" xref="S2.I1.i1.p1.1.m1.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><apply id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.1.m1.1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.1.m1.1.1.2.cmml" xref="S2.I1.i1.p1.1.m1.1.1.2">𝐓</ci><ci id="S2.I1.i1.p1.1.m1.1.1.3a.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S2.I1.i1.p1.1.m1.1.1.3.cmml" xref="S2.I1.i1.p1.1.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\mathbf{T}_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math>: Past trajectory data of the target vehicle, represented as <math id="S2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{T}_{\text{target}}=\{\mathbf{x}_{t_{i}}\}_{i=-I}^{0}" display="inline"><semantics id="S2.I1.i1.p1.2.m2.1a"><mrow id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><msub id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.3.2" xref="S2.I1.i1.p1.2.m2.1.1.3.2.cmml">𝐓</mi><mtext id="S2.I1.i1.p1.2.m2.1.1.3.3" xref="S2.I1.i1.p1.2.m2.1.1.3.3a.cmml">target</mtext></msub><mo id="S2.I1.i1.p1.2.m2.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.I1.i1.p1.2.m2.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.cmml"><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝐱</mi><msub id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.3.1" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mrow id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.cmml"><mo id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3a" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.cmml">−</mo><mi id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.2" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.2.cmml">I</mi></mrow></mrow><mn id="S2.I1.i1.p1.2.m2.1.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.1.3.cmml">0</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><eq id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2"></eq><apply id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3.2">𝐓</ci><ci id="S2.I1.i1.p1.2.m2.1.1.3.3a.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="S2.I1.i1.p1.2.m2.1.1.3.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3.3">target</mtext></ci></apply><apply id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.I1.i1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1"><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.2">𝐱</ci><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3"><eq id="S2.I1.i1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><apply id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3"><minus id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3"></minus><ci id="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.1.3.3.2">𝐼</ci></apply></apply></apply><cn type="integer" id="S2.I1.i1.p1.2.m2.1.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">\mathbf{T}_{\text{target}}=\{\mathbf{x}_{t_{i}}\}_{i=-I}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m2.1d">bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT = { bold_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = - italic_I end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math id="S2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{x}_{t_{i}}\in\mathbb{R}^{2}" display="inline"><semantics id="S2.I1.i1.p1.3.m3.1a"><mrow id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml"><msub id="S2.I1.i1.p1.3.m3.1.1.2" xref="S2.I1.i1.p1.3.m3.1.1.2.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.2.2" xref="S2.I1.i1.p1.3.m3.1.1.2.2.cmml">𝐱</mi><msub id="S2.I1.i1.p1.3.m3.1.1.2.3" xref="S2.I1.i1.p1.3.m3.1.1.2.3.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.2.3.2" xref="S2.I1.i1.p1.3.m3.1.1.2.3.2.cmml">t</mi><mi id="S2.I1.i1.p1.3.m3.1.1.2.3.3" xref="S2.I1.i1.p1.3.m3.1.1.2.3.3.cmml">i</mi></msub></msub><mo id="S2.I1.i1.p1.3.m3.1.1.1" xref="S2.I1.i1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.I1.i1.p1.3.m3.1.1.3" xref="S2.I1.i1.p1.3.m3.1.1.3.cmml"><mi id="S2.I1.i1.p1.3.m3.1.1.3.2" xref="S2.I1.i1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mn id="S2.I1.i1.p1.3.m3.1.1.3.3" xref="S2.I1.i1.p1.3.m3.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><apply id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1"><in id="S2.I1.i1.p1.3.m3.1.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1.1"></in><apply id="S2.I1.i1.p1.3.m3.1.1.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.1.2.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.2">𝐱</ci><apply id="S2.I1.i1.p1.3.m3.1.1.2.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.2.3.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.1.2.3.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3.2">𝑡</ci><ci id="S2.I1.i1.p1.3.m3.1.1.2.3.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S2.I1.i1.p1.3.m3.1.1.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m3.1.1.3.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.I1.i1.p1.3.m3.1.1.3.2.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3.2">ℝ</ci><cn type="integer" id="S2.I1.i1.p1.3.m3.1.1.3.3.cmml" xref="S2.I1.i1.p1.3.m3.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">\mathbf{x}_{t_{i}}\in\mathbb{R}^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m3.1d">bold_x start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> denotes position at time <math id="S2.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S2.I1.i1.p1.4.m4.1a"><msub id="S2.I1.i1.p1.4.m4.1.1" xref="S2.I1.i1.p1.4.m4.1.1.cmml"><mi id="S2.I1.i1.p1.4.m4.1.1.2" xref="S2.I1.i1.p1.4.m4.1.1.2.cmml">t</mi><mi id="S2.I1.i1.p1.4.m4.1.1.3" xref="S2.I1.i1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><apply id="S2.I1.i1.p1.4.m4.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m4.1.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.4.m4.1.1.2.cmml" xref="S2.I1.i1.p1.4.m4.1.1.2">𝑡</ci><ci id="S2.I1.i1.p1.4.m4.1.1.3.cmml" xref="S2.I1.i1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.4.m4.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                        </div>
                                    </li>
                                    <li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
                                        <span class="ltx_tag ltx_tag_item">•</span>
                                        <div id="S2.I1.i2.p1" class="ltx_para">
                                            <p id="S2.I1.i2.p1.4" class="ltx_p"><math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{T}_{\text{traffic}}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">𝐓</mi><mtext id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3a.cmml">traffic</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">𝐓</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">traffic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\mathbf{T}_{\text{traffic}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT</annotation></semantics></math>: Trajectories of surrounding traffic objects, <math id="S2.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{T}_{\text{traffic}}=\{\mathbf{T}_{n}\}_{n=1}^{N}" display="inline"><semantics id="S2.I1.i2.p1.2.m2.1a"><mrow id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml"><msub id="S2.I1.i2.p1.2.m2.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.3.2" xref="S2.I1.i2.p1.2.m2.1.1.3.2.cmml">𝐓</mi><mtext id="S2.I1.i2.p1.2.m2.1.1.3.3" xref="S2.I1.i2.p1.2.m2.1.1.3.3a.cmml">traffic</mtext></msub><mo id="S2.I1.i2.p1.2.m2.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.I1.i2.p1.2.m2.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.cmml"><mrow id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><msub id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝐓</mi><mi id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.I1.i2.p1.2.m2.1.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.I1.i2.p1.2.m2.1.1.1.1.3.2" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.2.cmml">n</mi><mo id="S2.I1.i2.p1.2.m2.1.1.1.1.3.1" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.I1.i2.p1.2.m2.1.1.1.1.3.3" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.I1.i2.p1.2.m2.1.1.1.3" xref="S2.I1.i2.p1.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><apply id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1"><eq id="S2.I1.i2.p1.2.m2.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.2"></eq><apply id="S2.I1.i2.p1.2.m2.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.2">𝐓</ci><ci id="S2.I1.i2.p1.2.m2.1.1.3.3a.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.3"><mtext mathsize="70%" id="S2.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.3.3">traffic</mtext></ci></apply><apply id="S2.I1.i2.p1.2.m2.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.2.m2.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.I1.i2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1"><apply id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.2">𝐓</ci><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.1.1.1.3">𝑛</ci></apply></set><apply id="S2.I1.i2.p1.2.m2.1.1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3"><eq id="S2.I1.i2.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.I1.i2.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.I1.i2.p1.2.m2.1.1.1.1.3.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.I1.i2.p1.2.m2.1.1.1.3.cmml" xref="S2.I1.i2.p1.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">\mathbf{T}_{\text{traffic}}=\{\mathbf{T}_{n}\}_{n=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT = { bold_T start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, with each <math id="S2.I1.i2.p1.3.m3.3" class="ltx_Math" alttext="\mathbf{T}_{n}=\{\mathbf{x}_{n,t_{i}}\}_{i=-I}^{0}" display="inline"><semantics id="S2.I1.i2.p1.3.m3.3a"><mrow id="S2.I1.i2.p1.3.m3.3.3" xref="S2.I1.i2.p1.3.m3.3.3.cmml"><msub id="S2.I1.i2.p1.3.m3.3.3.3" xref="S2.I1.i2.p1.3.m3.3.3.3.cmml"><mi id="S2.I1.i2.p1.3.m3.3.3.3.2" xref="S2.I1.i2.p1.3.m3.3.3.3.2.cmml">𝐓</mi><mi id="S2.I1.i2.p1.3.m3.3.3.3.3" xref="S2.I1.i2.p1.3.m3.3.3.3.3.cmml">n</mi></msub><mo id="S2.I1.i2.p1.3.m3.3.3.2" xref="S2.I1.i2.p1.3.m3.3.3.2.cmml">=</mo><msubsup id="S2.I1.i2.p1.3.m3.3.3.1" xref="S2.I1.i2.p1.3.m3.3.3.1.cmml"><mrow id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.2" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.2.cmml">{</mo><msub id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.2" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.2.cmml">𝐱</mi><mrow id="S2.I1.i2.p1.3.m3.2.2.2.2" xref="S2.I1.i2.p1.3.m3.2.2.2.3.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.1.1" xref="S2.I1.i2.p1.3.m3.1.1.1.1.cmml">n</mi><mo id="S2.I1.i2.p1.3.m3.2.2.2.2.2" xref="S2.I1.i2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S2.I1.i2.p1.3.m3.2.2.2.2.1" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1.cmml"><mi id="S2.I1.i2.p1.3.m3.2.2.2.2.1.2" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1.2.cmml">t</mi><mi id="S2.I1.i2.p1.3.m3.2.2.2.2.1.3" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><mo stretchy="false" id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.3" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.I1.i2.p1.3.m3.3.3.1.1.3" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.cmml"><mi id="S2.I1.i2.p1.3.m3.3.3.1.1.3.2" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.2.cmml">i</mi><mo id="S2.I1.i2.p1.3.m3.3.3.1.1.3.1" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.1.cmml">=</mo><mrow id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.cmml"><mo id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3a" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.cmml">−</mo><mi id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.2" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.2.cmml">I</mi></mrow></mrow><mn id="S2.I1.i2.p1.3.m3.3.3.1.3" xref="S2.I1.i2.p1.3.m3.3.3.1.3.cmml">0</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.3b"><apply id="S2.I1.i2.p1.3.m3.3.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3"><eq id="S2.I1.i2.p1.3.m3.3.3.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.2"></eq><apply id="S2.I1.i2.p1.3.m3.3.3.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.3.3.3.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.3">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.3.3.3.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.3.2">𝐓</ci><ci id="S2.I1.i2.p1.3.m3.3.3.3.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3.3.3">𝑛</ci></apply><apply id="S2.I1.i2.p1.3.m3.3.3.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.3.3.1.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1">superscript</csymbol><apply id="S2.I1.i2.p1.3.m3.3.3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.3.3.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1">subscript</csymbol><set id="S2.I1.i2.p1.3.m3.3.3.1.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1"><apply id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.1.1.1.2">𝐱</ci><list id="S2.I1.i2.p1.3.m3.2.2.2.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2"><ci id="S2.I1.i2.p1.3.m3.1.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1.1.1">𝑛</ci><apply id="S2.I1.i2.p1.3.m3.2.2.2.2.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.2.2.2.2.1.1.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.2.2.2.2.1.2.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1.2">𝑡</ci><ci id="S2.I1.i2.p1.3.m3.2.2.2.2.1.3.cmml" xref="S2.I1.i2.p1.3.m3.2.2.2.2.1.3">𝑖</ci></apply></list></apply></set><apply id="S2.I1.i2.p1.3.m3.3.3.1.1.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3"><eq id="S2.I1.i2.p1.3.m3.3.3.1.1.3.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.1"></eq><ci id="S2.I1.i2.p1.3.m3.3.3.1.1.3.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.2">𝑖</ci><apply id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3"><minus id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.1.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3"></minus><ci id="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.2.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.1.3.3.2">𝐼</ci></apply></apply></apply><cn type="integer" id="S2.I1.i2.p1.3.m3.3.3.1.3.cmml" xref="S2.I1.i2.p1.3.m3.3.3.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.3c">\mathbf{T}_{n}=\{\mathbf{x}_{n,t_{i}}\}_{i=-I}^{0}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.3d">bold_T start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = { bold_x start_POSTSUBSCRIPT italic_n , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = - italic_I end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> for object <math id="S2.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.I1.i2.p1.4.m4.1a"><mi id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><ci id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.1d">italic_n</annotation></semantics></math>.</p>
                                        </div>
                                    </li>
                                    <li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
                                        <span class="ltx_tag ltx_tag_item">•</span>
                                        <div id="S2.I1.i3.p1" class="ltx_para ltx_noindent">
                                            <p id="S2.I1.i3.p1.1" class="ltx_p"><math id="S2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S2.I1.i3.p1.1.m1.1a"><mi id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">bold_M</annotation></semantics></math>: Vectorized map data capturing static road elements, such as boundaries and lane markings.</p>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div id="S2.SS2.p4" class="ltx_para ltx_noindent">
                                <p id="S2.SS2.p4.1" class="ltx_p">The architecture allows the encoder to process these inputs into a shared latent representation, which is then fed into multiple decoders for specific tasks, such as occupancy and trajectory prediction. This modular setup enhances flexibility, allowing each encoder-decoder pair to be trained independently for specific prediction tasks.</p>
                            </div>
                            <div id="S2.SS2.p5" class="ltx_para ltx_noindent">
                                <p id="S2.SS2.p5.1" class="ltx_p">Focusing on heatmap prediction provides a means to capture the uncertainty inherent in dynamic traffic environments around AV. Heatmaps are generated as probabilistic occupancy grids, explicitly predicting the likelihood of vehicle presence in specific grid cells over time. These grids represent the occupancy of surrounding vehicles within the scene. By predicting these probabilistic distributions rather than deterministic trajectories, the framework accommodates the unpredictability of surrounding vehicles, providing AVs with a robust tool to anticipate and react to potential risks.</p>
                            </div>
                            <figure id="S2.F3" class="ltx_figure"><img src="./pora_paper_demo_files/hm_encoder.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="217" alt="Refer to caption">
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Attention-Based Encoder for Modular Feature Extraction in Autonomous Vehicle Prediction: in the heatmap prediction case, the encoder processes multiple input streams, including traffic data, map information, and target trajectory, to generate a shared latent representation that captures spatial and temporal dependencies. Each input type is processed independently through self-attention heads, such as the traffic and map heads, which extract relevant features into an environment latent matrix. The cross-attention mechanism further refines this matrix by integrating information across the input sources, producing a unified latent matrix (pool) that serves as a contextual embedding for downstream prediction tasks. During encoder training, a pre-trained decoder with frozen parameters is attached, allowing the encoder to adaptively learn features that align with the input requirements of decoders.</figcaption>
                            </figure>
                            <figure id="S2.F4" class="ltx_figure"><img src="./pora_paper_demo_files/hm_decoder.png" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="527" height="270" alt="Refer to caption">
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Decoder Training Process with Generative Adversarial Network (GAN) for Occupancy Prediction: the encoder is detached to allow independent training of the task-specialized decoder. The decoder utilizes a GAN architecture, where the generator (occupancy predictor or ’heatmapper’) receives input noise and produces probabilistic occupancy heatmaps, representing the likelihood of vehicle occupancy across a spatial grid. The GAN discriminator assesses the realism of these generated heatmaps by distinguishing them from real samples, with an additional ’judge’ component evaluating the output quality based on task-specific metrics. </figcaption>
                            </figure>
                            <section id="S2.SS2.SSS1" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Encoder: Transformer-based Context Extractor</h4>

                                <div id="S2.SS2.SSS1.p1" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS1.p1.5" class="ltx_p">The encoder, parameterized by <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\theta_{e}" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><msub id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2">𝜃</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">\theta_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>, is responsible for extracting meaningful features from the input data <math id="S2.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{T}_{\text{target}}" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><msub id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p1.2.m2.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝐓</mi><mtext id="S2.SS2.SSS1.p1.2.m2.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><apply id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.2">𝐓</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3a.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">\mathbf{T}_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{T}_{\text{traffic}}" display="inline"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><msub id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p1.3.m3.1.1.2" xref="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml">𝐓</mi><mtext id="S2.SS2.SSS1.p1.3.m3.1.1.3" xref="S2.SS2.SSS1.p1.3.m3.1.1.3a.cmml">traffic</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><apply id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.2">𝐓</ci><ci id="S2.SS2.SSS1.p1.3.m3.1.1.3a.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.3"><mtext mathsize="70%" id="S2.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.3">traffic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">\mathbf{T}_{\text{traffic}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m3.1d">bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT</annotation></semantics></math>, and <math id="S2.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{M}" display="inline"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><mi id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">𝐌</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><ci id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">𝐌</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">\mathbf{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.4.m4.1d">bold_M</annotation></semantics></math>, producing a latent matrix <math id="S2.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{Z}\in\mathbb{R}^{d_{z}}" display="inline"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><mrow id="S2.SS2.SSS1.p1.5.m5.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.1.1.2" xref="S2.SS2.SSS1.p1.5.m5.1.1.2.cmml">𝐙</mi><mo id="S2.SS2.SSS1.p1.5.m5.1.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S2.SS2.SSS1.p1.5.m5.1.1.3" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.1.1.3.2" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><msub id="S2.SS2.SSS1.p1.5.m5.1.1.3.3" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.2" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml">d</mi><mi id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.3" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml">z</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><apply id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1"><in id="S2.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.1"></in><ci id="S2.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.2">𝐙</ci><apply id="S2.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3.2">𝑑</ci><ci id="S2.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.3.3.3">𝑧</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">\mathbf{Z}\in\mathbb{R}^{d_{z}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.5.m5.1d">bold_Z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> that captures the spatial and temporal context relevant for prediction. The encoder employs self-attention and cross-attention mechanisms to achieve this.</p>
                                </div>
                                <div id="S2.SS2.SSS1.p2" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS1.p2.3" class="ltx_p">Each input component is first encoded individually. The target vehicle’s trajectory, surrounding traffic, and map data are transformed into embeddings using self-attention (SA) layers. Let <math id="S2.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{E}_{\text{target}}" display="inline"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><msub id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p2.1.m1.1.1.2" xref="S2.SS2.SSS1.p2.1.m1.1.1.2.cmml">𝐄</mi><mtext id="S2.SS2.SSS1.p2.1.m1.1.1.3" xref="S2.SS2.SSS1.p2.1.m1.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><apply id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.2">𝐄</ci><ci id="S2.SS2.SSS1.p2.1.m1.1.1.3a.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S2.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">\mathbf{E}_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.1.m1.1d">bold_E start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S2.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{E}_{\text{traffic}}" display="inline"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><msub id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p2.2.m2.1.1.2" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml">𝐄</mi><mtext id="S2.SS2.SSS1.p2.2.m2.1.1.3" xref="S2.SS2.SSS1.p2.2.m2.1.1.3a.cmml">traffic</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><apply id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.2">𝐄</ci><ci id="S2.SS2.SSS1.p2.2.m2.1.1.3a.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S2.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.3">traffic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">\mathbf{E}_{\text{traffic}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.2.m2.1d">bold_E start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT</annotation></semantics></math>, and <math id="S2.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{E}_{\text{map}}" display="inline"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><msub id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.1.2" xref="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml">𝐄</mi><mtext id="S2.SS2.SSS1.p2.3.m3.1.1.3" xref="S2.SS2.SSS1.p2.3.m3.1.1.3a.cmml">map</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><apply id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.2">𝐄</ci><ci id="S2.SS2.SSS1.p2.3.m3.1.1.3a.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S2.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1.3">map</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">\mathbf{E}_{\text{map}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.3.m3.1d">bold_E start_POSTSUBSCRIPT map end_POSTSUBSCRIPT</annotation></semantics></math> represent these encoded inputs:</p>
                                    <table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

                                        <tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{E}_{\text{target}}" display="inline"><semantics id="S2.E2.m1.1a"><msub id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">𝐄</mi><mtext id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3a.cmml">target</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2">𝐄</ci><ci id="S2.E2.m1.1.1.3a.cmml" xref="S2.E2.m1.1.1.3"><mtext mathsize="70%" id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">target</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\mathbf{E}_{\text{target}}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">bold_E start_POSTSUBSCRIPT target end_POSTSUBSCRIPT</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.1" class="ltx_Math" alttext="\displaystyle=\text{SA}(\mathbf{T}_{\text{target}})\in\mathbb{R}^{d_{z}}," display="inline"><semantics id="S2.E2.m2.1a"><mrow id="S2.E2.m2.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml"><mrow id="S2.E2.m2.1.1.1.1" xref="S2.E2.m2.1.1.1.1.cmml"><mi id="S2.E2.m2.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E2.m2.1.1.1.1.4" xref="S2.E2.m2.1.1.1.1.4.cmml">=</mo><mrow id="S2.E2.m2.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.cmml"><mtext id="S2.E2.m2.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.3a.cmml">SA</mtext><mo id="S2.E2.m2.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m2.1.1.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m2.1.1.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m2.1.1.1.1.1.1.1.1" xref="S2.E2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m2.1.1.1.1.1.1.1.1.2" xref="S2.E2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐓</mi><mtext id="S2.E2.m2.1.1.1.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.1.1.1.3a.cmml">target</mtext></msub><mo stretchy="false" id="S2.E2.m2.1.1.1.1.1.1.1.3" xref="S2.E2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m2.1.1.1.1.5" xref="S2.E2.m2.1.1.1.1.5.cmml">∈</mo><msup id="S2.E2.m2.1.1.1.1.6" xref="S2.E2.m2.1.1.1.1.6.cmml"><mi id="S2.E2.m2.1.1.1.1.6.2" xref="S2.E2.m2.1.1.1.1.6.2.cmml">ℝ</mi><msub id="S2.E2.m2.1.1.1.1.6.3" xref="S2.E2.m2.1.1.1.1.6.3.cmml"><mi id="S2.E2.m2.1.1.1.1.6.3.2" xref="S2.E2.m2.1.1.1.1.6.3.2.cmml">d</mi><mi id="S2.E2.m2.1.1.1.1.6.3.3" xref="S2.E2.m2.1.1.1.1.6.3.3.cmml">z</mi></msub></msup></mrow><mo id="S2.E2.m2.1.1.1.2" xref="S2.E2.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.1b"><apply id="S2.E2.m2.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1"><and id="S2.E2.m2.1.1.1.1a.cmml" xref="S2.E2.m2.1.1.1"></and><apply id="S2.E2.m2.1.1.1.1b.cmml" xref="S2.E2.m2.1.1.1"><eq id="S2.E2.m2.1.1.1.1.4.cmml" xref="S2.E2.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S2.E2.m2.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E2.m2.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1"><times id="S2.E2.m2.1.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.1.2"></times><ci id="S2.E2.m2.1.1.1.1.1.3a.cmml" xref="S2.E2.m2.1.1.1.1.1.3"><mtext id="S2.E2.m2.1.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.1.3">SA</mtext></ci><apply id="S2.E2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.1.2">𝐓</ci><ci id="S2.E2.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S2.E2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m2.1.1.1.1.1.1.1.1.3">target</mtext></ci></apply></apply></apply><apply id="S2.E2.m2.1.1.1.1c.cmml" xref="S2.E2.m2.1.1.1"><in id="S2.E2.m2.1.1.1.1.5.cmml" xref="S2.E2.m2.1.1.1.1.5"></in><share href="#S2.E2.m2.1.1.1.1.1.cmml" id="S2.E2.m2.1.1.1.1d.cmml" xref="S2.E2.m2.1.1.1"></share><apply id="S2.E2.m2.1.1.1.1.6.cmml" xref="S2.E2.m2.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.6.1.cmml" xref="S2.E2.m2.1.1.1.1.6">superscript</csymbol><ci id="S2.E2.m2.1.1.1.1.6.2.cmml" xref="S2.E2.m2.1.1.1.1.6.2">ℝ</ci><apply id="S2.E2.m2.1.1.1.1.6.3.cmml" xref="S2.E2.m2.1.1.1.1.6.3"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.1.1.6.3.1.cmml" xref="S2.E2.m2.1.1.1.1.6.3">subscript</csymbol><ci id="S2.E2.m2.1.1.1.1.6.3.2.cmml" xref="S2.E2.m2.1.1.1.1.6.3.2">𝑑</ci><ci id="S2.E2.m2.1.1.1.1.6.3.3.cmml" xref="S2.E2.m2.1.1.1.1.6.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.1c">\displaystyle=\text{SA}(\mathbf{T}_{\text{target}})\in\mathbb{R}^{d_{z}},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m2.1d">= SA ( bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
                                        </tr></tbody>
                                        <tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{E}_{\text{traffic}}" display="inline"><semantics id="S2.E3.m1.1a"><msub id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">𝐄</mi><mtext id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3a.cmml">traffic</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2">𝐄</ci><ci id="S2.E3.m1.1.1.3a.cmml" xref="S2.E3.m1.1.1.3"><mtext mathsize="70%" id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">traffic</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{E}_{\text{traffic}}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">bold_E start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.1" class="ltx_Math" alttext="\displaystyle=\{\text{SA}(\mathbf{T}_{n})\}_{n=1}^{N}\in\mathbb{R}^{N\times d_%
{z}}," display="inline"><semantics id="S2.E3.m2.1a"><mrow id="S2.E3.m2.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml"><mrow id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E3.m2.1.1.1.1.4" xref="S2.E3.m2.1.1.1.1.4.cmml">=</mo><msubsup id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.cmml"><mrow id="S2.E3.m2.1.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.E3.m2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S2.E3.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.3a.cmml">SA</mtext><mo id="S2.E3.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐓</mi><mi id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.E3.m2.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.3.2" xref="S2.E3.m2.1.1.1.1.1.1.3.2.cmml">n</mi><mo id="S2.E3.m2.1.1.1.1.1.1.3.1" xref="S2.E3.m2.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S2.E3.m2.1.1.1.1.1.1.3.3" xref="S2.E3.m2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.3.cmml">N</mi></msubsup><mo id="S2.E3.m2.1.1.1.1.5" xref="S2.E3.m2.1.1.1.1.5.cmml">∈</mo><msup id="S2.E3.m2.1.1.1.1.6" xref="S2.E3.m2.1.1.1.1.6.cmml"><mi id="S2.E3.m2.1.1.1.1.6.2" xref="S2.E3.m2.1.1.1.1.6.2.cmml">ℝ</mi><mrow id="S2.E3.m2.1.1.1.1.6.3" xref="S2.E3.m2.1.1.1.1.6.3.cmml"><mi id="S2.E3.m2.1.1.1.1.6.3.2" xref="S2.E3.m2.1.1.1.1.6.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E3.m2.1.1.1.1.6.3.1" xref="S2.E3.m2.1.1.1.1.6.3.1.cmml">×</mo><msub id="S2.E3.m2.1.1.1.1.6.3.3" xref="S2.E3.m2.1.1.1.1.6.3.3.cmml"><mi id="S2.E3.m2.1.1.1.1.6.3.3.2" xref="S2.E3.m2.1.1.1.1.6.3.3.2.cmml">d</mi><mi id="S2.E3.m2.1.1.1.1.6.3.3.3" xref="S2.E3.m2.1.1.1.1.6.3.3.3.cmml">z</mi></msub></mrow></msup></mrow><mo id="S2.E3.m2.1.1.1.2" xref="S2.E3.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.1b"><apply id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1"><and id="S2.E3.m2.1.1.1.1a.cmml" xref="S2.E3.m2.1.1.1"></and><apply id="S2.E3.m2.1.1.1.1b.cmml" xref="S2.E3.m2.1.1.1"><eq id="S2.E3.m2.1.1.1.1.4.cmml" xref="S2.E3.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S2.E3.m2.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E3.m2.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1">subscript</csymbol><set id="S2.E3.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1"><apply id="S2.E3.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E3.m2.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.3"><mtext id="S2.E3.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.3">SA</mtext></ci><apply id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐓</ci><ci id="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply></set><apply id="S2.E3.m2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.3"><eq id="S2.E3.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.3.1"></eq><ci id="S2.E3.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.3.2">𝑛</ci><cn type="integer" id="S2.E3.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.E3.m2.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.3">𝑁</ci></apply></apply><apply id="S2.E3.m2.1.1.1.1c.cmml" xref="S2.E3.m2.1.1.1"><in id="S2.E3.m2.1.1.1.1.5.cmml" xref="S2.E3.m2.1.1.1.1.5"></in><share href="#S2.E3.m2.1.1.1.1.1.cmml" id="S2.E3.m2.1.1.1.1d.cmml" xref="S2.E3.m2.1.1.1"></share><apply id="S2.E3.m2.1.1.1.1.6.cmml" xref="S2.E3.m2.1.1.1.1.6"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.6.1.cmml" xref="S2.E3.m2.1.1.1.1.6">superscript</csymbol><ci id="S2.E3.m2.1.1.1.1.6.2.cmml" xref="S2.E3.m2.1.1.1.1.6.2">ℝ</ci><apply id="S2.E3.m2.1.1.1.1.6.3.cmml" xref="S2.E3.m2.1.1.1.1.6.3"><times id="S2.E3.m2.1.1.1.1.6.3.1.cmml" xref="S2.E3.m2.1.1.1.1.6.3.1"></times><ci id="S2.E3.m2.1.1.1.1.6.3.2.cmml" xref="S2.E3.m2.1.1.1.1.6.3.2">𝑁</ci><apply id="S2.E3.m2.1.1.1.1.6.3.3.cmml" xref="S2.E3.m2.1.1.1.1.6.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.1.6.3.3.1.cmml" xref="S2.E3.m2.1.1.1.1.6.3.3">subscript</csymbol><ci id="S2.E3.m2.1.1.1.1.6.3.3.2.cmml" xref="S2.E3.m2.1.1.1.1.6.3.3.2">𝑑</ci><ci id="S2.E3.m2.1.1.1.1.6.3.3.3.cmml" xref="S2.E3.m2.1.1.1.1.6.3.3.3">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.1c">\displaystyle=\{\text{SA}(\mathbf{T}_{n})\}_{n=1}^{N}\in\mathbb{R}^{N\times d_%
                                                {z}},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m2.1d">= { SA ( bold_T start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_d start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
                                        </tr></tbody>
                                        <tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{E}_{\text{map}}" display="inline"><semantics id="S2.E4.m1.1a"><msub id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">𝐄</mi><mtext id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3a.cmml">map</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">𝐄</ci><ci id="S2.E4.m1.1.1.3a.cmml" xref="S2.E4.m1.1.1.3"><mtext mathsize="70%" id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3">map</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\mathbf{E}_{\text{map}}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">bold_E start_POSTSUBSCRIPT map end_POSTSUBSCRIPT</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.2" class="ltx_Math" alttext="\displaystyle=\text{SA}(\mathbf{M})\in\mathbb{R}^{d_{z}}." display="inline"><semantics id="S2.E4.m2.2a"><mrow id="S2.E4.m2.2.2.1" xref="S2.E4.m2.2.2.1.1.cmml"><mrow id="S2.E4.m2.2.2.1.1" xref="S2.E4.m2.2.2.1.1.cmml"><mi id="S2.E4.m2.2.2.1.1.2" xref="S2.E4.m2.2.2.1.1.2.cmml"></mi><mo id="S2.E4.m2.2.2.1.1.3" xref="S2.E4.m2.2.2.1.1.3.cmml">=</mo><mrow id="S2.E4.m2.2.2.1.1.4" xref="S2.E4.m2.2.2.1.1.4.cmml"><mtext id="S2.E4.m2.2.2.1.1.4.2" xref="S2.E4.m2.2.2.1.1.4.2a.cmml">SA</mtext><mo id="S2.E4.m2.2.2.1.1.4.1" xref="S2.E4.m2.2.2.1.1.4.1.cmml">⁢</mo><mrow id="S2.E4.m2.2.2.1.1.4.3.2" xref="S2.E4.m2.2.2.1.1.4.cmml"><mo stretchy="false" id="S2.E4.m2.2.2.1.1.4.3.2.1" xref="S2.E4.m2.2.2.1.1.4.cmml">(</mo><mi id="S2.E4.m2.1.1" xref="S2.E4.m2.1.1.cmml">𝐌</mi><mo stretchy="false" id="S2.E4.m2.2.2.1.1.4.3.2.2" xref="S2.E4.m2.2.2.1.1.4.cmml">)</mo></mrow></mrow><mo id="S2.E4.m2.2.2.1.1.5" xref="S2.E4.m2.2.2.1.1.5.cmml">∈</mo><msup id="S2.E4.m2.2.2.1.1.6" xref="S2.E4.m2.2.2.1.1.6.cmml"><mi id="S2.E4.m2.2.2.1.1.6.2" xref="S2.E4.m2.2.2.1.1.6.2.cmml">ℝ</mi><msub id="S2.E4.m2.2.2.1.1.6.3" xref="S2.E4.m2.2.2.1.1.6.3.cmml"><mi id="S2.E4.m2.2.2.1.1.6.3.2" xref="S2.E4.m2.2.2.1.1.6.3.2.cmml">d</mi><mi id="S2.E4.m2.2.2.1.1.6.3.3" xref="S2.E4.m2.2.2.1.1.6.3.3.cmml">z</mi></msub></msup></mrow><mo lspace="0em" id="S2.E4.m2.2.2.1.2" xref="S2.E4.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.2b"><apply id="S2.E4.m2.2.2.1.1.cmml" xref="S2.E4.m2.2.2.1"><and id="S2.E4.m2.2.2.1.1a.cmml" xref="S2.E4.m2.2.2.1"></and><apply id="S2.E4.m2.2.2.1.1b.cmml" xref="S2.E4.m2.2.2.1"><eq id="S2.E4.m2.2.2.1.1.3.cmml" xref="S2.E4.m2.2.2.1.1.3"></eq><csymbol cd="latexml" id="S2.E4.m2.2.2.1.1.2.cmml" xref="S2.E4.m2.2.2.1.1.2">absent</csymbol><apply id="S2.E4.m2.2.2.1.1.4.cmml" xref="S2.E4.m2.2.2.1.1.4"><times id="S2.E4.m2.2.2.1.1.4.1.cmml" xref="S2.E4.m2.2.2.1.1.4.1"></times><ci id="S2.E4.m2.2.2.1.1.4.2a.cmml" xref="S2.E4.m2.2.2.1.1.4.2"><mtext id="S2.E4.m2.2.2.1.1.4.2.cmml" xref="S2.E4.m2.2.2.1.1.4.2">SA</mtext></ci><ci id="S2.E4.m2.1.1.cmml" xref="S2.E4.m2.1.1">𝐌</ci></apply></apply><apply id="S2.E4.m2.2.2.1.1c.cmml" xref="S2.E4.m2.2.2.1"><in id="S2.E4.m2.2.2.1.1.5.cmml" xref="S2.E4.m2.2.2.1.1.5"></in><share href="#S2.E4.m2.2.2.1.1.4.cmml" id="S2.E4.m2.2.2.1.1d.cmml" xref="S2.E4.m2.2.2.1"></share><apply id="S2.E4.m2.2.2.1.1.6.cmml" xref="S2.E4.m2.2.2.1.1.6"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.6.1.cmml" xref="S2.E4.m2.2.2.1.1.6">superscript</csymbol><ci id="S2.E4.m2.2.2.1.1.6.2.cmml" xref="S2.E4.m2.2.2.1.1.6.2">ℝ</ci><apply id="S2.E4.m2.2.2.1.1.6.3.cmml" xref="S2.E4.m2.2.2.1.1.6.3"><csymbol cd="ambiguous" id="S2.E4.m2.2.2.1.1.6.3.1.cmml" xref="S2.E4.m2.2.2.1.1.6.3">subscript</csymbol><ci id="S2.E4.m2.2.2.1.1.6.3.2.cmml" xref="S2.E4.m2.2.2.1.1.6.3.2">𝑑</ci><ci id="S2.E4.m2.2.2.1.1.6.3.3.cmml" xref="S2.E4.m2.2.2.1.1.6.3.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.2c">\displaystyle=\text{SA}(\mathbf{M})\in\mathbb{R}^{d_{z}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m2.2d">= SA ( bold_M ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
                                        </tr></tbody>
                                    </table>
                                </div>
                                <div id="S2.SS2.SSS1.p3" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS1.p3.5" class="ltx_p">The self-attention layers <math id="S2.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\text{SA}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.1.m1.1a"><mrow id="S2.SS2.SSS1.p3.1.m1.1.2" xref="S2.SS2.SSS1.p3.1.m1.1.2.cmml"><mtext id="S2.SS2.SSS1.p3.1.m1.1.2.2" xref="S2.SS2.SSS1.p3.1.m1.1.2.2a.cmml">SA</mtext><mo id="S2.SS2.SSS1.p3.1.m1.1.2.1" xref="S2.SS2.SSS1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p3.1.m1.1.2.3.2" xref="S2.SS2.SSS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.1.2.3.2.1" xref="S2.SS2.SSS1.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.1.m1.1.1" xref="S2.SS2.SSS1.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.1.2.3.2.2" xref="S2.SS2.SSS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.1.m1.1b"><apply id="S2.SS2.SSS1.p3.1.m1.1.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.2"><times id="S2.SS2.SSS1.p3.1.m1.1.2.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.2.1"></times><ci id="S2.SS2.SSS1.p3.1.m1.1.2.2a.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.2.2"><mtext id="S2.SS2.SSS1.p3.1.m1.1.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.2.2">SA</mtext></ci><ci id="S2.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.1.m1.1c">\text{SA}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.1.m1.1d">SA ( ⋅ )</annotation></semantics></math> map each input type into an embedding space of dimension <math id="S2.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="d_{z}" display="inline"><semantics id="S2.SS2.SSS1.p3.2.m2.1a"><msub id="S2.SS2.SSS1.p3.2.m2.1.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml">d</mi><mi id="S2.SS2.SSS1.p3.2.m2.1.1.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.2.m2.1b"><apply id="S2.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.2">𝑑</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.2.m2.1c">d_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>. These embeddings are then processed through a cross-attention mechanism to dynamically emphasize contextually relevant features. Let <math id="S2.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><semantics id="S2.SS2.SSS1.p3.3.m3.1a"><mi id="S2.SS2.SSS1.p3.3.m3.1.1" xref="S2.SS2.SSS1.p3.3.m3.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.3.m3.1b"><ci id="S2.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.3.m3.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.3.m3.1d">bold_Q</annotation></semantics></math>, <math id="S2.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{K}" display="inline"><semantics id="S2.SS2.SSS1.p3.4.m4.1a"><mi id="S2.SS2.SSS1.p3.4.m4.1.1" xref="S2.SS2.SSS1.p3.4.m4.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.4.m4.1b"><ci id="S2.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p3.4.m4.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.4.m4.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.4.m4.1d">bold_K</annotation></semantics></math>, and <math id="S2.SS2.SSS1.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{V}" display="inline"><semantics id="S2.SS2.SSS1.p3.5.m5.1a"><mi id="S2.SS2.SSS1.p3.5.m5.1.1" xref="S2.SS2.SSS1.p3.5.m5.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.5.m5.1b"><ci id="S2.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p3.5.m5.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.5.m5.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.5.m5.1d">bold_V</annotation></semantics></math> represent the query, key, and value matrices, computed as follows:</p>
                                    <table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

                                        <tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{Q}" display="inline"><semantics id="S2.E5.m1.1a"><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\displaystyle\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">bold_Q</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5.m2.1" class="ltx_Math" alttext="\displaystyle=\text{Linear}(\mathbf{E}_{\text{target}})," display="inline"><semantics id="S2.E5.m2.1a"><mrow id="S2.E5.m2.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mrow id="S2.E5.m2.1.1.1.1" xref="S2.E5.m2.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E5.m2.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E5.m2.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.cmml"><mtext id="S2.E5.m2.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.3a.cmml">Linear</mtext><mo id="S2.E5.m2.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m2.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m2.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5.m2.1.1.1.1.1.1.1.1" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m2.1.1.1.1.1.1.1.1.2" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2.cmml">𝐄</mi><mtext id="S2.E5.m2.1.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3a.cmml">target</mtext></msub><mo stretchy="false" id="S2.E5.m2.1.1.1.1.1.1.1.3" xref="S2.E5.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m2.1.1.1.2" xref="S2.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m2.1b"><apply id="S2.E5.m2.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1"><eq id="S2.E5.m2.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E5.m2.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E5.m2.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1"><times id="S2.E5.m2.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.2"></times><ci id="S2.E5.m2.1.1.1.1.1.3a.cmml" xref="S2.E5.m2.1.1.1.1.1.3"><mtext id="S2.E5.m2.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.3">Linear</mtext></ci><apply id="S2.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.2">𝐄</ci><ci id="S2.E5.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S2.E5.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m2.1.1.1.1.1.1.1.1.3">target</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m2.1c">\displaystyle=\text{Linear}(\mathbf{E}_{\text{target}}),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m2.1d">= Linear ( bold_E start_POSTSUBSCRIPT target end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
                                        </tr></tbody>
                                        <tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{K}" display="inline"><semantics id="S2.E6.m1.1a"><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">bold_K</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6.m2.1" class="ltx_Math" alttext="\displaystyle=\text{Linear}(\mathbf{E}_{\text{traffic}}\oplus\mathbf{E}_{\text%
{map}})," display="inline"><semantics id="S2.E6.m2.1a"><mrow id="S2.E6.m2.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mrow id="S2.E6.m2.1.1.1.1" xref="S2.E6.m2.1.1.1.1.cmml"><mi id="S2.E6.m2.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E6.m2.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E6.m2.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.cmml"><mtext id="S2.E6.m2.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.3a.cmml">Linear</mtext><mo id="S2.E6.m2.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m2.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m2.1.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m2.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐄</mi><mtext id="S2.E6.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.3a.cmml">traffic</mtext></msub><mo id="S2.E6.m2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><msub id="S2.E6.m2.1.1.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E6.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐄</mi><mtext id="S2.E6.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.3a.cmml">map</mtext></msub></mrow><mo stretchy="false" id="S2.E6.m2.1.1.1.1.1.1.1.3" xref="S2.E6.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m2.1.1.1.2" xref="S2.E6.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.1b"><apply id="S2.E6.m2.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1"><eq id="S2.E6.m2.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E6.m2.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E6.m2.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1"><times id="S2.E6.m2.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.2"></times><ci id="S2.E6.m2.1.1.1.1.1.3a.cmml" xref="S2.E6.m2.1.1.1.1.1.3"><mtext id="S2.E6.m2.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.3">Linear</mtext></ci><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.2">𝐄</ci><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.E6.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.2.3">traffic</mtext></ci></apply><apply id="S2.E6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.2">𝐄</ci><ci id="S2.E6.m2.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S2.E6.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E6.m2.1.1.1.1.1.1.1.1.3.3">map</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.1c">\displaystyle=\text{Linear}(\mathbf{E}_{\text{traffic}}\oplus\mathbf{E}_{\text%
                                                {map}}),</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m2.1d">= Linear ( bold_E start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT ⊕ bold_E start_POSTSUBSCRIPT map end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
                                        </tr></tbody>
                                        <tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E7.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{V}" display="inline"><semantics id="S2.E7.m1.1a"><mi id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><ci id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\displaystyle\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">bold_V</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E7.m2.1" class="ltx_Math" alttext="\displaystyle=\text{Linear}(\mathbf{E}_{\text{traffic}}\oplus\mathbf{E}_{\text%
{map}})," display="inline"><semantics id="S2.E7.m2.1a"><mrow id="S2.E7.m2.1.1.1" xref="S2.E7.m2.1.1.1.1.cmml"><mrow id="S2.E7.m2.1.1.1.1" xref="S2.E7.m2.1.1.1.1.cmml"><mi id="S2.E7.m2.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E7.m2.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.2.cmml">=</mo><mrow id="S2.E7.m2.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.cmml"><mtext id="S2.E7.m2.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.3a.cmml">Linear</mtext><mo id="S2.E7.m2.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m2.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m2.1.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m2.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m2.1.1.1.1.1.1.1.1.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐄</mi><mtext id="S2.E7.m2.1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.3a.cmml">traffic</mtext></msub><mo id="S2.E7.m2.1.1.1.1.1.1.1.1.1" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1.cmml">⊕</mo><msub id="S2.E7.m2.1.1.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m2.1.1.1.1.1.1.1.1.3.2" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐄</mi><mtext id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3a.cmml">map</mtext></msub></mrow><mo stretchy="false" id="S2.E7.m2.1.1.1.1.1.1.1.3" xref="S2.E7.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m2.1.1.1.2" xref="S2.E7.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m2.1b"><apply id="S2.E7.m2.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1"><eq id="S2.E7.m2.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.3">absent</csymbol><apply id="S2.E7.m2.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1"><times id="S2.E7.m2.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.2"></times><ci id="S2.E7.m2.1.1.1.1.1.3a.cmml" xref="S2.E7.m2.1.1.1.1.1.3"><mtext id="S2.E7.m2.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.1.3">Linear</mtext></ci><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.2">𝐄</ci><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S2.E7.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.2.3">traffic</mtext></ci></apply><apply id="S2.E7.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.2">𝐄</ci><ci id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S2.E7.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m2.1.1.1.1.1.1.1.1.3.3">map</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m2.1c">\displaystyle=\text{Linear}(\mathbf{E}_{\text{traffic}}\oplus\mathbf{E}_{\text%
                                                {map}}),</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m2.1d">= Linear ( bold_E start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT ⊕ bold_E start_POSTSUBSCRIPT map end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S2.SS2.SSS1.p3.6" class="ltx_p">where <math id="S2.SS2.SSS1.p3.6.m1.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="S2.SS2.SSS1.p3.6.m1.1a"><mo id="S2.SS2.SSS1.p3.6.m1.1.1" xref="S2.SS2.SSS1.p3.6.m1.1.1.cmml">⊕</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.6.m1.1b"><csymbol cd="latexml" id="S2.SS2.SSS1.p3.6.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.6.m1.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.6.m1.1c">\oplus</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.6.m1.1d">⊕</annotation></semantics></math> represents concatenation. The cross-attention output is computed as:</p>
                                    <table id="S2.E8" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.5" class="ltx_Math" alttext="\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
\mathbf{Q}\mathbf{K}^{\top}}{\sqrt{d_{k}}}\right)\mathbf{V}," display="block"><semantics id="S2.E8.m1.5a"><mrow id="S2.E8.m1.5.5.1" xref="S2.E8.m1.5.5.1.1.cmml"><mrow id="S2.E8.m1.5.5.1.1" xref="S2.E8.m1.5.5.1.1.cmml"><mrow id="S2.E8.m1.5.5.1.1.2" xref="S2.E8.m1.5.5.1.1.2.cmml"><mtext id="S2.E8.m1.5.5.1.1.2.2" xref="S2.E8.m1.5.5.1.1.2.2a.cmml">Attention</mtext><mo id="S2.E8.m1.5.5.1.1.2.1" xref="S2.E8.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S2.E8.m1.5.5.1.1.2.3.2" xref="S2.E8.m1.5.5.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E8.m1.5.5.1.1.2.3.2.1" xref="S2.E8.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml">𝐐</mi><mo id="S2.E8.m1.5.5.1.1.2.3.2.2" xref="S2.E8.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml">𝐊</mi><mo id="S2.E8.m1.5.5.1.1.2.3.2.3" xref="S2.E8.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S2.E8.m1.3.3" xref="S2.E8.m1.3.3.cmml">𝐕</mi><mo stretchy="false" id="S2.E8.m1.5.5.1.1.2.3.2.4" xref="S2.E8.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.5.5.1.1.1" xref="S2.E8.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.5.5.1.1.3" xref="S2.E8.m1.5.5.1.1.3.cmml"><mtext id="S2.E8.m1.5.5.1.1.3.2" xref="S2.E8.m1.5.5.1.1.3.2a.cmml">softmax</mtext><mo id="S2.E8.m1.5.5.1.1.3.1" xref="S2.E8.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S2.E8.m1.5.5.1.1.3.3.2" xref="S2.E8.m1.4.4.cmml"><mo id="S2.E8.m1.5.5.1.1.3.3.2.1" xref="S2.E8.m1.4.4.cmml">(</mo><mfrac id="S2.E8.m1.4.4" xref="S2.E8.m1.4.4.cmml"><msup id="S2.E8.m1.4.4.2" xref="S2.E8.m1.4.4.2.cmml"><mi id="S2.E8.m1.4.4.2.2" xref="S2.E8.m1.4.4.2.2.cmml">𝐐𝐊</mi><mo id="S2.E8.m1.4.4.2.3" xref="S2.E8.m1.4.4.2.3.cmml">⊤</mo></msup><msqrt id="S2.E8.m1.4.4.3" xref="S2.E8.m1.4.4.3.cmml"><msub id="S2.E8.m1.4.4.3.2" xref="S2.E8.m1.4.4.3.2.cmml"><mi id="S2.E8.m1.4.4.3.2.2" xref="S2.E8.m1.4.4.3.2.2.cmml">d</mi><mi id="S2.E8.m1.4.4.3.2.3" xref="S2.E8.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S2.E8.m1.5.5.1.1.3.3.2.2" xref="S2.E8.m1.4.4.cmml">)</mo></mrow><mo id="S2.E8.m1.5.5.1.1.3.1a" xref="S2.E8.m1.5.5.1.1.3.1.cmml">⁢</mo><mi id="S2.E8.m1.5.5.1.1.3.4" xref="S2.E8.m1.5.5.1.1.3.4.cmml">𝐕</mi></mrow></mrow><mo id="S2.E8.m1.5.5.1.2" xref="S2.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.5b"><apply id="S2.E8.m1.5.5.1.1.cmml" xref="S2.E8.m1.5.5.1"><eq id="S2.E8.m1.5.5.1.1.1.cmml" xref="S2.E8.m1.5.5.1.1.1"></eq><apply id="S2.E8.m1.5.5.1.1.2.cmml" xref="S2.E8.m1.5.5.1.1.2"><times id="S2.E8.m1.5.5.1.1.2.1.cmml" xref="S2.E8.m1.5.5.1.1.2.1"></times><ci id="S2.E8.m1.5.5.1.1.2.2a.cmml" xref="S2.E8.m1.5.5.1.1.2.2"><mtext id="S2.E8.m1.5.5.1.1.2.2.cmml" xref="S2.E8.m1.5.5.1.1.2.2">Attention</mtext></ci><vector id="S2.E8.m1.5.5.1.1.2.3.1.cmml" xref="S2.E8.m1.5.5.1.1.2.3.2"><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">𝐐</ci><ci id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2">𝐊</ci><ci id="S2.E8.m1.3.3.cmml" xref="S2.E8.m1.3.3">𝐕</ci></vector></apply><apply id="S2.E8.m1.5.5.1.1.3.cmml" xref="S2.E8.m1.5.5.1.1.3"><times id="S2.E8.m1.5.5.1.1.3.1.cmml" xref="S2.E8.m1.5.5.1.1.3.1"></times><ci id="S2.E8.m1.5.5.1.1.3.2a.cmml" xref="S2.E8.m1.5.5.1.1.3.2"><mtext id="S2.E8.m1.5.5.1.1.3.2.cmml" xref="S2.E8.m1.5.5.1.1.3.2">softmax</mtext></ci><apply id="S2.E8.m1.4.4.cmml" xref="S2.E8.m1.5.5.1.1.3.3.2"><divide id="S2.E8.m1.4.4.1.cmml" xref="S2.E8.m1.5.5.1.1.3.3.2"></divide><apply id="S2.E8.m1.4.4.2.cmml" xref="S2.E8.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.2.1.cmml" xref="S2.E8.m1.4.4.2">superscript</csymbol><ci id="S2.E8.m1.4.4.2.2.cmml" xref="S2.E8.m1.4.4.2.2">𝐐𝐊</ci><csymbol cd="latexml" id="S2.E8.m1.4.4.2.3.cmml" xref="S2.E8.m1.4.4.2.3">top</csymbol></apply><apply id="S2.E8.m1.4.4.3.cmml" xref="S2.E8.m1.4.4.3"><root id="S2.E8.m1.4.4.3a.cmml" xref="S2.E8.m1.4.4.3"></root><apply id="S2.E8.m1.4.4.3.2.cmml" xref="S2.E8.m1.4.4.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.3.2.1.cmml" xref="S2.E8.m1.4.4.3.2">subscript</csymbol><ci id="S2.E8.m1.4.4.3.2.2.cmml" xref="S2.E8.m1.4.4.3.2.2">𝑑</ci><ci id="S2.E8.m1.4.4.3.2.3.cmml" xref="S2.E8.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S2.E8.m1.5.5.1.1.3.4.cmml" xref="S2.E8.m1.5.5.1.1.3.4">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.5c">\text{Attention}(\mathbf{Q},\mathbf{K},\mathbf{V})=\text{softmax}\left(\frac{%
                                                \mathbf{Q}\mathbf{K}^{\top}}{\sqrt{d_{k}}}\right)\mathbf{V},</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.5d">Attention ( bold_Q , bold_K , bold_V ) = softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) bold_V ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S2.SS2.SSS1.p3.7" class="ltx_p">producing the latent matrix <math id="S2.SS2.SSS1.p3.7.m1.1" class="ltx_Math" alttext="\mathbf{Z}" display="inline"><semantics id="S2.SS2.SSS1.p3.7.m1.1a"><mi id="S2.SS2.SSS1.p3.7.m1.1.1" xref="S2.SS2.SSS1.p3.7.m1.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.7.m1.1b"><ci id="S2.SS2.SSS1.p3.7.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.7.m1.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.7.m1.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.7.m1.1d">bold_Z</annotation></semantics></math> that serves as a shared context for prediction tasks. This matrix encapsulates both the temporal sequence of vehicle trajectories and spatial environmental factors, providing a comprehensive representation for the decoder.</p>
                                </div>
                            </section>
                            <section id="S2.SS2.SSS2" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Decoder: GAN-based Occupancy Heatmap Generator</h4>

                                <div id="S2.SS2.SSS2.p1" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS2.p1.6" class="ltx_p">The GAN-based decoder, parameterized by <math id="S2.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\theta_{d}" display="inline"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msub id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">𝜃</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\theta_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, translates the latent matrix <math id="S2.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{Z}" display="inline"><semantics id="S2.SS2.SSS2.p1.2.m2.1a"><mi id="S2.SS2.SSS2.p1.2.m2.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.1b"><ci id="S2.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.2.m2.1d">bold_Z</annotation></semantics></math> into probabilistic occupancy heatmaps <math id="S2.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\{H_{t_{k}}\}_{k=1}^{K}" display="inline"><semantics id="S2.SS2.SSS2.p1.3.m3.1a"><msubsup id="S2.SS2.SSS2.p1.3.m3.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.cmml"><mrow id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.cmml">H</mi><msub id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS2.SSS2.p1.3.m3.1.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.2.cmml">k</mi><mo id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS2.SSS2.p1.3.m3.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m3.1b"><apply id="S2.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><set id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1"><apply id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2">𝐻</ci><apply id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></set><apply id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3"><eq id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.1"></eq><ci id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.2">𝑘</ci><cn type="integer" id="S2.SS2.SSS2.p1.3.m3.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m3.1c">\{H_{t_{k}}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.3.m3.1d">{ italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, where each grid cell <math id="S2.SS2.SSS2.p1.4.m4.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S2.SS2.SSS2.p1.4.m4.2a"><mrow id="S2.SS2.SSS2.p1.4.m4.2.3.2" xref="S2.SS2.SSS2.p1.4.m4.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p1.4.m4.2.3.2.1" xref="S2.SS2.SSS2.p1.4.m4.2.3.1.cmml">(</mo><mi id="S2.SS2.SSS2.p1.4.m4.1.1" xref="S2.SS2.SSS2.p1.4.m4.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p1.4.m4.2.3.2.2" xref="S2.SS2.SSS2.p1.4.m4.2.3.1.cmml">,</mo><mi id="S2.SS2.SSS2.p1.4.m4.2.2" xref="S2.SS2.SSS2.p1.4.m4.2.2.cmml">j</mi><mo stretchy="false" id="S2.SS2.SSS2.p1.4.m4.2.3.2.3" xref="S2.SS2.SSS2.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m4.2b"><interval closure="open" id="S2.SS2.SSS2.p1.4.m4.2.3.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.2.3.2"><ci id="S2.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p1.4.m4.2.2.cmml" xref="S2.SS2.SSS2.p1.4.m4.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m4.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.4.m4.2d">( italic_i , italic_j )</annotation></semantics></math> in <math id="S2.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="H_{t_{k}}" display="inline"><semantics id="S2.SS2.SSS2.p1.5.m5.1a"><msub id="S2.SS2.SSS2.p1.5.m5.1.1" xref="S2.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.SSS2.p1.5.m5.1.1.2" xref="S2.SS2.SSS2.p1.5.m5.1.1.2.cmml">H</mi><msub id="S2.SS2.SSS2.p1.5.m5.1.1.3" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.5.m5.1.1.3.2" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.2.cmml">t</mi><mi id="S2.SS2.SSS2.p1.5.m5.1.1.3.3" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.5.m5.1b"><apply id="S2.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.2">𝐻</ci><apply id="S2.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.2">𝑡</ci><ci id="S2.SS2.SSS2.p1.5.m5.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.5.m5.1c">H_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.5.m5.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> holds the probability of vehicle occupancy at future time <math id="S2.SS2.SSS2.p1.6.m6.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S2.SS2.SSS2.p1.6.m6.1a"><msub id="S2.SS2.SSS2.p1.6.m6.1.1" xref="S2.SS2.SSS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.SSS2.p1.6.m6.1.1.2" xref="S2.SS2.SSS2.p1.6.m6.1.1.2.cmml">t</mi><mi id="S2.SS2.SSS2.p1.6.m6.1.1.3" xref="S2.SS2.SSS2.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.6.m6.1b"><apply id="S2.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.2">𝑡</ci><ci id="S2.SS2.SSS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.SSS2.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.6.m6.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.6.m6.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. This probabilistic approach allows the model to represent uncertainty, as it predicts a range of potential future positions for each traffic participant.
                                        In this paper, the decoder is pre-trained in the GAN framework separately before being connected to an encoder. The specification of the training procedure will be elaborated in Section <a href="./pora_paper_demo_backup.html#S2.SS3" title="2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3</span></a>.</p>
                                </div>
                                <div id="S2.SS2.SSS2.p2" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS2.p2.4" class="ltx_p">The generator <math id="S2.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><mi id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><ci id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.1.m1.1d">italic_G</annotation></semantics></math> in the GAN takes a latent vector <math id="S2.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{z}_{t_{k}}" display="inline"><semantics id="S2.SS2.SSS2.p2.2.m2.1a"><msub id="S2.SS2.SSS2.p2.2.m2.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.1.1.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml">𝐳</mi><msub id="S2.SS2.SSS2.p2.2.m2.1.1.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.1.1.3.2" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.2.cmml">t</mi><mi id="S2.SS2.SSS2.p2.2.m2.1.1.3.3" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.2.m2.1b"><apply id="S2.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.2">𝐳</ci><apply id="S2.SS2.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.2">𝑡</ci><ci id="S2.SS2.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.2.m2.1c">\mathbf{z}_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.2.m2.1d">bold_z start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> extracted from <math id="S2.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{Z}" display="inline"><semantics id="S2.SS2.SSS2.p2.3.m3.1a"><mi id="S2.SS2.SSS2.p2.3.m3.1.1" xref="S2.SS2.SSS2.p2.3.m3.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.3.m3.1b"><ci id="S2.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.3.m3.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.3.m3.1d">bold_Z</annotation></semantics></math> and generates a heatmap <math id="S2.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="H_{t_{k}}" display="inline"><semantics id="S2.SS2.SSS2.p2.4.m4.1a"><msub id="S2.SS2.SSS2.p2.4.m4.1.1" xref="S2.SS2.SSS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.1.1.2" xref="S2.SS2.SSS2.p2.4.m4.1.1.2.cmml">H</mi><msub id="S2.SS2.SSS2.p2.4.m4.1.1.3" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.cmml"><mi id="S2.SS2.SSS2.p2.4.m4.1.1.3.2" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.2.cmml">t</mi><mi id="S2.SS2.SSS2.p2.4.m4.1.1.3.3" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.4.m4.1b"><apply id="S2.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.2">𝐻</ci><apply id="S2.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.2">𝑡</ci><ci id="S2.SS2.SSS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.4.m4.1c">H_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.4.m4.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
                                    <table id="S2.E9" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1.1" class="ltx_Math" alttext="H_{t_{k}}=G(\mathbf{z}_{t_{k}};\theta_{d})," display="block"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><mrow id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><msub id="S2.E9.m1.1.1.1.1.4" xref="S2.E9.m1.1.1.1.1.4.cmml"><mi id="S2.E9.m1.1.1.1.1.4.2" xref="S2.E9.m1.1.1.1.1.4.2.cmml">H</mi><msub id="S2.E9.m1.1.1.1.1.4.3" xref="S2.E9.m1.1.1.1.1.4.3.cmml"><mi id="S2.E9.m1.1.1.1.1.4.3.2" xref="S2.E9.m1.1.1.1.1.4.3.2.cmml">t</mi><mi id="S2.E9.m1.1.1.1.1.4.3.3" xref="S2.E9.m1.1.1.1.1.4.3.3.cmml">k</mi></msub></msub><mo id="S2.E9.m1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E9.m1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.2.cmml"><mi id="S2.E9.m1.1.1.1.1.2.4" xref="S2.E9.m1.1.1.1.1.2.4.cmml">G</mi><mo id="S2.E9.m1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E9.m1.1.1.1.1.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E9.m1.1.1.1.1.2.2.2.3" xref="S2.E9.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S2.E9.m1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo id="S2.E9.m1.1.1.1.1.2.2.2.4" xref="S2.E9.m1.1.1.1.1.2.2.3.cmml">;</mo><msub id="S2.E9.m1.1.1.1.1.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E9.m1.1.1.1.1.2.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mi id="S2.E9.m1.1.1.1.1.2.2.2.2.3" xref="S2.E9.m1.1.1.1.1.2.2.2.2.3.cmml">d</mi></msub><mo stretchy="false" id="S2.E9.m1.1.1.1.1.2.2.2.5" xref="S2.E9.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E9.m1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"><eq id="S2.E9.m1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.3"></eq><apply id="S2.E9.m1.1.1.1.1.4.cmml" xref="S2.E9.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.4.1.cmml" xref="S2.E9.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.4.2.cmml" xref="S2.E9.m1.1.1.1.1.4.2">𝐻</ci><apply id="S2.E9.m1.1.1.1.1.4.3.cmml" xref="S2.E9.m1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.4.3.1.cmml" xref="S2.E9.m1.1.1.1.1.4.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.4.3.2.cmml" xref="S2.E9.m1.1.1.1.1.4.3.2">𝑡</ci><ci id="S2.E9.m1.1.1.1.1.4.3.3.cmml" xref="S2.E9.m1.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S2.E9.m1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.2"><times id="S2.E9.m1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3"></times><ci id="S2.E9.m1.1.1.1.1.2.4.cmml" xref="S2.E9.m1.1.1.1.1.2.4">𝐺</ci><list id="S2.E9.m1.1.1.1.1.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2"><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S2.E9.m1.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2">𝜃</ci><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.3">𝑑</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">H_{t_{k}}=G(\mathbf{z}_{t_{k}};\theta_{d}),</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_G ( bold_z start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ; italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S2.SS2.SSS2.p2.7" class="ltx_p">where <math id="S2.SS2.SSS2.p2.5.m1.1" class="ltx_Math" alttext="\mathbf{z}_{t_{k}}" display="inline"><semantics id="S2.SS2.SSS2.p2.5.m1.1a"><msub id="S2.SS2.SSS2.p2.5.m1.1.1" xref="S2.SS2.SSS2.p2.5.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.5.m1.1.1.2" xref="S2.SS2.SSS2.p2.5.m1.1.1.2.cmml">𝐳</mi><msub id="S2.SS2.SSS2.p2.5.m1.1.1.3" xref="S2.SS2.SSS2.p2.5.m1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p2.5.m1.1.1.3.2" xref="S2.SS2.SSS2.p2.5.m1.1.1.3.2.cmml">t</mi><mi id="S2.SS2.SSS2.p2.5.m1.1.1.3.3" xref="S2.SS2.SSS2.p2.5.m1.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.5.m1.1b"><apply id="S2.SS2.SSS2.p2.5.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.5.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.5.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1.2">𝐳</ci><apply id="S2.SS2.SSS2.p2.5.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.5.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p2.5.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1.3.2">𝑡</ci><ci id="S2.SS2.SSS2.p2.5.m1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.5.m1.1c">\mathbf{z}_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.5.m1.1d">bold_z start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is contextually adapted to represent specific prediction requirements for time <math id="S2.SS2.SSS2.p2.6.m2.1" class="ltx_Math" alttext="t_{k}" display="inline"><semantics id="S2.SS2.SSS2.p2.6.m2.1a"><msub id="S2.SS2.SSS2.p2.6.m2.1.1" xref="S2.SS2.SSS2.p2.6.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p2.6.m2.1.1.2" xref="S2.SS2.SSS2.p2.6.m2.1.1.2.cmml">t</mi><mi id="S2.SS2.SSS2.p2.6.m2.1.1.3" xref="S2.SS2.SSS2.p2.6.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.6.m2.1b"><apply id="S2.SS2.SSS2.p2.6.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.6.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1.2">𝑡</ci><ci id="S2.SS2.SSS2.p2.6.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.6.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.6.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. The probability of occupancy at each grid cell <math id="S2.SS2.SSS2.p2.7.m3.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S2.SS2.SSS2.p2.7.m3.2a"><mrow id="S2.SS2.SSS2.p2.7.m3.2.3.2" xref="S2.SS2.SSS2.p2.7.m3.2.3.1.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p2.7.m3.2.3.2.1" xref="S2.SS2.SSS2.p2.7.m3.2.3.1.cmml">(</mo><mi id="S2.SS2.SSS2.p2.7.m3.1.1" xref="S2.SS2.SSS2.p2.7.m3.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p2.7.m3.2.3.2.2" xref="S2.SS2.SSS2.p2.7.m3.2.3.1.cmml">,</mo><mi id="S2.SS2.SSS2.p2.7.m3.2.2" xref="S2.SS2.SSS2.p2.7.m3.2.2.cmml">j</mi><mo stretchy="false" id="S2.SS2.SSS2.p2.7.m3.2.3.2.3" xref="S2.SS2.SSS2.p2.7.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.7.m3.2b"><interval closure="open" id="S2.SS2.SSS2.p2.7.m3.2.3.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.3.2"><ci id="S2.SS2.SSS2.p2.7.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p2.7.m3.2.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.7.m3.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p2.7.m3.2d">( italic_i , italic_j )</annotation></semantics></math> is defined as:</p>
                                    <table id="S2.E10" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1.5" class="ltx_Math" alttext="H_{t_{k}}(i,j)=\text{P}(\text{occupancy at grid cell }(i,j)\mid t_{k})." display="block"><semantics id="S2.E10.m1.5a"><mrow id="S2.E10.m1.5.5.1" xref="S2.E10.m1.5.5.1.1.cmml"><mrow id="S2.E10.m1.5.5.1.1" xref="S2.E10.m1.5.5.1.1.cmml"><mrow id="S2.E10.m1.5.5.1.1.3" xref="S2.E10.m1.5.5.1.1.3.cmml"><msub id="S2.E10.m1.5.5.1.1.3.2" xref="S2.E10.m1.5.5.1.1.3.2.cmml"><mi id="S2.E10.m1.5.5.1.1.3.2.2" xref="S2.E10.m1.5.5.1.1.3.2.2.cmml">H</mi><msub id="S2.E10.m1.5.5.1.1.3.2.3" xref="S2.E10.m1.5.5.1.1.3.2.3.cmml"><mi id="S2.E10.m1.5.5.1.1.3.2.3.2" xref="S2.E10.m1.5.5.1.1.3.2.3.2.cmml">t</mi><mi id="S2.E10.m1.5.5.1.1.3.2.3.3" xref="S2.E10.m1.5.5.1.1.3.2.3.3.cmml">k</mi></msub></msub><mo id="S2.E10.m1.5.5.1.1.3.1" xref="S2.E10.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S2.E10.m1.5.5.1.1.3.3.2" xref="S2.E10.m1.5.5.1.1.3.3.1.cmml"><mo stretchy="false" id="S2.E10.m1.5.5.1.1.3.3.2.1" xref="S2.E10.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml">i</mi><mo id="S2.E10.m1.5.5.1.1.3.3.2.2" xref="S2.E10.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S2.E10.m1.2.2" xref="S2.E10.m1.2.2.cmml">j</mi><mo stretchy="false" id="S2.E10.m1.5.5.1.1.3.3.2.3" xref="S2.E10.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E10.m1.5.5.1.1.2" xref="S2.E10.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.E10.m1.5.5.1.1.1" xref="S2.E10.m1.5.5.1.1.1.cmml"><mtext id="S2.E10.m1.5.5.1.1.1.3" xref="S2.E10.m1.5.5.1.1.1.3a.cmml">P</mtext><mo id="S2.E10.m1.5.5.1.1.1.2" xref="S2.E10.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E10.m1.5.5.1.1.1.1.1" xref="S2.E10.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E10.m1.5.5.1.1.1.1.1.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E10.m1.5.5.1.1.1.1.1.1" xref="S2.E10.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.5.5.1.1.1.1.1.1.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.cmml"><mtext id="S2.E10.m1.5.5.1.1.1.1.1.1.2.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.2a.cmml">occupancy at grid cell&nbsp;</mtext><mo id="S2.E10.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.1.cmml"><mo stretchy="false" id="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.2.1" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S2.E10.m1.3.3" xref="S2.E10.m1.3.3.cmml">i</mi><mo id="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.2.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S2.E10.m1.4.4" xref="S2.E10.m1.4.4.cmml">j</mi><mo stretchy="false" id="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.2.3" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E10.m1.5.5.1.1.1.1.1.1.1" xref="S2.E10.m1.5.5.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S2.E10.m1.5.5.1.1.1.1.1.1.3" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S2.E10.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S2.E10.m1.5.5.1.1.1.1.1.3" xref="S2.E10.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E10.m1.5.5.1.2" xref="S2.E10.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.5b"><apply id="S2.E10.m1.5.5.1.1.cmml" xref="S2.E10.m1.5.5.1"><eq id="S2.E10.m1.5.5.1.1.2.cmml" xref="S2.E10.m1.5.5.1.1.2"></eq><apply id="S2.E10.m1.5.5.1.1.3.cmml" xref="S2.E10.m1.5.5.1.1.3"><times id="S2.E10.m1.5.5.1.1.3.1.cmml" xref="S2.E10.m1.5.5.1.1.3.1"></times><apply id="S2.E10.m1.5.5.1.1.3.2.cmml" xref="S2.E10.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.5.5.1.1.3.2.1.cmml" xref="S2.E10.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S2.E10.m1.5.5.1.1.3.2.2.cmml" xref="S2.E10.m1.5.5.1.1.3.2.2">𝐻</ci><apply id="S2.E10.m1.5.5.1.1.3.2.3.cmml" xref="S2.E10.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.5.5.1.1.3.2.3.1.cmml" xref="S2.E10.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S2.E10.m1.5.5.1.1.3.2.3.2.cmml" xref="S2.E10.m1.5.5.1.1.3.2.3.2">𝑡</ci><ci id="S2.E10.m1.5.5.1.1.3.2.3.3.cmml" xref="S2.E10.m1.5.5.1.1.3.2.3.3">𝑘</ci></apply></apply><interval closure="open" id="S2.E10.m1.5.5.1.1.3.3.1.cmml" xref="S2.E10.m1.5.5.1.1.3.3.2"><ci id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.1">𝑖</ci><ci id="S2.E10.m1.2.2.cmml" xref="S2.E10.m1.2.2">𝑗</ci></interval></apply><apply id="S2.E10.m1.5.5.1.1.1.cmml" xref="S2.E10.m1.5.5.1.1.1"><times id="S2.E10.m1.5.5.1.1.1.2.cmml" xref="S2.E10.m1.5.5.1.1.1.2"></times><ci id="S2.E10.m1.5.5.1.1.1.3a.cmml" xref="S2.E10.m1.5.5.1.1.1.3"><mtext id="S2.E10.m1.5.5.1.1.1.3.cmml" xref="S2.E10.m1.5.5.1.1.1.3">P</mtext></ci><apply id="S2.E10.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E10.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2"><times id="S2.E10.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.1"></times><ci id="S2.E10.m1.5.5.1.1.1.1.1.1.2.2a.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.2"><mtext id="S2.E10.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.2">occupancy at grid cell&nbsp;</mtext></ci><interval closure="open" id="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.2.3.2"><ci id="S2.E10.m1.3.3.cmml" xref="S2.E10.m1.3.3">𝑖</ci><ci id="S2.E10.m1.4.4.cmml" xref="S2.E10.m1.4.4">𝑗</ci></interval></apply><apply id="S2.E10.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.E10.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.5.5.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.5c">H_{t_{k}}(i,j)=\text{P}(\text{occupancy at grid cell }(i,j)\mid t_{k}).</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.5d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_i , italic_j ) = P ( occupancy at grid cell ( italic_i , italic_j ) ∣ italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
                                        </tr></tbody>
                                    </table>
                                </div>
                                <div id="S2.SS2.SSS2.p3" class="ltx_para ltx_noindent">
                                    <p id="S2.SS2.SSS2.p3.2" class="ltx_p">The discriminator <math id="S2.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.SSS2.p3.1.m1.1a"><mi id="S2.SS2.SSS2.p3.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.m1.1b"><ci id="S2.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.1.m1.1d">italic_D</annotation></semantics></math> in the GAN is trained to distinguish between real and generated heatmaps, enforcing realism in <math id="S2.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S2.SS2.SSS2.p3.2.m2.1a"><mi id="S2.SS2.SSS2.p3.2.m2.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.2.m2.1b"><ci id="S2.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.2.m2.1c">G</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.2.m2.1d">italic_G</annotation></semantics></math> outputs through an adversarial loss function:</p>
                                    <table id="S2.E11" class="ltx_equationgroup ltx_eqn_table">
                                        <tbody>
                                        <tr id="S2.E11X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E11X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\min_{G}\max_{D}V(D,G)" display="inline"><semantics id="S2.E11X.2.1.1.m1.2a"><mrow id="S2.E11X.2.1.1.m1.2.3" xref="S2.E11X.2.1.1.m1.2.3.cmml"><mrow id="S2.E11X.2.1.1.m1.2.3.2" xref="S2.E11X.2.1.1.m1.2.3.2.cmml"><munder id="S2.E11X.2.1.1.m1.2.3.2.1" xref="S2.E11X.2.1.1.m1.2.3.2.1.cmml"><mi id="S2.E11X.2.1.1.m1.2.3.2.1.2" xref="S2.E11X.2.1.1.m1.2.3.2.1.2.cmml">min</mi><mi id="S2.E11X.2.1.1.m1.2.3.2.1.3" xref="S2.E11X.2.1.1.m1.2.3.2.1.3.cmml">G</mi></munder><mo lspace="0.167em" id="S2.E11X.2.1.1.m1.2.3.2a" xref="S2.E11X.2.1.1.m1.2.3.2.cmml">⁡</mo><mrow id="S2.E11X.2.1.1.m1.2.3.2.2" xref="S2.E11X.2.1.1.m1.2.3.2.2.cmml"><munder id="S2.E11X.2.1.1.m1.2.3.2.2.1" xref="S2.E11X.2.1.1.m1.2.3.2.2.1.cmml"><mi id="S2.E11X.2.1.1.m1.2.3.2.2.1.2" xref="S2.E11X.2.1.1.m1.2.3.2.2.1.2.cmml">max</mi><mi id="S2.E11X.2.1.1.m1.2.3.2.2.1.3" xref="S2.E11X.2.1.1.m1.2.3.2.2.1.3.cmml">D</mi></munder><mo lspace="0.167em" id="S2.E11X.2.1.1.m1.2.3.2.2a" xref="S2.E11X.2.1.1.m1.2.3.2.2.cmml">⁡</mo><mi id="S2.E11X.2.1.1.m1.2.3.2.2.2" xref="S2.E11X.2.1.1.m1.2.3.2.2.2.cmml">V</mi></mrow></mrow><mo id="S2.E11X.2.1.1.m1.2.3.1" xref="S2.E11X.2.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.E11X.2.1.1.m1.2.3.3.2" xref="S2.E11X.2.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.E11X.2.1.1.m1.2.3.3.2.1" xref="S2.E11X.2.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.E11X.2.1.1.m1.1.1" xref="S2.E11X.2.1.1.m1.1.1.cmml">D</mi><mo id="S2.E11X.2.1.1.m1.2.3.3.2.2" xref="S2.E11X.2.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.E11X.2.1.1.m1.2.2" xref="S2.E11X.2.1.1.m1.2.2.cmml">G</mi><mo stretchy="false" id="S2.E11X.2.1.1.m1.2.3.3.2.3" xref="S2.E11X.2.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E11X.2.1.1.m1.2b"><apply id="S2.E11X.2.1.1.m1.2.3.cmml" xref="S2.E11X.2.1.1.m1.2.3"><times id="S2.E11X.2.1.1.m1.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.1"></times><apply id="S2.E11X.2.1.1.m1.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.2.3.2"><apply id="S2.E11X.2.1.1.m1.2.3.2.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.1"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.2.3.2.1.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.1">subscript</csymbol><min id="S2.E11X.2.1.1.m1.2.3.2.1.2.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.1.2"></min><ci id="S2.E11X.2.1.1.m1.2.3.2.1.3.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.1.3">𝐺</ci></apply><apply id="S2.E11X.2.1.1.m1.2.3.2.2.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2"><apply id="S2.E11X.2.1.1.m1.2.3.2.2.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2.1"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.2.3.2.2.1.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2.1">subscript</csymbol><max id="S2.E11X.2.1.1.m1.2.3.2.2.1.2.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2.1.2"></max><ci id="S2.E11X.2.1.1.m1.2.3.2.2.1.3.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2.1.3">𝐷</ci></apply><ci id="S2.E11X.2.1.1.m1.2.3.2.2.2.cmml" xref="S2.E11X.2.1.1.m1.2.3.2.2.2">𝑉</ci></apply></apply><interval closure="open" id="S2.E11X.2.1.1.m1.2.3.3.1.cmml" xref="S2.E11X.2.1.1.m1.2.3.3.2"><ci id="S2.E11X.2.1.1.m1.1.1.cmml" xref="S2.E11X.2.1.1.m1.1.1">𝐷</ci><ci id="S2.E11X.2.1.1.m1.2.2.cmml" xref="S2.E11X.2.1.1.m1.2.2">𝐺</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11X.2.1.1.m1.2c">\displaystyle\min_{G}\max_{D}V(D,G)</annotation><annotation encoding="application/x-llamapun" id="S2.E11X.2.1.1.m1.2d">roman_min start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT italic_V ( italic_D , italic_G )</annotation></semantics></math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E11X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\mathbb{E}_{\mathbf{x}\sim p_{\text{data}}}[\log D(\mathbf{x})]" display="inline"><semantics id="S2.E11X.3.2.2.m1.2a"><mrow id="S2.E11X.3.2.2.m1.2.2" xref="S2.E11X.3.2.2.m1.2.2.cmml"><mi id="S2.E11X.3.2.2.m1.2.2.3" xref="S2.E11X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S2.E11X.3.2.2.m1.2.2.2" xref="S2.E11X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S2.E11X.3.2.2.m1.2.2.1" xref="S2.E11X.3.2.2.m1.2.2.1.cmml"><msub id="S2.E11X.3.2.2.m1.2.2.1.3" xref="S2.E11X.3.2.2.m1.2.2.1.3.cmml"><mi id="S2.E11X.3.2.2.m1.2.2.1.3.2" xref="S2.E11X.3.2.2.m1.2.2.1.3.2.cmml">𝔼</mi><mrow id="S2.E11X.3.2.2.m1.2.2.1.3.3" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.cmml"><mi id="S2.E11X.3.2.2.m1.2.2.1.3.3.2" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.2.cmml">𝐱</mi><mo id="S2.E11X.3.2.2.m1.2.2.1.3.3.1" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.1.cmml">∼</mo><msub id="S2.E11X.3.2.2.m1.2.2.1.3.3.3" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.cmml"><mi id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.2" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.2.cmml">p</mi><mtext id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3a.cmml">data</mtext></msub></mrow></msub><mo id="S2.E11X.3.2.2.m1.2.2.1.2" xref="S2.E11X.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E11X.3.2.2.m1.2.2.1.1.1" xref="S2.E11X.3.2.2.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S2.E11X.3.2.2.m1.2.2.1.1.1.2" xref="S2.E11X.3.2.2.m1.2.2.1.1.2.1.cmml">[</mo><mrow id="S2.E11X.3.2.2.m1.2.2.1.1.1.1" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.1" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2a" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.cmml">⁡</mo><mi id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.2.cmml">D</mi></mrow><mo id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.1" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.3.2.1" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><mi id="S2.E11X.3.2.2.m1.1.1" xref="S2.E11X.3.2.2.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.3.2.2" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E11X.3.2.2.m1.2.2.1.1.1.3" xref="S2.E11X.3.2.2.m1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E11X.3.2.2.m1.2b"><apply id="S2.E11X.3.2.2.m1.2.2.cmml" xref="S2.E11X.3.2.2.m1.2.2"><eq id="S2.E11X.3.2.2.m1.2.2.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S2.E11X.3.2.2.m1.2.2.3.cmml" xref="S2.E11X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S2.E11X.3.2.2.m1.2.2.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1"><times id="S2.E11X.3.2.2.m1.2.2.1.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.2"></times><apply id="S2.E11X.3.2.2.m1.2.2.1.3.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S2.E11X.3.2.2.m1.2.2.1.3.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3">subscript</csymbol><ci id="S2.E11X.3.2.2.m1.2.2.1.3.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.2">𝔼</ci><apply id="S2.E11X.3.2.2.m1.2.2.1.3.3.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3"><csymbol cd="latexml" id="S2.E11X.3.2.2.m1.2.2.1.3.3.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.1">similar-to</csymbol><ci id="S2.E11X.3.2.2.m1.2.2.1.3.3.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.2">𝐱</ci><apply id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3">subscript</csymbol><ci id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.2">𝑝</ci><ci id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3a.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3"><mtext mathsize="50%" id="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.3.3.3.3">data</mtext></ci></apply></apply></apply><apply id="S2.E11X.3.2.2.m1.2.2.1.1.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E11X.3.2.2.m1.2.2.1.1.2.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1"><times id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.1"></times><apply id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2"><log id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.1"></log><ci id="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E11X.3.2.2.m1.2.2.1.1.1.1.2.2">𝐷</ci></apply><ci id="S2.E11X.3.2.2.m1.1.1.cmml" xref="S2.E11X.3.2.2.m1.1.1">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11X.3.2.2.m1.2c">\displaystyle=\mathbb{E}_{\mathbf{x}\sim p_{\text{data}}}[\log D(\mathbf{x})]</annotation><annotation encoding="application/x-llamapun" id="S2.E11X.3.2.2.m1.2d">= blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_p start_POSTSUBSCRIPT data end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_log italic_D ( bold_x ) ]</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(11)</span></td>
                                        </tr>
                                        <tr id="S2.E11Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_eqn_cell"></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E11Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle\quad+\mathbb{E}_{\mathbf{z}\sim p_{z}}[\log(1-D(G(\mathbf{z})))]," display="inline"><semantics id="S2.E11Xa.2.1.1.m1.3a"><mrow id="S2.E11Xa.2.1.1.m1.3.3.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.cmml"><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1a" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.cmml">+</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.cmml"><msub id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.2.cmml">𝐳</mi><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.1.cmml">∼</mo><msub id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.2.cmml">p</mi><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.3.cmml">z</mi></msub></mrow></msub><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S2.E11Xa.2.1.1.m1.2.2" xref="S2.E11Xa.2.1.1.m1.2.2.cmml">log</mi><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1a" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">1</mn><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">D</mi><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">G</mi><mo id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E11Xa.2.1.1.m1.1.1" xref="S2.E11Xa.2.1.1.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E11Xa.2.1.1.m1.3.3.1.2" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11Xa.2.1.1.m1.3b"><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1"><plus id="S2.E11Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1"></plus><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1"><times id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.2"></times><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3"><csymbol cd="latexml" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.1">similar-to</csymbol><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.2">𝐳</ci><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.2">𝑝</ci><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.3.3.3.3">𝑧</ci></apply></apply></apply><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1"><log id="S2.E11Xa.2.1.1.m1.2.2.cmml" xref="S2.E11Xa.2.1.1.m1.2.2"></log><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1"><minus id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2"></minus><cn type="integer" id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3">1</cn><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><times id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝐷</ci><apply id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐺</ci><ci id="S2.E11Xa.2.1.1.m1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.1.1">𝐳</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11Xa.2.1.1.m1.3c">\displaystyle\quad+\mathbb{E}_{\mathbf{z}\sim p_{z}}[\log(1-D(G(\mathbf{z})))],</annotation><annotation encoding="application/x-llamapun" id="S2.E11Xa.2.1.1.m1.3d">+ blackboard_E start_POSTSUBSCRIPT bold_z ∼ italic_p start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_log ( 1 - italic_D ( italic_G ( bold_z ) ) ) ] ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <p id="S2.SS2.SSS2.p3.5" class="ltx_p">where <math id="S2.SS2.SSS2.p3.3.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.SS2.SSS2.p3.3.m1.1a"><mi id="S2.SS2.SSS2.p3.3.m1.1.1" xref="S2.SS2.SSS2.p3.3.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.3.m1.1b"><ci id="S2.SS2.SSS2.p3.3.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.3.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.3.m1.1d">bold_x</annotation></semantics></math> represents real heatmaps and <math id="S2.SS2.SSS2.p3.4.m2.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S2.SS2.SSS2.p3.4.m2.1a"><mi id="S2.SS2.SSS2.p3.4.m2.1.1" xref="S2.SS2.SSS2.p3.4.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.4.m2.1b"><ci id="S2.SS2.SSS2.p3.4.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.4.m2.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.4.m2.1d">bold_z</annotation></semantics></math> is sampled from the latent distribution <math id="S2.SS2.SSS2.p3.5.m3.1" class="ltx_Math" alttext="p_{z}" display="inline"><semantics id="S2.SS2.SSS2.p3.5.m3.1a"><msub id="S2.SS2.SSS2.p3.5.m3.1.1" xref="S2.SS2.SSS2.p3.5.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p3.5.m3.1.1.2" xref="S2.SS2.SSS2.p3.5.m3.1.1.2.cmml">p</mi><mi id="S2.SS2.SSS2.p3.5.m3.1.1.3" xref="S2.SS2.SSS2.p3.5.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.5.m3.1b"><apply id="S2.SS2.SSS2.p3.5.m3.1.1.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.5.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.5.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.2">𝑝</ci><ci id="S2.SS2.SSS2.p3.5.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p3.5.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.5.m3.1c">p_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p3.5.m3.1d">italic_p start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>. This adversarial training ensures that generated heatmaps display plausible probabilistic occupancy distributions.</p>
                                </div>
                            </section>
                        </section>
                        <section id="S2.SS3" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">2.3 </span>Modular Training Approach</h3>

                            <div id="S2.SS3.p1" class="ltx_para ltx_noindent">
                                <p id="S2.SS3.p1.1" class="ltx_p">Our modular approach separates encoder and decoder training into distinct phases, enhancing flexibility, stability, and task-specific adaptability.</p>
                            </div>
                            <figure id="S2.F5" class="ltx_figure"><img src="./pora_paper_demo_files/hm_decoder_only_hm.png" id="S2.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="233" alt="Refer to caption">
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Initial Heatmap Outputs Generated by the GAN Decoder Without Encoder Attached: These heatmaps are produced solely by the GAN decoder from noise inputs, without any predictive meaning at this stage.</figcaption>
                            </figure>
                            <section id="S2.SS3.SSS1" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">2.3.1 </span>Independent Decoder Training</h4>

                                <div id="S2.SS3.SSS1.p1" class="ltx_para ltx_noindent">
                                    <p id="S2.SS3.SSS1.p1.1" class="ltx_p">The decoder is first trained independently using the adversarial loss defined above. The resolution of the heatmap (i.e., the number of cells in each dimension) is a design parameter that balances granularity with computational efficiency. The heatmap dataset used for pre-training the generator is obtained through a simulation process. Specifically, the process begins by identifying specific locations along the road, referred to as "trigger points." These trigger points are selected to represent key areas of interest, such as intersections, merging zones, or straight road segments. For each trigger point, the trajectories of vehicles are recorded after they pass the designated location. These trajectories include detailed positional information over time, which is then used to construct probabilistic heatmaps. For every trigger point, we generate a sequence of
                                        <math id="S2.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><mi id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><ci id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.1.m1.1d">italic_K</annotation></semantics></math> occupancy heatmaps, where each heatmap corresponds to a specific future time frame within a predefined prediction horizon. These heatmaps represent the likelihood of vehicle presence in each grid cell, providing a temporal snapshot of the dynamic traffic environment around the trigger point. Figure <a href="./pora_paper_demo_backup.html#S2.F5" title="Figure 5 ‣ 2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> provides two samples of heatmaps generated from the noise. The goal of this initial decoder-only training phase is to enable the GAN generator to produce ’realistic-looking’ probabilistic occupancy heatmaps that emulate plausible spatial distributions. This phase ensures the ability to generate coherent heatmap structures, establishing a foundation for the next phase where the encoder will be trained to utilize the decoder effectively for generating meaningful, context-aware predictions.</p>
                                </div>
                            </section>
                            <section id="S2.SS3.SSS2" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">2.3.2 </span>Encoder Training with Fixed Decoder</h4>

                                <div id="S2.SS3.SSS2.p1" class="ltx_para ltx_noindent">
                                    <p id="S2.SS3.SSS2.p1.1" class="ltx_p">Once the decoder is pre-trained, the encoder is trained with the weights of the decoder fixed. Using the ground truth of occupancy mapped by snapshots of the trajectory over time as the ground-truth heatmaps <math id="S2.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\{H_{t_{k}}\}_{k=1}^{K}" display="inline"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><msubsup id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml"><mrow id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.2.cmml">H</mi><msub id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.SSS2.p1.1.m1.1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.2.cmml">k</mi><mo id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.SSS2.p1.1.m1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><apply id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><set id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1"><apply id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.2">𝐻</ci><apply id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></set><apply id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3"><eq id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.1"></eq><ci id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S2.SS3.SSS2.p1.1.m1.1.1.1.3.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">\{H_{t_{k}}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.m1.1d">{ italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, the encoder is optimized to produce latent representations that align with the pre-trained decoder output.</p>
                                </div>
                                <div id="S2.SS3.SSS2.p2" class="ltx_para ltx_noindent">
                                    <p id="S2.SS3.SSS2.p2.5" class="ltx_p">The encoder is trained using a cross-entropy loss, suitable for probabilistic prediction tasks:</p>
                                    <table id="S2.E12" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E12.m1.3" class="ltx_Math" alttext="L=-\frac{1}{C}\sum_{c=1}^{C}\left[y_{c}\log(\hat{y}_{c})+(1-y_{c})\log(1-\hat{%
y}_{c})\right]," display="block"><semantics id="S2.E12.m1.3a"><mrow id="S2.E12.m1.3.3.1" xref="S2.E12.m1.3.3.1.1.cmml"><mrow id="S2.E12.m1.3.3.1.1" xref="S2.E12.m1.3.3.1.1.cmml"><mi id="S2.E12.m1.3.3.1.1.3" xref="S2.E12.m1.3.3.1.1.3.cmml">L</mi><mo id="S2.E12.m1.3.3.1.1.2" xref="S2.E12.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E12.m1.3.3.1.1.1" xref="S2.E12.m1.3.3.1.1.1.cmml"><mo id="S2.E12.m1.3.3.1.1.1a" xref="S2.E12.m1.3.3.1.1.1.cmml">−</mo><mrow id="S2.E12.m1.3.3.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.cmml"><mfrac id="S2.E12.m1.3.3.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.3.cmml"><mn id="S2.E12.m1.3.3.1.1.1.1.3.2" xref="S2.E12.m1.3.3.1.1.1.1.3.2.cmml">1</mn><mi id="S2.E12.m1.3.3.1.1.1.1.3.3" xref="S2.E12.m1.3.3.1.1.1.1.3.3.cmml">C</mi></mfrac><mo id="S2.E12.m1.3.3.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.cmml"><munderover id="S2.E12.m1.3.3.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E12.m1.3.3.1.1.1.1.1.2.2.2" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.2" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.1" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.3" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E12.m1.3.3.1.1.1.1.1.2.3" xref="S2.E12.m1.3.3.1.1.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0.167em" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml">log</mi><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1a" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.4.cmml">+</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">y</mi><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">⁢</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E12.m1.2.2" xref="S2.E12.m1.2.2.cmml">log</mi><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1a" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">⁡</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml"><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">(</mo><mrow id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml"><mn id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.2.cmml">1</mn><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.1.cmml">−</mo><msub id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.cmml"><mover accent="true" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.cmml"><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2.cmml">y</mi><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.1" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E12.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E12.m1.3.3.1.2" xref="S2.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.3b"><apply id="S2.E12.m1.3.3.1.1.cmml" xref="S2.E12.m1.3.3.1"><eq id="S2.E12.m1.3.3.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.2"></eq><ci id="S2.E12.m1.3.3.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.3">𝐿</ci><apply id="S2.E12.m1.3.3.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1"><minus id="S2.E12.m1.3.3.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1"></minus><apply id="S2.E12.m1.3.3.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1"><times id="S2.E12.m1.3.3.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.2"></times><apply id="S2.E12.m1.3.3.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.3"><divide id="S2.E12.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.3"></divide><cn type="integer" id="S2.E12.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.3.2">1</cn><ci id="S2.E12.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.3.3">𝐶</ci></apply><apply id="S2.E12.m1.3.3.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1"><apply id="S2.E12.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E12.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.2"></sum><apply id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3"><eq id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E12.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1"><plus id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.4"></plus><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><log id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1"></log><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.3"></times><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1"><minus id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑦</ci><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1"><log id="S2.E12.m1.2.2.cmml" xref="S2.E12.m1.2.2"></log><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1"><minus id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.1"></minus><cn type="integer" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.2">1</cn><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3">subscript</csymbol><apply id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2"><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.1.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.1">^</ci><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.2.2">𝑦</ci></apply><ci id="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.3.cmml" xref="S2.E12.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.3c">L=-\frac{1}{C}\sum_{c=1}^{C}\left[y_{c}\log(\hat{y}_{c})+(1-y_{c})\log(1-\hat{%
                                                y}_{c})\right],</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.3d">italic_L = - divide start_ARG 1 end_ARG start_ARG italic_C end_ARG ∑ start_POSTSUBSCRIPT italic_c = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_C end_POSTSUPERSCRIPT [ italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S2.SS3.SSS2.p2.4" class="ltx_p">where <math id="S2.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><mi id="S2.SS3.SSS2.p2.1.m1.1.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><ci id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.1.m1.1d">italic_C</annotation></semantics></math> is the number of cells, <math id="S2.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="y_{c}" display="inline"><semantics id="S2.SS3.SSS2.p2.2.m2.1a"><msub id="S2.SS3.SSS2.p2.2.m2.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml">y</mi><mi id="S2.SS3.SSS2.p2.2.m2.1.1.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.2.m2.1b"><apply id="S2.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.2">𝑦</ci><ci id="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.2.m2.1c">y_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the ground-truth occupancy for cell <math id="S2.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.SSS2.p2.3.m3.1a"><mi id="S2.SS3.SSS2.p2.3.m3.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.3.m3.1b"><ci id="S2.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.3.m3.1c">c</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.3.m3.1d">italic_c</annotation></semantics></math>, and <math id="S2.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\hat{y}_{c}" display="inline"><semantics id="S2.SS3.SSS2.p2.4.m4.1a"><msub id="S2.SS3.SSS2.p2.4.m4.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.cmml"><mover accent="true" id="S2.SS3.SSS2.p2.4.m4.1.1.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml"><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2.cmml">y</mi><mo id="S2.SS3.SSS2.p2.4.m4.1.1.2.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.SSS2.p2.4.m4.1.1.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.4.m4.1b"><apply id="S2.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1">subscript</csymbol><apply id="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2"><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.1">^</ci><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2">𝑦</ci></apply><ci id="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.4.m4.1c">\hat{y}_{c}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p2.4.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is the predicted probability.</p>
                                </div>
                            </section>
                            <section id="S2.SS3.SSS3" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">2.3.3 </span>End-to-End Fine-Tuning</h4>

                                <div id="S2.SS3.SSS3.p1" class="ltx_para ltx_noindent">
                                    <p id="S2.SS3.SSS3.p1.5" class="ltx_p">An optional fine-tuning phase jointly optimizes both encoder and decoder, further refining the model’s overall predictive capability:</p>
                                    <table id="S2.E13" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S2.E13.m1.5" class="ltx_Math" alttext="\min_{\theta_{e},\theta_{d}}L(\mathbf{H},\hat{\mathbf{H}})," display="block"><semantics id="S2.E13.m1.5a"><mrow id="S2.E13.m1.5.5.1" xref="S2.E13.m1.5.5.1.1.cmml"><mrow id="S2.E13.m1.5.5.1.1" xref="S2.E13.m1.5.5.1.1.cmml"><mrow id="S2.E13.m1.5.5.1.1.2" xref="S2.E13.m1.5.5.1.1.2.cmml"><munder id="S2.E13.m1.5.5.1.1.2.1" xref="S2.E13.m1.5.5.1.1.2.1.cmml"><mi id="S2.E13.m1.5.5.1.1.2.1.2" xref="S2.E13.m1.5.5.1.1.2.1.2.cmml">min</mi><mrow id="S2.E13.m1.2.2.2.2" xref="S2.E13.m1.2.2.2.3.cmml"><msub id="S2.E13.m1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E13.m1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.E13.m1.2.2.2.2.3" xref="S2.E13.m1.2.2.2.3.cmml">,</mo><msub id="S2.E13.m1.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.cmml"><mi id="S2.E13.m1.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.cmml">θ</mi><mi id="S2.E13.m1.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.3.cmml">d</mi></msub></mrow></munder><mo lspace="0.167em" id="S2.E13.m1.5.5.1.1.2a" xref="S2.E13.m1.5.5.1.1.2.cmml">⁡</mo><mi id="S2.E13.m1.5.5.1.1.2.2" xref="S2.E13.m1.5.5.1.1.2.2.cmml">L</mi></mrow><mo id="S2.E13.m1.5.5.1.1.1" xref="S2.E13.m1.5.5.1.1.1.cmml">⁢</mo><mrow id="S2.E13.m1.5.5.1.1.3.2" xref="S2.E13.m1.5.5.1.1.3.1.cmml"><mo stretchy="false" id="S2.E13.m1.5.5.1.1.3.2.1" xref="S2.E13.m1.5.5.1.1.3.1.cmml">(</mo><mi id="S2.E13.m1.3.3" xref="S2.E13.m1.3.3.cmml">𝐇</mi><mo id="S2.E13.m1.5.5.1.1.3.2.2" xref="S2.E13.m1.5.5.1.1.3.1.cmml">,</mo><mover accent="true" id="S2.E13.m1.4.4" xref="S2.E13.m1.4.4.cmml"><mi id="S2.E13.m1.4.4.2" xref="S2.E13.m1.4.4.2.cmml">𝐇</mi><mo id="S2.E13.m1.4.4.1" xref="S2.E13.m1.4.4.1.cmml">^</mo></mover><mo stretchy="false" id="S2.E13.m1.5.5.1.1.3.2.3" xref="S2.E13.m1.5.5.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E13.m1.5.5.1.2" xref="S2.E13.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.5b"><apply id="S2.E13.m1.5.5.1.1.cmml" xref="S2.E13.m1.5.5.1"><times id="S2.E13.m1.5.5.1.1.1.cmml" xref="S2.E13.m1.5.5.1.1.1"></times><apply id="S2.E13.m1.5.5.1.1.2.cmml" xref="S2.E13.m1.5.5.1.1.2"><apply id="S2.E13.m1.5.5.1.1.2.1.cmml" xref="S2.E13.m1.5.5.1.1.2.1"><csymbol cd="ambiguous" id="S2.E13.m1.5.5.1.1.2.1.1.cmml" xref="S2.E13.m1.5.5.1.1.2.1">subscript</csymbol><min id="S2.E13.m1.5.5.1.1.2.1.2.cmml" xref="S2.E13.m1.5.5.1.1.2.1.2"></min><list id="S2.E13.m1.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2"><apply id="S2.E13.m1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E13.m1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.3">𝑒</ci></apply><apply id="S2.E13.m1.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.E13.m1.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2">𝜃</ci><ci id="S2.E13.m1.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.3">𝑑</ci></apply></list></apply><ci id="S2.E13.m1.5.5.1.1.2.2.cmml" xref="S2.E13.m1.5.5.1.1.2.2">𝐿</ci></apply><interval closure="open" id="S2.E13.m1.5.5.1.1.3.1.cmml" xref="S2.E13.m1.5.5.1.1.3.2"><ci id="S2.E13.m1.3.3.cmml" xref="S2.E13.m1.3.3">𝐇</ci><apply id="S2.E13.m1.4.4.cmml" xref="S2.E13.m1.4.4"><ci id="S2.E13.m1.4.4.1.cmml" xref="S2.E13.m1.4.4.1">^</ci><ci id="S2.E13.m1.4.4.2.cmml" xref="S2.E13.m1.4.4.2">𝐇</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.5c">\min_{\theta_{e},\theta_{d}}L(\mathbf{H},\hat{\mathbf{H}}),</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.5d">roman_min start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_L ( bold_H , over^ start_ARG bold_H end_ARG ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S2.SS3.SSS3.p1.4" class="ltx_p">where <math id="S2.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{H}" display="inline"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><mi id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">𝐇</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">𝐇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">\mathbf{H}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.1.m1.1d">bold_H</annotation></semantics></math> and <math id="S2.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\hat{\mathbf{H}}" display="inline"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><mover accent="true" id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p1.2.m2.1.1.2" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml">𝐇</mi><mo id="S2.SS3.SSS3.p1.2.m2.1.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><apply id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1"><ci id="S2.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.1">^</ci><ci id="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2">𝐇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\hat{\mathbf{H}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.2.m2.1d">over^ start_ARG bold_H end_ARG</annotation></semantics></math> denote true and predicted heatmaps. This final stage preserves modularity while optimizing the interactions between <math id="S2.SS3.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\theta_{e}" display="inline"><semantics id="S2.SS3.SSS3.p1.3.m3.1a"><msub id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS3.SSS3.p1.3.m3.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.1b"><apply id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.2">𝜃</ci><ci id="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.1c">\theta_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.3.m3.1d">italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S2.SS3.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\theta_{d}" display="inline"><semantics id="S2.SS3.SSS3.p1.4.m4.1a"><msub id="S2.SS3.SSS3.p1.4.m4.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS3.SSS3.p1.4.m4.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.1b"><apply id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.2">𝜃</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.1c">\theta_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.4.m4.1d">italic_θ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                </div>
                            </section>
                        </section>
                    </section>
                    <section id="S3" class="ltx_section">
                        <h2 class="ltx_title ltx_title_section">
                            <span class="ltx_tag ltx_tag_section">3 </span>Experiments and Results</h2>

                        <div id="S3.p1" class="ltx_para ltx_noindent">
                            <p id="S3.p1.1" class="ltx_p">This section describes the experimental setup, training procedure, and performance evaluation of the proposed modular framework for probabilistic occupancy heatmap generation. The goal is to assess the accuracy of the heatmaps, their spatial alignment with drivable areas, and the ability to capture uncertainties relevant to autonomous vehicle operations.</p>
                        </div>
                        <section id="S3.SS1" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Setup</h3>

                            <div id="S3.SS1.p1" class="ltx_para ltx_noindent">
                                <p id="S3.SS1.p1.1" class="ltx_p"><span class="highlight" data-comment="comment3">The proposed framework was evaluated using both real-world and simulated datasets:</span></p>
                            </div>
                            <div id="S3.SS1.p2" class="ltx_para ltx_noindent">
                                <ul id="S3.I1" class="ltx_itemize">
                                    <li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
                                        <span class="ltx_tag ltx_tag_item">•</span>
                                        <div id="S3.I1.i1.p1" class="ltx_para">
                                            <p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Real-World Data:</span> The Argoverse 2 Motion Forecasting Dataset&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="./pora_paper_demo_backup.html#bib.bib17" title="" class="ltx_ref">17</a>]</cite> provides trajectory data for various traffic agents across diverse urban environments. These annotations include positional information, lane geometries, and context-relevant metadata.</p>
                                        </div>
                                    </li>
                                    <li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
                                        <span class="ltx_tag ltx_tag_item">•</span>
                                        <div id="S3.I1.i2.p1" class="ltx_para ltx_noindent">
                                            <p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Simulated Data:</span> The SUMO (Simulation of Urban MObility) platform was utilized to create synthetic traffic scenarios. These simulations reconstructed real-world road layouts from six U.S. cities in the Argoverse dataset: Austin, (TX); Detroit (MI); Miami, (FL); Pittsburgh, (PA); Palo Alto, (CA); and Washington, D.C. SUMO’s capability to model diverse scenarios such as intersections, highways, and mixed traffic enabled the generation of rich occupancy heatmaps. For each scenario, we defined trigger points to capture vehicle trajectories and aggregated probabilistic heatmaps for <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_K</annotation></semantics></math> future frames.</p>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            <div id="S3.SS1.p3" class="ltx_para ltx_noindent">
                                <p id="S3.SS1.p3.1" class="ltx_p">The combined dataset enabled the model to generalize across various traffic conditions, enhancing its practical utility.</p>
                            </div>
                        </section>
                        <section id="S3.SS2" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">3.2 </span>Training Procedure</h3>

                            <div id="S3.SS2.p1" class="ltx_para ltx_noindent">
                                <p id="S3.SS2.p1.1" class="ltx_p">The training process was designed in multiple modular phases to ensure flexibility and adaptability.</p>
                            </div>
                            <section id="S3.SS2.SSS1" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Initial Decoder Training Using GAN</h4>

                                <div id="S3.SS2.SSS1.p1" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS1.p1.1" class="ltx_p">The decoder (<span id="S3.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_bold">Decoder 0</span>) was initially trained using a Generative Adversarial Network (GAN) framework. The objective was to generate visually realistic heatmaps that represent potential vehicle occupancies.</p>
                                </div>
                                <div id="S3.SS2.SSS1.p2" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS1.p2.1" class="ltx_p">The GAN setup involved:</p>
                                    <ul id="S3.I2" class="ltx_itemize">
                                        <li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I2.i1.p1" class="ltx_para">
                                                <p id="S3.I2.i1.p1.3" class="ltx_p"><span id="S3.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">Generator (<math id="S3.I2.i1.p1.1.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.I2.i1.p1.1.1.m1.1a"><mi id="S3.I2.i1.p1.1.1.m1.1.1" xref="S3.I2.i1.p1.1.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.1.m1.1b"><ci id="S3.I2.i1.p1.1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.1.m1.1d">italic_G</annotation></semantics></math>):</span> The decoder received noise vectors <math id="S3.I2.i1.p1.2.m1.1" class="ltx_Math" alttext="\mathbf{z}\sim p_{z}" display="inline"><semantics id="S3.I2.i1.p1.2.m1.1a"><mrow id="S3.I2.i1.p1.2.m1.1.1" xref="S3.I2.i1.p1.2.m1.1.1.cmml"><mi id="S3.I2.i1.p1.2.m1.1.1.2" xref="S3.I2.i1.p1.2.m1.1.1.2.cmml">𝐳</mi><mo id="S3.I2.i1.p1.2.m1.1.1.1" xref="S3.I2.i1.p1.2.m1.1.1.1.cmml">∼</mo><msub id="S3.I2.i1.p1.2.m1.1.1.3" xref="S3.I2.i1.p1.2.m1.1.1.3.cmml"><mi id="S3.I2.i1.p1.2.m1.1.1.3.2" xref="S3.I2.i1.p1.2.m1.1.1.3.2.cmml">p</mi><mi id="S3.I2.i1.p1.2.m1.1.1.3.3" xref="S3.I2.i1.p1.2.m1.1.1.3.3.cmml">z</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.2.m1.1b"><apply id="S3.I2.i1.p1.2.m1.1.1.cmml" xref="S3.I2.i1.p1.2.m1.1.1"><csymbol cd="latexml" id="S3.I2.i1.p1.2.m1.1.1.1.cmml" xref="S3.I2.i1.p1.2.m1.1.1.1">similar-to</csymbol><ci id="S3.I2.i1.p1.2.m1.1.1.2.cmml" xref="S3.I2.i1.p1.2.m1.1.1.2">𝐳</ci><apply id="S3.I2.i1.p1.2.m1.1.1.3.cmml" xref="S3.I2.i1.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.2.m1.1.1.3.1.cmml" xref="S3.I2.i1.p1.2.m1.1.1.3">subscript</csymbol><ci id="S3.I2.i1.p1.2.m1.1.1.3.2.cmml" xref="S3.I2.i1.p1.2.m1.1.1.3.2">𝑝</ci><ci id="S3.I2.i1.p1.2.m1.1.1.3.3.cmml" xref="S3.I2.i1.p1.2.m1.1.1.3.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.2.m1.1c">\mathbf{z}\sim p_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.2.m1.1d">bold_z ∼ italic_p start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> as input and generated heatmaps <math id="S3.I2.i1.p1.3.m2.1" class="ltx_Math" alttext="H_{t_{k}}" display="inline"><semantics id="S3.I2.i1.p1.3.m2.1a"><msub id="S3.I2.i1.p1.3.m2.1.1" xref="S3.I2.i1.p1.3.m2.1.1.cmml"><mi id="S3.I2.i1.p1.3.m2.1.1.2" xref="S3.I2.i1.p1.3.m2.1.1.2.cmml">H</mi><msub id="S3.I2.i1.p1.3.m2.1.1.3" xref="S3.I2.i1.p1.3.m2.1.1.3.cmml"><mi id="S3.I2.i1.p1.3.m2.1.1.3.2" xref="S3.I2.i1.p1.3.m2.1.1.3.2.cmml">t</mi><mi id="S3.I2.i1.p1.3.m2.1.1.3.3" xref="S3.I2.i1.p1.3.m2.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.3.m2.1b"><apply id="S3.I2.i1.p1.3.m2.1.1.cmml" xref="S3.I2.i1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.1.1.1.cmml" xref="S3.I2.i1.p1.3.m2.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.3.m2.1.1.2.cmml" xref="S3.I2.i1.p1.3.m2.1.1.2">𝐻</ci><apply id="S3.I2.i1.p1.3.m2.1.1.3.cmml" xref="S3.I2.i1.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.I2.i1.p1.3.m2.1.1.3.1.cmml" xref="S3.I2.i1.p1.3.m2.1.1.3">subscript</csymbol><ci id="S3.I2.i1.p1.3.m2.1.1.3.2.cmml" xref="S3.I2.i1.p1.3.m2.1.1.3.2">𝑡</ci><ci id="S3.I2.i1.p1.3.m2.1.1.3.3.cmml" xref="S3.I2.i1.p1.3.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.3.m2.1c">H_{t_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.3.m2.1d">italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                            </div>
                                        </li>
                                        <li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I2.i2.p1" class="ltx_para ltx_noindent">
                                                <p id="S3.I2.i2.p1.3" class="ltx_p"><span id="S3.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">Discriminator (<math id="S3.I2.i2.p1.1.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.I2.i2.p1.1.1.m1.1a"><mi id="S3.I2.i2.p1.1.1.m1.1.1" xref="S3.I2.i2.p1.1.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.1.m1.1b"><ci id="S3.I2.i2.p1.1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.1.m1.1d">italic_D</annotation></semantics></math>):</span> Trained to distinguish between real heatmaps from the dataset (<math id="S3.I2.i2.p1.2.m1.1" class="ltx_Math" alttext="H_{\text{real}}" display="inline"><semantics id="S3.I2.i2.p1.2.m1.1a"><msub id="S3.I2.i2.p1.2.m1.1.1" xref="S3.I2.i2.p1.2.m1.1.1.cmml"><mi id="S3.I2.i2.p1.2.m1.1.1.2" xref="S3.I2.i2.p1.2.m1.1.1.2.cmml">H</mi><mtext id="S3.I2.i2.p1.2.m1.1.1.3" xref="S3.I2.i2.p1.2.m1.1.1.3a.cmml">real</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.2.m1.1b"><apply id="S3.I2.i2.p1.2.m1.1.1.cmml" xref="S3.I2.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.2.m1.1.1.1.cmml" xref="S3.I2.i2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.2.m1.1.1.2.cmml" xref="S3.I2.i2.p1.2.m1.1.1.2">𝐻</ci><ci id="S3.I2.i2.p1.2.m1.1.1.3a.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3"><mtext mathsize="70%" id="S3.I2.i2.p1.2.m1.1.1.3.cmml" xref="S3.I2.i2.p1.2.m1.1.1.3">real</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.2.m1.1c">H_{\text{real}}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.2.m1.1d">italic_H start_POSTSUBSCRIPT real end_POSTSUBSCRIPT</annotation></semantics></math>) and generated heatmaps (<math id="S3.I2.i2.p1.3.m2.1" class="ltx_Math" alttext="H_{\text{gen}}=G(\mathbf{z})" display="inline"><semantics id="S3.I2.i2.p1.3.m2.1a"><mrow id="S3.I2.i2.p1.3.m2.1.2" xref="S3.I2.i2.p1.3.m2.1.2.cmml"><msub id="S3.I2.i2.p1.3.m2.1.2.2" xref="S3.I2.i2.p1.3.m2.1.2.2.cmml"><mi id="S3.I2.i2.p1.3.m2.1.2.2.2" xref="S3.I2.i2.p1.3.m2.1.2.2.2.cmml">H</mi><mtext id="S3.I2.i2.p1.3.m2.1.2.2.3" xref="S3.I2.i2.p1.3.m2.1.2.2.3a.cmml">gen</mtext></msub><mo id="S3.I2.i2.p1.3.m2.1.2.1" xref="S3.I2.i2.p1.3.m2.1.2.1.cmml">=</mo><mrow id="S3.I2.i2.p1.3.m2.1.2.3" xref="S3.I2.i2.p1.3.m2.1.2.3.cmml"><mi id="S3.I2.i2.p1.3.m2.1.2.3.2" xref="S3.I2.i2.p1.3.m2.1.2.3.2.cmml">G</mi><mo id="S3.I2.i2.p1.3.m2.1.2.3.1" xref="S3.I2.i2.p1.3.m2.1.2.3.1.cmml">⁢</mo><mrow id="S3.I2.i2.p1.3.m2.1.2.3.3.2" xref="S3.I2.i2.p1.3.m2.1.2.3.cmml"><mo stretchy="false" id="S3.I2.i2.p1.3.m2.1.2.3.3.2.1" xref="S3.I2.i2.p1.3.m2.1.2.3.cmml">(</mo><mi id="S3.I2.i2.p1.3.m2.1.1" xref="S3.I2.i2.p1.3.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="S3.I2.i2.p1.3.m2.1.2.3.3.2.2" xref="S3.I2.i2.p1.3.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.3.m2.1b"><apply id="S3.I2.i2.p1.3.m2.1.2.cmml" xref="S3.I2.i2.p1.3.m2.1.2"><eq id="S3.I2.i2.p1.3.m2.1.2.1.cmml" xref="S3.I2.i2.p1.3.m2.1.2.1"></eq><apply id="S3.I2.i2.p1.3.m2.1.2.2.cmml" xref="S3.I2.i2.p1.3.m2.1.2.2"><csymbol cd="ambiguous" id="S3.I2.i2.p1.3.m2.1.2.2.1.cmml" xref="S3.I2.i2.p1.3.m2.1.2.2">subscript</csymbol><ci id="S3.I2.i2.p1.3.m2.1.2.2.2.cmml" xref="S3.I2.i2.p1.3.m2.1.2.2.2">𝐻</ci><ci id="S3.I2.i2.p1.3.m2.1.2.2.3a.cmml" xref="S3.I2.i2.p1.3.m2.1.2.2.3"><mtext mathsize="70%" id="S3.I2.i2.p1.3.m2.1.2.2.3.cmml" xref="S3.I2.i2.p1.3.m2.1.2.2.3">gen</mtext></ci></apply><apply id="S3.I2.i2.p1.3.m2.1.2.3.cmml" xref="S3.I2.i2.p1.3.m2.1.2.3"><times id="S3.I2.i2.p1.3.m2.1.2.3.1.cmml" xref="S3.I2.i2.p1.3.m2.1.2.3.1"></times><ci id="S3.I2.i2.p1.3.m2.1.2.3.2.cmml" xref="S3.I2.i2.p1.3.m2.1.2.3.2">𝐺</ci><ci id="S3.I2.i2.p1.3.m2.1.1.cmml" xref="S3.I2.i2.p1.3.m2.1.1">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.3.m2.1c">H_{\text{gen}}=G(\mathbf{z})</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.3.m2.1d">italic_H start_POSTSUBSCRIPT gen end_POSTSUBSCRIPT = italic_G ( bold_z )</annotation></semantics></math>).</p>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div id="S3.SS2.SSS1.p3" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS1.p3.2" class="ltx_p">The adversarial loss was optimized as:</p>
                                    <table id="S3.E14" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.42" class="ltx_Math" alttext="\begin{split}\min_{G}\max_{D}\mathcal{L}(D,G)=&amp;\ \mathbb{E}_{H_{\text{real}}%
\sim p_{\text{data}}}[\log D(H_{\text{real}})]\\
&amp;+\mathbb{E}_{\mathbf{z}\sim p_{z}}[\log(1-D(G(\mathbf{z})))].\end{split}" display="block"><semantics id="S3.E14.m1.42a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E14.m1.42.42.3"><mtr id="S3.E14.m1.42.42.3a"><mtd class="ltx_align_right" columnalign="right" id="S3.E14.m1.42.42.3b"><mrow id="S3.E14.m1.11.11.11.11.11"><mrow id="S3.E14.m1.11.11.11.11.11.12"><mrow id="S3.E14.m1.11.11.11.11.11.12.2"><munder id="S3.E14.m1.11.11.11.11.11.12.2.1"><mi id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml">min</mi><mi id="S3.E14.m1.2.2.2.2.2.2.1" xref="S3.E14.m1.2.2.2.2.2.2.1.cmml">G</mi></munder><mo lspace="0.167em" id="S3.E14.m1.11.11.11.11.11.12.2a" xref="S3.E14.m1.40.40.1.1.1.cmml">⁡</mo><mrow id="S3.E14.m1.11.11.11.11.11.12.2.2"><munder id="S3.E14.m1.11.11.11.11.11.12.2.2.1"><mi id="S3.E14.m1.3.3.3.3.3.3" xref="S3.E14.m1.3.3.3.3.3.3.cmml">max</mi><mi id="S3.E14.m1.4.4.4.4.4.4.1" xref="S3.E14.m1.4.4.4.4.4.4.1.cmml">D</mi></munder><mo lspace="0.167em" id="S3.E14.m1.11.11.11.11.11.12.2.2a" xref="S3.E14.m1.40.40.1.1.1.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.5.5.5.5.5.5" xref="S3.E14.m1.5.5.5.5.5.5.cmml">ℒ</mi></mrow></mrow><mo id="S3.E14.m1.11.11.11.11.11.12.1" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.11.11.11.11.11.12.3"><mo stretchy="false" id="S3.E14.m1.6.6.6.6.6.6" xref="S3.E14.m1.40.40.1.1.1.cmml">(</mo><mi id="S3.E14.m1.7.7.7.7.7.7" xref="S3.E14.m1.7.7.7.7.7.7.cmml">D</mi><mo id="S3.E14.m1.8.8.8.8.8.8" xref="S3.E14.m1.40.40.1.1.1.cmml">,</mo><mi id="S3.E14.m1.9.9.9.9.9.9" xref="S3.E14.m1.9.9.9.9.9.9.cmml">G</mi><mo stretchy="false" id="S3.E14.m1.10.10.10.10.10.10" xref="S3.E14.m1.40.40.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.11.11.11.11.11.11" xref="S3.E14.m1.11.11.11.11.11.11.cmml">=</mo><mi id="S3.E14.m1.11.11.11.11.11.13" xref="S3.E14.m1.40.40.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.42.42.3c"><mrow id="S3.E14.m1.41.41.2.40.22.11"><msub id="S3.E14.m1.41.41.2.40.22.11.13"><mi id="S3.E14.m1.12.12.12.12.1.1" xref="S3.E14.m1.12.12.12.12.1.1.cmml">𝔼</mi><mrow id="S3.E14.m1.13.13.13.13.2.2.1" xref="S3.E14.m1.13.13.13.13.2.2.1.cmml"><msub id="S3.E14.m1.13.13.13.13.2.2.1.2" xref="S3.E14.m1.13.13.13.13.2.2.1.2.cmml"><mi id="S3.E14.m1.13.13.13.13.2.2.1.2.2" xref="S3.E14.m1.13.13.13.13.2.2.1.2.2.cmml">H</mi><mtext id="S3.E14.m1.13.13.13.13.2.2.1.2.3" xref="S3.E14.m1.13.13.13.13.2.2.1.2.3a.cmml">real</mtext></msub><mo id="S3.E14.m1.13.13.13.13.2.2.1.1" xref="S3.E14.m1.13.13.13.13.2.2.1.1.cmml">∼</mo><msub id="S3.E14.m1.13.13.13.13.2.2.1.3" xref="S3.E14.m1.13.13.13.13.2.2.1.3.cmml"><mi id="S3.E14.m1.13.13.13.13.2.2.1.3.2" xref="S3.E14.m1.13.13.13.13.2.2.1.3.2.cmml">p</mi><mtext id="S3.E14.m1.13.13.13.13.2.2.1.3.3" xref="S3.E14.m1.13.13.13.13.2.2.1.3.3a.cmml">data</mtext></msub></mrow></msub><mo id="S3.E14.m1.41.41.2.40.22.11.12" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.41.41.2.40.22.11.11.1"><mo stretchy="false" id="S3.E14.m1.14.14.14.14.3.3" xref="S3.E14.m1.40.40.1.1.1.cmml">[</mo><mrow id="S3.E14.m1.41.41.2.40.22.11.11.1.1"><mrow id="S3.E14.m1.41.41.2.40.22.11.11.1.1.3"><mi id="S3.E14.m1.15.15.15.15.4.4" xref="S3.E14.m1.15.15.15.15.4.4.cmml">log</mi><mo lspace="0.167em" id="S3.E14.m1.41.41.2.40.22.11.11.1.1.3a" xref="S3.E14.m1.40.40.1.1.1.cmml">⁡</mo><mi id="S3.E14.m1.16.16.16.16.5.5" xref="S3.E14.m1.16.16.16.16.5.5.cmml">D</mi></mrow><mo id="S3.E14.m1.41.41.2.40.22.11.11.1.1.2" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.41.41.2.40.22.11.11.1.1.1.1"><mo stretchy="false" id="S3.E14.m1.17.17.17.17.6.6" xref="S3.E14.m1.40.40.1.1.1.cmml">(</mo><msub id="S3.E14.m1.41.41.2.40.22.11.11.1.1.1.1.1"><mi id="S3.E14.m1.18.18.18.18.7.7" xref="S3.E14.m1.18.18.18.18.7.7.cmml">H</mi><mtext id="S3.E14.m1.19.19.19.19.8.8.1" xref="S3.E14.m1.19.19.19.19.8.8.1a.cmml">real</mtext></msub><mo stretchy="false" id="S3.E14.m1.20.20.20.20.9.9" xref="S3.E14.m1.40.40.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.21.21.21.21.10.10" xref="S3.E14.m1.40.40.1.1.1.cmml">]</mo></mrow></mrow></mtd></mtr><mtr id="S3.E14.m1.42.42.3d"><mtd id="S3.E14.m1.42.42.3e" xref="S3.E14.m1.40.40.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E14.m1.42.42.3f"><mrow id="S3.E14.m1.42.42.3.41.19.19.19"><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1"><mo id="S3.E14.m1.42.42.3.41.19.19.19.1a" xref="S3.E14.m1.40.40.1.1.1.cmml">+</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1"><msub id="S3.E14.m1.42.42.3.41.19.19.19.1.1.3"><mi id="S3.E14.m1.23.23.23.2.2.2" xref="S3.E14.m1.23.23.23.2.2.2.cmml">𝔼</mi><mrow id="S3.E14.m1.24.24.24.3.3.3.1" xref="S3.E14.m1.24.24.24.3.3.3.1.cmml"><mi id="S3.E14.m1.24.24.24.3.3.3.1.2" xref="S3.E14.m1.24.24.24.3.3.3.1.2.cmml">𝐳</mi><mo id="S3.E14.m1.24.24.24.3.3.3.1.1" xref="S3.E14.m1.24.24.24.3.3.3.1.1.cmml">∼</mo><msub id="S3.E14.m1.24.24.24.3.3.3.1.3" xref="S3.E14.m1.24.24.24.3.3.3.1.3.cmml"><mi id="S3.E14.m1.24.24.24.3.3.3.1.3.2" xref="S3.E14.m1.24.24.24.3.3.3.1.3.2.cmml">p</mi><mi id="S3.E14.m1.24.24.24.3.3.3.1.3.3" xref="S3.E14.m1.24.24.24.3.3.3.1.3.3.cmml">z</mi></msub></mrow></msub><mo id="S3.E14.m1.42.42.3.41.19.19.19.1.1.2" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1"><mo stretchy="false" id="S3.E14.m1.25.25.25.4.4.4" xref="S3.E14.m1.40.40.1.1.1.cmml">[</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1"><mi id="S3.E14.m1.26.26.26.5.5.5" xref="S3.E14.m1.26.26.26.5.5.5.cmml">log</mi><mo id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1a" xref="S3.E14.m1.40.40.1.1.1.cmml">⁡</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E14.m1.27.27.27.6.6.6" xref="S3.E14.m1.40.40.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1"><mn id="S3.E14.m1.28.28.28.7.7.7" xref="S3.E14.m1.28.28.28.7.7.7.cmml">1</mn><mo id="S3.E14.m1.29.29.29.8.8.8" xref="S3.E14.m1.29.29.29.8.8.8.cmml">−</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1"><mi id="S3.E14.m1.30.30.30.9.9.9" xref="S3.E14.m1.30.30.30.9.9.9.cmml">D</mi><mo id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1.1.1"><mo stretchy="false" id="S3.E14.m1.31.31.31.10.10.10" xref="S3.E14.m1.40.40.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S3.E14.m1.32.32.32.11.11.11" xref="S3.E14.m1.32.32.32.11.11.11.cmml">G</mi><mo id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.40.40.1.1.1.cmml">⁢</mo><mrow id="S3.E14.m1.42.42.3.41.19.19.19.1.1.1.1.1.1.1.1.1.1.1.1.2"><mo stretchy="false" id="S3.E14.m1.33.33.33.12.12.12" xref="S3.E14.m1.40.40.1.1.1.cmml">(</mo><mi id="S3.E14.m1.34.34.34.13.13.13" xref="S3.E14.m1.34.34.34.13.13.13.cmml">𝐳</mi><mo stretchy="false" id="S3.E14.m1.35.35.35.14.14.14" xref="S3.E14.m1.40.40.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.36.36.36.15.15.15" xref="S3.E14.m1.40.40.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E14.m1.37.37.37.16.16.16" xref="S3.E14.m1.40.40.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E14.m1.38.38.38.17.17.17" xref="S3.E14.m1.40.40.1.1.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E14.m1.39.39.39.18.18.18" xref="S3.E14.m1.40.40.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E14.m1.42b"><apply id="S3.E14.m1.40.40.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><eq id="S3.E14.m1.11.11.11.11.11.11.cmml" xref="S3.E14.m1.11.11.11.11.11.11"></eq><apply id="S3.E14.m1.40.40.1.1.1.4.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.4.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><apply id="S3.E14.m1.40.40.1.1.1.4.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><apply id="S3.E14.m1.40.40.1.1.1.4.2.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="ambiguous" id="S3.E14.m1.40.40.1.1.1.4.2.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">subscript</csymbol><min id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1"></min><ci id="S3.E14.m1.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.2.2.2.2.2.2.1">𝐺</ci></apply><apply id="S3.E14.m1.40.40.1.1.1.4.2.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><apply id="S3.E14.m1.40.40.1.1.1.4.2.2.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="ambiguous" id="S3.E14.m1.40.40.1.1.1.4.2.2.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">subscript</csymbol><max id="S3.E14.m1.3.3.3.3.3.3.cmml" xref="S3.E14.m1.3.3.3.3.3.3"></max><ci id="S3.E14.m1.4.4.4.4.4.4.1.cmml" xref="S3.E14.m1.4.4.4.4.4.4.1">𝐷</ci></apply><ci id="S3.E14.m1.5.5.5.5.5.5.cmml" xref="S3.E14.m1.5.5.5.5.5.5">ℒ</ci></apply></apply><interval closure="open" id="S3.E14.m1.40.40.1.1.1.4.3.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><ci id="S3.E14.m1.7.7.7.7.7.7.cmml" xref="S3.E14.m1.7.7.7.7.7.7">𝐷</ci><ci id="S3.E14.m1.9.9.9.9.9.9.cmml" xref="S3.E14.m1.9.9.9.9.9.9">𝐺</ci></interval></apply><apply id="S3.E14.m1.40.40.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><plus id="S3.E14.m1.22.22.22.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></plus><apply id="S3.E14.m1.40.40.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><apply id="S3.E14.m1.40.40.1.1.1.1.1.3.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="ambiguous" id="S3.E14.m1.40.40.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">subscript</csymbol><ci id="S3.E14.m1.12.12.12.12.1.1.cmml" xref="S3.E14.m1.12.12.12.12.1.1">𝔼</ci><apply id="S3.E14.m1.13.13.13.13.2.2.1.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1"><csymbol cd="latexml" id="S3.E14.m1.13.13.13.13.2.2.1.1.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.1">similar-to</csymbol><apply id="S3.E14.m1.13.13.13.13.2.2.1.2.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.13.13.2.2.1.2.1.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.2">subscript</csymbol><ci id="S3.E14.m1.13.13.13.13.2.2.1.2.2.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.2.2">𝐻</ci><ci id="S3.E14.m1.13.13.13.13.2.2.1.2.3a.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.2.3"><mtext mathsize="50%" id="S3.E14.m1.13.13.13.13.2.2.1.2.3.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.2.3">real</mtext></ci></apply><apply id="S3.E14.m1.13.13.13.13.2.2.1.3.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.13.13.13.13.2.2.1.3.1.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.3">subscript</csymbol><ci id="S3.E14.m1.13.13.13.13.2.2.1.3.2.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.3.2">𝑝</ci><ci id="S3.E14.m1.13.13.13.13.2.2.1.3.3a.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.3.3"><mtext mathsize="50%" id="S3.E14.m1.13.13.13.13.2.2.1.3.3.cmml" xref="S3.E14.m1.13.13.13.13.2.2.1.3.3">data</mtext></ci></apply></apply></apply><apply id="S3.E14.m1.40.40.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="latexml" id="S3.E14.m1.40.40.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">delimited-[]</csymbol><apply id="S3.E14.m1.40.40.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><apply id="S3.E14.m1.40.40.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><log id="S3.E14.m1.15.15.15.15.4.4.cmml" xref="S3.E14.m1.15.15.15.15.4.4"></log><ci id="S3.E14.m1.16.16.16.16.5.5.cmml" xref="S3.E14.m1.16.16.16.16.5.5">𝐷</ci></apply><apply id="S3.E14.m1.40.40.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="ambiguous" id="S3.E14.m1.40.40.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">subscript</csymbol><ci id="S3.E14.m1.18.18.18.18.7.7.cmml" xref="S3.E14.m1.18.18.18.18.7.7">𝐻</ci><ci id="S3.E14.m1.19.19.19.19.8.8.1a.cmml" xref="S3.E14.m1.19.19.19.19.8.8.1"><mtext mathsize="70%" id="S3.E14.m1.19.19.19.19.8.8.1.cmml" xref="S3.E14.m1.19.19.19.19.8.8.1">real</mtext></ci></apply></apply></apply></apply><apply id="S3.E14.m1.40.40.1.1.1.2.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.2.2.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><apply id="S3.E14.m1.40.40.1.1.1.2.2.3.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="ambiguous" id="S3.E14.m1.40.40.1.1.1.2.2.3.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">subscript</csymbol><ci id="S3.E14.m1.23.23.23.2.2.2.cmml" xref="S3.E14.m1.23.23.23.2.2.2">𝔼</ci><apply id="S3.E14.m1.24.24.24.3.3.3.1.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1"><csymbol cd="latexml" id="S3.E14.m1.24.24.24.3.3.3.1.1.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.1">similar-to</csymbol><ci id="S3.E14.m1.24.24.24.3.3.3.1.2.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.2">𝐳</ci><apply id="S3.E14.m1.24.24.24.3.3.3.1.3.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.24.24.24.3.3.3.1.3.1.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.3">subscript</csymbol><ci id="S3.E14.m1.24.24.24.3.3.3.1.3.2.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.3.2">𝑝</ci><ci id="S3.E14.m1.24.24.24.3.3.3.1.3.3.cmml" xref="S3.E14.m1.24.24.24.3.3.3.1.3.3">𝑧</ci></apply></apply></apply><apply id="S3.E14.m1.40.40.1.1.1.2.2.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><csymbol cd="latexml" id="S3.E14.m1.40.40.1.1.1.2.2.1.2.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a">delimited-[]</csymbol><apply id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><log id="S3.E14.m1.26.26.26.5.5.5.cmml" xref="S3.E14.m1.26.26.26.5.5.5"></log><apply id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><minus id="S3.E14.m1.29.29.29.8.8.8.cmml" xref="S3.E14.m1.29.29.29.8.8.8"></minus><cn type="integer" id="S3.E14.m1.28.28.28.7.7.7.cmml" xref="S3.E14.m1.28.28.28.7.7.7">1</cn><apply id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><ci id="S3.E14.m1.30.30.30.9.9.9.cmml" xref="S3.E14.m1.30.30.30.9.9.9">𝐷</ci><apply id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"><times id="S3.E14.m1.40.40.1.1.1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.11.11.11.11.11.12.2a"></times><ci id="S3.E14.m1.32.32.32.11.11.11.cmml" xref="S3.E14.m1.32.32.32.11.11.11">𝐺</ci><ci id="S3.E14.m1.34.34.34.13.13.13.cmml" xref="S3.E14.m1.34.34.34.13.13.13">𝐳</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.42c">\begin{split}\min_{G}\max_{D}\mathcal{L}(D,G)=&amp;\ \mathbb{E}_{H_{\text{real}}%
                                                \sim p_{\text{data}}}[\log D(H_{\text{real}})]\\
                                                &amp;+\mathbb{E}_{\mathbf{z}\sim p_{z}}[\log(1-D(G(\mathbf{z})))].\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.42d">start_ROW start_CELL roman_min start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT caligraphic_L ( italic_D , italic_G ) = end_CELL start_CELL blackboard_E start_POSTSUBSCRIPT italic_H start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ∼ italic_p start_POSTSUBSCRIPT data end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_log italic_D ( italic_H start_POSTSUBSCRIPT real end_POSTSUBSCRIPT ) ] end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL + blackboard_E start_POSTSUBSCRIPT bold_z ∼ italic_p start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ roman_log ( 1 - italic_D ( italic_G ( bold_z ) ) ) ] . end_CELL end_ROW</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S3.SS2.SSS1.p3.1" class="ltx_p">where <math id="S3.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="p_{\text{data}}" display="inline"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3a.cmml">data</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑝</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">data</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">p_{\text{data}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_p start_POSTSUBSCRIPT data end_POSTSUBSCRIPT</annotation></semantics></math> is the true data distribution. After this phase, Decoder 0 generated heatmaps that appeared visually realistic but lacked meaningful alignment with drivable areas.</p>
                                </div>
                            </section>
                            <section id="S3.SS2.SSS2" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Encoder-Decoder Integration and Encoder Training</h4>

                                <div id="S3.SS2.SSS2.p1" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS2.p1.1" class="ltx_p">To enable task-specific prediction, the decoder was integrated with an encoder. The decoder parameters were frozen and the encoder was trained to output feature matrices that aligned with the input dimensions of the decoder.</p>
                                </div>
                                <div id="S3.SS2.SSS2.p2" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS2.p2.2" class="ltx_p">The encoder is tasked with mapping the input data, <math id="S3.SS2.SSS2.p2.1.m1.3" class="ltx_Math" alttext="(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic}},\mathbf{M})" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.3a"><mrow id="S3.SS2.SSS2.p2.1.m1.3.3.2" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.3.3.2.3" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml">(</mo><msub id="S3.SS2.SSS2.p2.1.m1.2.2.1.1" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.2.cmml">𝐓</mi><mtext id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3a.cmml">target</mtext></msub><mo id="S3.SS2.SSS2.p2.1.m1.3.3.2.4" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS2.SSS2.p2.1.m1.3.3.2.2" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.2" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.2.cmml">𝐓</mi><mtext id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3a.cmml">traffic</mtext></msub><mo id="S3.SS2.SSS2.p2.1.m1.3.3.2.5" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml">𝐌</mi><mo stretchy="false" id="S3.SS2.SSS2.p2.1.m1.3.3.2.6" xref="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.3b"><vector id="S3.SS2.SSS2.p2.1.m1.3.3.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2"><apply id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.2">𝐓</ci><ci id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3a.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.2.2.1.1.3">target</mtext></ci></apply><apply id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.2">𝐓</ci><ci id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3a.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3"><mtext mathsize="70%" id="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.3.3.2.2.3">traffic</mtext></ci></apply><ci id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">𝐌</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.3c">(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic}},\mathbf{M})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.1.m1.3d">( bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT , bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT , bold_M )</annotation></semantics></math>, which includes spatiotemporal context, into latent representations <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{Z}" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><mi id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml">𝐙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><ci id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">𝐙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">\mathbf{Z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.2.m2.1d">bold_Z</annotation></semantics></math> optimized for heatmap generation and to minimize the prediction loss indicated by equation&nbsp;(<a href="./pora_paper_demo_backup.html#S2.E12" title="In 2.3.2 Encoder Training with Fixed Decoder ‣ 2.3 Modular Training Approach ‣ 2 Methodology ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>):</p>
                                    <table id="S3.E15" class="ltx_equation ltx_eqn_table">

                                        <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.2" class="ltx_Math" alttext="\mathbf{Z}=f_{\theta_{e}}(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic%
}},\mathbf{M})," display="block"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.4" xref="S3.E15.m1.2.2.1.1.4.cmml">𝐙</mi><mo id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.cmml"><msub id="S3.E15.m1.2.2.1.1.2.4" xref="S3.E15.m1.2.2.1.1.2.4.cmml"><mi id="S3.E15.m1.2.2.1.1.2.4.2" xref="S3.E15.m1.2.2.1.1.2.4.2.cmml">f</mi><msub id="S3.E15.m1.2.2.1.1.2.4.3" xref="S3.E15.m1.2.2.1.1.2.4.3.cmml"><mi id="S3.E15.m1.2.2.1.1.2.4.3.2" xref="S3.E15.m1.2.2.1.1.2.4.3.2.cmml">θ</mi><mi id="S3.E15.m1.2.2.1.1.2.4.3.3" xref="S3.E15.m1.2.2.1.1.2.4.3.3.cmml">e</mi></msub></msub><mo id="S3.E15.m1.2.2.1.1.2.3" xref="S3.E15.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S3.E15.m1.2.2.1.1.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.2.2.2.3" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml">𝐓</mi><mtext id="S3.E15.m1.2.2.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3a.cmml">target</mtext></msub><mo id="S3.E15.m1.2.2.1.1.2.2.2.4" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E15.m1.2.2.1.1.2.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E15.m1.2.2.1.1.2.2.2.2.2" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2.cmml">𝐓</mi><mtext id="S3.E15.m1.2.2.1.1.2.2.2.2.3" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3a.cmml">traffic</mtext></msub><mo id="S3.E15.m1.2.2.1.1.2.2.2.5" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E15.m1.1.1" xref="S3.E15.m1.1.1.cmml">𝐌</mi><mo stretchy="false" id="S3.E15.m1.2.2.1.1.2.2.2.6" xref="S3.E15.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3"></eq><ci id="S3.E15.m1.2.2.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.4">𝐙</ci><apply id="S3.E15.m1.2.2.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2"><times id="S3.E15.m1.2.2.1.1.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.3"></times><apply id="S3.E15.m1.2.2.1.1.2.4.cmml" xref="S3.E15.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.4.1.cmml" xref="S3.E15.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.4.2.cmml" xref="S3.E15.m1.2.2.1.1.2.4.2">𝑓</ci><apply id="S3.E15.m1.2.2.1.1.2.4.3.cmml" xref="S3.E15.m1.2.2.1.1.2.4.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.4.3.1.cmml" xref="S3.E15.m1.2.2.1.1.2.4.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.4.3.2.cmml" xref="S3.E15.m1.2.2.1.1.2.4.3.2">𝜃</ci><ci id="S3.E15.m1.2.2.1.1.2.4.3.3.cmml" xref="S3.E15.m1.2.2.1.1.2.4.3.3">𝑒</ci></apply></apply><vector id="S3.E15.m1.2.2.1.1.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2"><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2">𝐓</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3">target</mtext></ci></apply><apply id="S3.E15.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.2">𝐓</ci><ci id="S3.E15.m1.2.2.1.1.2.2.2.2.3a.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S3.E15.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.2.2.2.2.3">traffic</mtext></ci></apply><ci id="S3.E15.m1.1.1.cmml" xref="S3.E15.m1.1.1">𝐌</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">\mathbf{Z}=f_{\theta_{e}}(\mathbf{T}_{\text{target}},\mathbf{T}_{\text{traffic%
                                                }},\mathbf{M}),</annotation><annotation encoding="application/x-llamapun" id="S3.E15.m1.2d">bold_Z = italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_T start_POSTSUBSCRIPT target end_POSTSUBSCRIPT , bold_T start_POSTSUBSCRIPT traffic end_POSTSUBSCRIPT , bold_M ) ,</annotation></semantics></math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
                                        </tr></tbody>
                                    </table>
                                    <p id="S3.SS2.SSS2.p2.4" class="ltx_p">where <math id="S3.SS2.SSS2.p2.3.m1.1" class="ltx_Math" alttext="f_{\theta_{e}}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m1.1a"><msub id="S3.SS2.SSS2.p2.3.m1.1.1" xref="S3.SS2.SSS2.p2.3.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.3.m1.1.1.2" xref="S3.SS2.SSS2.p2.3.m1.1.1.2.cmml">f</mi><msub id="S3.SS2.SSS2.p2.3.m1.1.1.3" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.3.m1.1.1.3.2" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.2.cmml">θ</mi><mi id="S3.SS2.SSS2.p2.3.m1.1.1.3.3" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.3.cmml">e</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m1.1b"><apply id="S3.SS2.SSS2.p2.3.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.2">𝑓</ci><apply id="S3.SS2.SSS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.2">𝜃</ci><ci id="S3.SS2.SSS2.p2.3.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m1.1c">f_{\theta_{e}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.3.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> represents the encoder with parameters <math id="S3.SS2.SSS2.p2.4.m2.1" class="ltx_Math" alttext="\theta_{e}" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m2.1a"><msub id="S3.SS2.SSS2.p2.4.m2.1.1" xref="S3.SS2.SSS2.p2.4.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m2.1.1.2" xref="S3.SS2.SSS2.p2.4.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.SSS2.p2.4.m2.1.1.3" xref="S3.SS2.SSS2.p2.4.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m2.1b"><apply id="S3.SS2.SSS2.p2.4.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.2">𝜃</ci><ci id="S3.SS2.SSS2.p2.4.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m2.1c">\theta_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p2.4.m2.1d">italic_θ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                </div>
                                <div id="S3.SS2.SSS2.p3" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS2.p3.1" class="ltx_p">Two encoder variants were trained:</p>
                                    <ul id="S3.I3" class="ltx_itemize">
                                        <li id="S3.I3.i1" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I3.i1.p1" class="ltx_para">
                                                <p id="S3.I3.i1.p1.1" class="ltx_p"><span id="S3.I3.i1.p1.1.1" class="ltx_text ltx_font_bold">Encoder 0:</span> Trained exclusively on Argoverse data.</p>
                                            </div>
                                        </li>
                                        <li id="S3.I3.i2" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I3.i2.p1" class="ltx_para ltx_noindent">
                                                <p id="S3.I3.i2.p1.1" class="ltx_p"><span id="S3.I3.i2.p1.1.1" class="ltx_text ltx_font_bold">Encoder 1:</span> Trained on both Argoverse and SUMO data to generalize across diverse scenarios.</p>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </section>
                            <section id="S3.SS2.SSS3" class="ltx_subsubsection">
                                <h4 class="ltx_title ltx_title_subsubsection">
                                    <span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Decoder Fine-Tuning</h4>

                                <div id="S3.SS2.SSS3.p1" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS3.p1.1" class="ltx_p">To address non-drivable area predictions, we fine-tuned the decoder with additional constraints:</p>
                                    <ul id="S3.I4" class="ltx_itemize">
                                        <li id="S3.I4.i1" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I4.i1.p1" class="ltx_para">
                                                <p id="S3.I4.i1.p1.1" class="ltx_p"><span id="S3.I4.i1.p1.1.1" class="ltx_text ltx_font_bold">Filtered Dataset (<math id="S3.I4.i1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\text{filtered}}" display="inline"><semantics id="S3.I4.i1.p1.1.1.m1.1a"><msub id="S3.I4.i1.p1.1.1.m1.1.1" xref="S3.I4.i1.p1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I4.i1.p1.1.1.m1.1.1.2" xref="S3.I4.i1.p1.1.1.m1.1.1.2.cmml">𝒟</mi><mtext class="ltx_mathvariant_bold" id="S3.I4.i1.p1.1.1.m1.1.1.3" xref="S3.I4.i1.p1.1.1.m1.1.1.3a.cmml">filtered</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I4.i1.p1.1.1.m1.1b"><apply id="S3.I4.i1.p1.1.1.m1.1.1.cmml" xref="S3.I4.i1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I4.i1.p1.1.1.m1.1.1.1.cmml" xref="S3.I4.i1.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.I4.i1.p1.1.1.m1.1.1.2.cmml" xref="S3.I4.i1.p1.1.1.m1.1.1.2">𝒟</ci><ci id="S3.I4.i1.p1.1.1.m1.1.1.3a.cmml" xref="S3.I4.i1.p1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.I4.i1.p1.1.1.m1.1.1.3.cmml" xref="S3.I4.i1.p1.1.1.m1.1.1.3">filtered</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i1.p1.1.1.m1.1c">\mathcal{D}_{\text{filtered}}</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i1.p1.1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT filtered end_POSTSUBSCRIPT</annotation></semantics></math>):</span> Samples that use pedestrian or bike as the target agent were excluded, ensuring that the training data focused solely on drivable regions.</p>
                                            </div>
                                        </li>
                                        <li id="S3.I4.i2" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I4.i2.p1" class="ltx_para ltx_noindent">
                                                <p id="S3.I4.i2.p1.3" class="ltx_p"><span id="S3.I4.i2.p1.3.1" class="ltx_text ltx_font_bold">Drivable Area Penalty:</span> A penalty term was added to the loss function:</p>
                                                <table id="S3.E16" class="ltx_equation ltx_eqn_table">

                                                    <tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                                        <td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.5" class="ltx_Math" alttext="\mathcal{L}_{\text{penalty}}=\lambda\sum_{(i,j)\notin\text{Drivable}}H_{t_{k}}%
(i,j)," display="block"><semantics id="S3.E16.m1.5a"><mrow id="S3.E16.m1.5.5.1" xref="S3.E16.m1.5.5.1.1.cmml"><mrow id="S3.E16.m1.5.5.1.1" xref="S3.E16.m1.5.5.1.1.cmml"><msub id="S3.E16.m1.5.5.1.1.2" xref="S3.E16.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m1.5.5.1.1.2.2" xref="S3.E16.m1.5.5.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E16.m1.5.5.1.1.2.3" xref="S3.E16.m1.5.5.1.1.2.3a.cmml">penalty</mtext></msub><mo id="S3.E16.m1.5.5.1.1.1" xref="S3.E16.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E16.m1.5.5.1.1.3" xref="S3.E16.m1.5.5.1.1.3.cmml"><mi id="S3.E16.m1.5.5.1.1.3.2" xref="S3.E16.m1.5.5.1.1.3.2.cmml">λ</mi><mo id="S3.E16.m1.5.5.1.1.3.1" xref="S3.E16.m1.5.5.1.1.3.1.cmml">⁢</mo><mrow id="S3.E16.m1.5.5.1.1.3.3" xref="S3.E16.m1.5.5.1.1.3.3.cmml"><munder id="S3.E16.m1.5.5.1.1.3.3.1" xref="S3.E16.m1.5.5.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E16.m1.5.5.1.1.3.3.1.2" xref="S3.E16.m1.5.5.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.E16.m1.2.2.2" xref="S3.E16.m1.2.2.2.cmml"><mrow id="S3.E16.m1.2.2.2.4.2" xref="S3.E16.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E16.m1.2.2.2.4.2.1" xref="S3.E16.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E16.m1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.cmml">i</mi><mo id="S3.E16.m1.2.2.2.4.2.2" xref="S3.E16.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E16.m1.2.2.2.2" xref="S3.E16.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E16.m1.2.2.2.4.2.3" xref="S3.E16.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E16.m1.2.2.2.3" xref="S3.E16.m1.2.2.2.3.cmml">∉</mo><mtext id="S3.E16.m1.2.2.2.5" xref="S3.E16.m1.2.2.2.5a.cmml">Drivable</mtext></mrow></munder><mrow id="S3.E16.m1.5.5.1.1.3.3.2" xref="S3.E16.m1.5.5.1.1.3.3.2.cmml"><msub id="S3.E16.m1.5.5.1.1.3.3.2.2" xref="S3.E16.m1.5.5.1.1.3.3.2.2.cmml"><mi id="S3.E16.m1.5.5.1.1.3.3.2.2.2" xref="S3.E16.m1.5.5.1.1.3.3.2.2.2.cmml">H</mi><msub id="S3.E16.m1.5.5.1.1.3.3.2.2.3" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3.cmml"><mi id="S3.E16.m1.5.5.1.1.3.3.2.2.3.2" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3.2.cmml">t</mi><mi id="S3.E16.m1.5.5.1.1.3.3.2.2.3.3" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3.3.cmml">k</mi></msub></msub><mo id="S3.E16.m1.5.5.1.1.3.3.2.1" xref="S3.E16.m1.5.5.1.1.3.3.2.1.cmml">⁢</mo><mrow id="S3.E16.m1.5.5.1.1.3.3.2.3.2" xref="S3.E16.m1.5.5.1.1.3.3.2.3.1.cmml"><mo stretchy="false" id="S3.E16.m1.5.5.1.1.3.3.2.3.2.1" xref="S3.E16.m1.5.5.1.1.3.3.2.3.1.cmml">(</mo><mi id="S3.E16.m1.3.3" xref="S3.E16.m1.3.3.cmml">i</mi><mo id="S3.E16.m1.5.5.1.1.3.3.2.3.2.2" xref="S3.E16.m1.5.5.1.1.3.3.2.3.1.cmml">,</mo><mi id="S3.E16.m1.4.4" xref="S3.E16.m1.4.4.cmml">j</mi><mo stretchy="false" id="S3.E16.m1.5.5.1.1.3.3.2.3.2.3" xref="S3.E16.m1.5.5.1.1.3.3.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E16.m1.5.5.1.2" xref="S3.E16.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.5b"><apply id="S3.E16.m1.5.5.1.1.cmml" xref="S3.E16.m1.5.5.1"><eq id="S3.E16.m1.5.5.1.1.1.cmml" xref="S3.E16.m1.5.5.1.1.1"></eq><apply id="S3.E16.m1.5.5.1.1.2.cmml" xref="S3.E16.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.2.1.cmml" xref="S3.E16.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E16.m1.5.5.1.1.2.2.cmml" xref="S3.E16.m1.5.5.1.1.2.2">ℒ</ci><ci id="S3.E16.m1.5.5.1.1.2.3a.cmml" xref="S3.E16.m1.5.5.1.1.2.3"><mtext mathsize="70%" id="S3.E16.m1.5.5.1.1.2.3.cmml" xref="S3.E16.m1.5.5.1.1.2.3">penalty</mtext></ci></apply><apply id="S3.E16.m1.5.5.1.1.3.cmml" xref="S3.E16.m1.5.5.1.1.3"><times id="S3.E16.m1.5.5.1.1.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3.1"></times><ci id="S3.E16.m1.5.5.1.1.3.2.cmml" xref="S3.E16.m1.5.5.1.1.3.2">𝜆</ci><apply id="S3.E16.m1.5.5.1.1.3.3.cmml" xref="S3.E16.m1.5.5.1.1.3.3"><apply id="S3.E16.m1.5.5.1.1.3.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.3.3.1.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.1">subscript</csymbol><sum id="S3.E16.m1.5.5.1.1.3.3.1.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.1.2"></sum><apply id="S3.E16.m1.2.2.2.cmml" xref="S3.E16.m1.2.2.2"><notin id="S3.E16.m1.2.2.2.3.cmml" xref="S3.E16.m1.2.2.2.3"></notin><interval closure="open" id="S3.E16.m1.2.2.2.4.1.cmml" xref="S3.E16.m1.2.2.2.4.2"><ci id="S3.E16.m1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1">𝑖</ci><ci id="S3.E16.m1.2.2.2.2.cmml" xref="S3.E16.m1.2.2.2.2">𝑗</ci></interval><ci id="S3.E16.m1.2.2.2.5a.cmml" xref="S3.E16.m1.2.2.2.5"><mtext mathsize="70%" id="S3.E16.m1.2.2.2.5.cmml" xref="S3.E16.m1.2.2.2.5">Drivable</mtext></ci></apply></apply><apply id="S3.E16.m1.5.5.1.1.3.3.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2"><times id="S3.E16.m1.5.5.1.1.3.3.2.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.1"></times><apply id="S3.E16.m1.5.5.1.1.3.3.2.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.3.3.2.2.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E16.m1.5.5.1.1.3.3.2.2.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2.2">𝐻</ci><apply id="S3.E16.m1.5.5.1.1.3.3.2.2.3.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.5.5.1.1.3.3.2.2.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3">subscript</csymbol><ci id="S3.E16.m1.5.5.1.1.3.3.2.2.3.2.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3.2">𝑡</ci><ci id="S3.E16.m1.5.5.1.1.3.3.2.2.3.3.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.2.3.3">𝑘</ci></apply></apply><interval closure="open" id="S3.E16.m1.5.5.1.1.3.3.2.3.1.cmml" xref="S3.E16.m1.5.5.1.1.3.3.2.3.2"><ci id="S3.E16.m1.3.3.cmml" xref="S3.E16.m1.3.3">𝑖</ci><ci id="S3.E16.m1.4.4.cmml" xref="S3.E16.m1.4.4">𝑗</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.5c">\mathcal{L}_{\text{penalty}}=\lambda\sum_{(i,j)\notin\text{Drivable}}H_{t_{k}}%
                                                            (i,j),</annotation><annotation encoding="application/x-llamapun" id="S3.E16.m1.5d">caligraphic_L start_POSTSUBSCRIPT penalty end_POSTSUBSCRIPT = italic_λ ∑ start_POSTSUBSCRIPT ( italic_i , italic_j ) ∉ Drivable end_POSTSUBSCRIPT italic_H start_POSTSUBSCRIPT italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_i , italic_j ) ,</annotation></semantics></math></td>
                                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                                        <td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
                                                    </tr></tbody>
                                                </table>
                                                <p id="S3.I4.i2.p1.2" class="ltx_p">where <math id="S3.I4.i2.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.I4.i2.p1.1.m1.1a"><mi id="S3.I4.i2.p1.1.m1.1.1" xref="S3.I4.i2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.I4.i2.p1.1.m1.1b"><ci id="S3.I4.i2.p1.1.m1.1.1.cmml" xref="S3.I4.i2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i2.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i2.p1.1.m1.1d">italic_λ</annotation></semantics></math> is a penalty weight, and <math id="S3.I4.i2.p1.2.m2.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.I4.i2.p1.2.m2.2a"><mrow id="S3.I4.i2.p1.2.m2.2.3.2" xref="S3.I4.i2.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.I4.i2.p1.2.m2.2.3.2.1" xref="S3.I4.i2.p1.2.m2.2.3.1.cmml">(</mo><mi id="S3.I4.i2.p1.2.m2.1.1" xref="S3.I4.i2.p1.2.m2.1.1.cmml">i</mi><mo id="S3.I4.i2.p1.2.m2.2.3.2.2" xref="S3.I4.i2.p1.2.m2.2.3.1.cmml">,</mo><mi id="S3.I4.i2.p1.2.m2.2.2" xref="S3.I4.i2.p1.2.m2.2.2.cmml">j</mi><mo stretchy="false" id="S3.I4.i2.p1.2.m2.2.3.2.3" xref="S3.I4.i2.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I4.i2.p1.2.m2.2b"><interval closure="open" id="S3.I4.i2.p1.2.m2.2.3.1.cmml" xref="S3.I4.i2.p1.2.m2.2.3.2"><ci id="S3.I4.i2.p1.2.m2.1.1.cmml" xref="S3.I4.i2.p1.2.m2.1.1">𝑖</ci><ci id="S3.I4.i2.p1.2.m2.2.2.cmml" xref="S3.I4.i2.p1.2.m2.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.I4.i2.p1.2.m2.2c">(i,j)</annotation><annotation encoding="application/x-llamapun" id="S3.I4.i2.p1.2.m2.2d">( italic_i , italic_j )</annotation></semantics></math> indexes grid cells outside the drivable area.</p>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div id="S3.SS2.SSS3.p2" class="ltx_para ltx_noindent">
                                    <p id="S3.SS2.SSS3.p2.1" class="ltx_p">Two fine-tuned decoder variants were created:</p>
                                    <ul id="S3.I5" class="ltx_itemize">
                                        <li id="S3.I5.i1" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I5.i1.p1" class="ltx_para">
                                                <p id="S3.I5.i1.p1.1" class="ltx_p"><span id="S3.I5.i1.p1.1.1" class="ltx_text ltx_font_bold">Decoder 1:</span> Trained with <math id="S3.I5.i1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\text{filtered}}" display="inline"><semantics id="S3.I5.i1.p1.1.m1.1a"><msub id="S3.I5.i1.p1.1.m1.1.1" xref="S3.I5.i1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I5.i1.p1.1.m1.1.1.2" xref="S3.I5.i1.p1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S3.I5.i1.p1.1.m1.1.1.3" xref="S3.I5.i1.p1.1.m1.1.1.3a.cmml">filtered</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I5.i1.p1.1.m1.1b"><apply id="S3.I5.i1.p1.1.m1.1.1.cmml" xref="S3.I5.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I5.i1.p1.1.m1.1.1.1.cmml" xref="S3.I5.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I5.i1.p1.1.m1.1.1.2.cmml" xref="S3.I5.i1.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.I5.i1.p1.1.m1.1.1.3a.cmml" xref="S3.I5.i1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.I5.i1.p1.1.m1.1.1.3.cmml" xref="S3.I5.i1.p1.1.m1.1.1.3">filtered</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I5.i1.p1.1.m1.1c">\mathcal{D}_{\text{filtered}}</annotation><annotation encoding="application/x-llamapun" id="S3.I5.i1.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT filtered end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                            </div>
                                        </li>
                                        <li id="S3.I5.i2" class="ltx_item" style="list-style-type:none;">
                                            <span class="ltx_tag ltx_tag_item">•</span>
                                            <div id="S3.I5.i2.p1" class="ltx_para ltx_noindent">
                                                <p id="S3.I5.i2.p1.2" class="ltx_p"><span id="S3.I5.i2.p1.2.1" class="ltx_text ltx_font_bold">Decoder 2:</span> Trained with <math id="S3.I5.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\text{filtered}}" display="inline"><semantics id="S3.I5.i2.p1.1.m1.1a"><msub id="S3.I5.i2.p1.1.m1.1.1" xref="S3.I5.i2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I5.i2.p1.1.m1.1.1.2" xref="S3.I5.i2.p1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S3.I5.i2.p1.1.m1.1.1.3" xref="S3.I5.i2.p1.1.m1.1.1.3a.cmml">filtered</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I5.i2.p1.1.m1.1b"><apply id="S3.I5.i2.p1.1.m1.1.1.cmml" xref="S3.I5.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I5.i2.p1.1.m1.1.1.1.cmml" xref="S3.I5.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I5.i2.p1.1.m1.1.1.2.cmml" xref="S3.I5.i2.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.I5.i2.p1.1.m1.1.1.3a.cmml" xref="S3.I5.i2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.I5.i2.p1.1.m1.1.1.3.cmml" xref="S3.I5.i2.p1.1.m1.1.1.3">filtered</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I5.i2.p1.1.m1.1c">\mathcal{D}_{\text{filtered}}</annotation><annotation encoding="application/x-llamapun" id="S3.I5.i2.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT filtered end_POSTSUBSCRIPT</annotation></semantics></math> and <math id="S3.I5.i2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\text{penalty}}" display="inline"><semantics id="S3.I5.i2.p1.2.m2.1a"><msub id="S3.I5.i2.p1.2.m2.1.1" xref="S3.I5.i2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.I5.i2.p1.2.m2.1.1.2" xref="S3.I5.i2.p1.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.I5.i2.p1.2.m2.1.1.3" xref="S3.I5.i2.p1.2.m2.1.1.3a.cmml">penalty</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I5.i2.p1.2.m2.1b"><apply id="S3.I5.i2.p1.2.m2.1.1.cmml" xref="S3.I5.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I5.i2.p1.2.m2.1.1.1.cmml" xref="S3.I5.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I5.i2.p1.2.m2.1.1.2.cmml" xref="S3.I5.i2.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.I5.i2.p1.2.m2.1.1.3a.cmml" xref="S3.I5.i2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S3.I5.i2.p1.2.m2.1.1.3.cmml" xref="S3.I5.i2.p1.2.m2.1.1.3">penalty</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I5.i2.p1.2.m2.1c">\mathcal{L}_{\text{penalty}}</annotation><annotation encoding="application/x-llamapun" id="S3.I5.i2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT penalty end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <figure id="S3.F6" class="ltx_figure">
                                    <div class="ltx_flex_figure">
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0.png" id="S3.F6.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                                    <br class="ltx_break">(4.7902%)</figcaption>
                                            </figure>
                                        </div>
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1.png" id="S3.F6.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                                    <br class="ltx_break">(0.2163%)</figcaption>
                                            </figure>
                                        </div>
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2.png" id="S3.F6.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                                    <br class="ltx_break">(0.0247%)</figcaption>
                                            </figure>
                                        </div>
                                        <div class="ltx_flex_break"></div>
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0.png" id="S3.F6.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                                    <br class="ltx_break">(5.1839%)</figcaption>
                                            </figure>
                                        </div>
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1.png" id="S3.F6.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                                    <br class="ltx_break">(0.5471%)</figcaption>
                                            </figure>
                                        </div>
                                        <div class="ltx_flex_cell ltx_flex_size_3">
                                            <figure id="S3.F6.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2.png" id="S3.F6.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                                <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                                    <br class="ltx_break">(0.0658%)</figcaption>
                                            </figure>
                                        </div>
                                    </div>
                                    <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S3.F6.2.1" class="ltx_text ltx_font_bold">Comparison of Heatmaps Generated by Various Encoder-Decoder Configurations.</span> The figure illustrates occupancy heatmaps produced by combinations of different encoder and decoder configurations, wherein The percentage in brackets represents the proportion of total values of cells outside the drivable area. Figures (a) and (d) represent the outputs from Decoder 0 before fine-tuning, paired with Encoder&nbsp;0 and Encoder&nbsp;1, respectively. The second column, figures (b) and (e), shows the results after fine-tuning using Decoder&nbsp;1, which was trained on a filtered dataset excluding non-drivable areas. The third column, figures (c) and (f), presents the outputs after fine-tuning with Decoder&nbsp;2, which incorporated both filtered data and a drivable area penalty. Progressive improvements are observed across columns, with configurations involving Decoder&nbsp;2 (figures c and f) exhibiting the most accurate spatial alignment and confinement of probabilities within drivable regions. These results emphasize the significance of fine-tuning in enhancing the realism and practical applicability of the generated heatmaps for autonomous vehicle systems.</figcaption>
                                </figure>
                            </section>
                        </section>
                        <section id="S3.SS3" class="ltx_subsection">
                            <h3 class="ltx_title ltx_title_subsection">
                                <span class="ltx_tag ltx_tag_subsection">3.3 </span><span class="highlight" data-comment="comment5">Comparative Analysis of Heatmap Predictions</span></h3>

                            <div id="S3.SS3.p1" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p1.1" class="ltx_p">To validate the advantages of the proposed modular training approach, we compare it against a benchmark framework trained end-to-end without pretraining or fine-tuning. This benchmark shares the same architecture as Encoder&nbsp;0 and Decoder&nbsp;0 but does not leverage the modular design, pretraining or finetuning.</p>
                            </div>
                            <div id="S3.SS3.p2" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p2.1" class="ltx_p">Figure&nbsp;<a href="./pora_paper_demo_backup.html#S3.F7" title="Figure 7 ‣ 3.3 Comparative Analysis of Heatmap Predictions ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates two training curves: the benchmark model and the modular framework. For a fair comparison, the training curve of the modular framework accounts for the decoder pretraining time by shifting its starting point on the time axis by an offset equivalent to the pretraining duration. This adjustment reflects the cumulative effort required for modular training.</p>
                            </div>
                            <div id="S3.SS3.p3" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p3.1" class="ltx_p"><span class="highlight" data-comment="comment4">The benchmark model demonstrates significantly slower convergence, requiring over 170% wall time on average to reach comparable validation loss levels achieved by the modular framework, including pretraining time. Additionally, the benchmark model exhibits high instability, failing to converge in 39% of experiments.</span> This instability arises from the lack of modular pretraining, which hinders the ability to adapt efficiently to the task-specific prediction requirements.</p>
                            </div>
                            <figure id="S3.F7" class="ltx_figure"><img src="./pora_paper_demo_files/hm_learning_curve.png" id="S3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="223" alt="Refer to caption">
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Comparison of Learning Curves for Modular and End-to-End Training Approaches: The green-shaded region highlights the decoder pretraining phase for the modular framework, after which its training curve shifts to the right by the pretraining duration. The modularized approach exhibits faster convergence, lower variance, and greater stability compared to the end-to-end method, which suffers from slower convergence and higher instability. </figcaption>
                            </figure>
                            <div id="S3.SS3.p4" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p4.1" class="ltx_p">Figure&nbsp;<a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> provides a comparative visualization of occupancy heatmaps generated by different encoder-decoder configurations, with a focus on the spatial accuracy and alignment of predicted probabilities with drivable areas. The figure demonstrates the progressive improvements achieved through the fine-tuning of the decoder.</p>
                            </div>
                            <div id="S3.SS3.p5" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p5.1" class="ltx_p">Figures&nbsp;<a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(a) and <a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(d) illustrate the outputs from Encoder&nbsp;0 and Encoder&nbsp;1 paired with Decoder&nbsp;0, respectively, before any fine-tuning. Despite producing visually realistic heatmaps, these configurations exhibit significant probabilities in non-drivable regions, with 4.79% of total occupancy values lying outside drivable areas for Encoder&nbsp;0 + Decoder&nbsp;0 and 5.18% for Encoder&nbsp;1 + Decoder&nbsp;0. These results highlight a critical limitation of the initial decoder: its inability to confine occupancy predictions to spatially relevant regions, undermining its practical utility.</p>
                            </div>
                            <div id="S3.SS3.p6" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p6.1" class="ltx_p">The second column, represented by figures <a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(b) and <a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(e), shows the results after fine-tuning the decoder using a filtered dataset to create Decoder&nbsp;1. This refinement excluded the non-vehicle samples moving on pedestrian and bicycle lanes from the fine-tuning process. Consequently, both configurations exhibit a marked reduction in non-drivable area probabilities. Specifically, Encoder&nbsp;0 + Decoder&nbsp;1 reduces this proportion to 0.22%, while Encoder&nbsp;1 + Decoder&nbsp;1 achieves 0.55%. Although the predictions are still imperfect, the substantial improvement indicates the effectiveness of data filtering in enhancing spatial alignment.</p>
                            </div>
                            <div id="S3.SS3.p7" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p7.1" class="ltx_p">The third column, figures <a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(c) and <a href="./pora_paper_demo_backup.html#S3.F6" title="Figure 6 ‣ 3.2.3 Decoder Fine-Tuning ‣ 3.2 Training Procedure ‣ 3 Experiments and Results ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(f), presents the results from configurations using Decoder&nbsp;2, which was fine-tuned with both the filtered dataset and a drivable area penalty term incorporated into the loss function. This penalty explicitly discourages high occupancy probabilities outside drivable areas, leading to a further refinement of predictions. Encoder&nbsp;0 + Decoder&nbsp;2 reduces the proportion of non-drivable predictions to 0.025%, while Encoder&nbsp;1 + Decoder&nbsp;2 achieves 0.066%. These configurations exhibit the most accurate spatial alignment, with predictions closely confined to drivable areas.</p>
                            </div>
                            <div id="S3.SS3.p8" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p8.1" class="ltx_p">The analysis reveals two key findings:
                                    1.&nbsp;Fine-tuning the decoder with a filtered dataset and penalty constraints significantly improves the spatial accuracy of occupancy heatmaps, reducing erroneous predictions in non-drivable regions.
                                    2.&nbsp;Encoder&nbsp;1, trained on a combination of Argoverse and SUMO data, consistently outperforms Encoder 0 in all configurations, demonstrating its generalizability to diverse traffic scenarios.</p>
                            </div>
                            <div id="S3.SS3.p9" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p9.1" class="ltx_p">The combination of Encoder&nbsp;1 and Decoder&nbsp;2 emerges as the optimal configuration, achieving the highest fidelity in spatial alignment and practical applicability. These results underscore the importance of modular fine-tuning and tailored loss functions in enhancing the performance of probabilistic occupancy prediction frameworks for autonomous vehicles.</p>
                            </div>
                            <div id="S3.SS3.p10" class="ltx_para ltx_noindent">
                                <p id="S3.SS3.p10.1" class="ltx_p">Figures <a href="./pora_paper_demo_backup.html#Sx1.F8" title="Figure 8 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, <a href="./pora_paper_demo_backup.html#Sx1.F9" title="Figure 9 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, <a href="./pora_paper_demo_backup.html#Sx1.F10" title="Figure 10 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, <a href="./pora_paper_demo_backup.html#Sx1.F11" title="Figure 11 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, <a href="./pora_paper_demo_backup.html#Sx1.F12" title="Figure 12 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>, <a href="./pora_paper_demo_backup.html#Sx1.F13" title="Figure 13 ‣ Acknowledgment ‣ Modular Framework for Uncertainty Prediction in Autonomous Vehicle Motion Forecasting within Complex Traffic Scenarios" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> provided in the <span id="S3.SS3.p10.1.1" class="ltx_text ltx_font_bold">Appendix</span>, illustrate the detailed comparisons between various encoder-decoder configurations. Each figure represents a distinct traffic scenario, such as non-traditional intersections, left turns, and lane-changing maneuvers, to evaluate the spatial alignment and prediction accuracy of the proposed framework. The comparisons highlight the progression of improvements achieved through fine-tuning decoder components and demonstrate the robustness in confining occupancy predictions to drivable regions. Notably, the fine-tuned configurations consistently exhibit lower probabilities of non-drivable area predictions across diverse scenarios, underscoring the efficacy of the proposed modular training approach.</p>
                            </div>
                        </section>
                    </section>
                    <section id="S4" class="ltx_section">
                        <h2 class="ltx_title ltx_title_section">
                            <span class="ltx_tag ltx_tag_section">4 </span><span class="highlight" data-comment="comment7">Discussion</span></h2>

                        <div id="S4.p1" class="ltx_para ltx_noindent">
                            <p id="S4.p1.1" class="ltx_p">This paper presents a modular framework for uncertainty-aware trajectory prediction in autonomous vehicles, addressing key challenges in ensuring safety and operational efficiency in dynamic traffic environments.</p>
                        </div>
                        <div id="S4.p2" class="ltx_para ltx_noindent">
                            <p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Modular Architecture and Benefits</span></p>
                        </div>
                        <div id="S4.p3" class="ltx_para ltx_noindent">
                            <p id="S4.p3.1" class="ltx_p">The proposed modular architecture decouples encoder and decoder training, enabling flexibility to adapt to different traffic scenarios. Environment- or traffic participant-specific decoders, such as those for pedestrians, bicyclists, and vehicles, or for use in highway versus urban driving, can be trained independently, avoiding the inefficiency of retraining entire models. This design also supports integration of additional data, like high-definition maps, enhancing adaptability. This also enables new data, characterizing new AV operating location or weather environments for example, to be quickly and efficiently incorporated as that data is collected.</p>
                        </div>
                        <div id="S4.p4" class="ltx_para ltx_noindent">
                            <p id="S4.p4.1" class="ltx_p"><span id="S4.p4.1.1" class="ltx_text ltx_font_bold">Heatmap Representation and Safety</span></p>
                        </div>
                        <div id="S4.p5" class="ltx_para ltx_noindent">
                            <p id="S4.p5.1" class="ltx_p">Heatmaps provide probabilistic views of future vehicle positions, capturing uncertainties and enabling robust safety-critical decisions. They help autonomous vehicles anticipate collisions and high-risk scenarios by allowing AVs to efficiently detect those vehicle interactions without requiring extensive sampling of a large number of trajectories. This is especially significant when trying to anticipate potential collisions arising from low-probability vehicle trajectories. The improved awareness of potential risks ensures improved predictions with actionable decisions like lane changes and obstacle avoidance.</p>
                        </div>
                        <div id="S4.p6" class="ltx_para ltx_noindent">
                            <p id="S4.p6.1" class="ltx_p">While the proposed modular framework demonstrates advancements in uncertainty-aware trajectory prediction, several avenues for future work remain. First, integrating richer contextual information, such as high-definition maps and dynamic environmental data, could further enhance prediction accuracy and adaptability. Additionally, exploring alternative training strategies, such as reinforcement learning, may improve the robustness of the model in highly interactive traffic scenarios. Future efforts will also focus on extending the framework to multi-agent prediction tasks, capturing complex interactions among vehicles and vulnerable road users. Finally, real-world deployment and validation in diverse environments will be critical to ensuring the scalability and reliability of the proposed approach in practical autonomous driving systems.</p>
                        </div>
                    </section>
                    <section id="Sx1" class="ltx_section">
                        <h2 class="ltx_title ltx_title_section">Acknowledgment</h2>

                        <div id="Sx1.p1" class="ltx_para ltx_noindent">
                            <p id="Sx1.p1.1" class="ltx_p">This work is a part of the Berkeley DeepDrive Project “Collision Indeterminacy Prediction via Stochastic Trajectory Generation."</p>
                        </div>
                        <figure id="Sx1.F8" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(1).png" id="Sx1.F8.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(8.1347%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(1).png" id="Sx1.F8.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(0.7832%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(1).png" id="Sx1.F8.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(0.0521%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(1).png" id="Sx1.F8.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(6.4893%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(1).png" id="Sx1.F8.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(0.0972%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F8.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(1).png" id="Sx1.F8.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(0.0614%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Comparison of heatmaps generated by various encoder-decoder configurations at a non-traditional intersection. This scenario demonstrates the model’s ability to predict occupancy with minimal probabilities outside drivable regions.</figcaption>
                        </figure>
                        <figure id="Sx1.F9" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(2).png" id="Sx1.F9.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(6.4823%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(2).png" id="Sx1.F9.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(0.7431%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(2).png" id="Sx1.F9.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(0.0324%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(2).png" id="Sx1.F9.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(3.9147%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(2).png" id="Sx1.F9.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(0.0135%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F9.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(2).png" id="Sx1.F9.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(0.0028%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Comparison of heatmaps generated by various encoder-decoder configurations in a left-turning scenario. This scenario evaluates the model’s ability to handle complex maneuvers and maintain spatial alignment.</figcaption>
                        </figure>
                        <figure id="Sx1.F10" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(3).png" id="Sx1.F10.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(7.3241%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(3).png" id="Sx1.F10.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(2.1254%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(3).png" id="Sx1.F10.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(0.0748%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(3).png" id="Sx1.F10.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(7.0146%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(3).png" id="Sx1.F10.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(0.6487%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F10.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(3).png" id="Sx1.F10.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(0.0352%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Comparison of heatmaps generated by various encoder-decoder configurations at an intersection, focusing on the awareness of a leading vehicle in the middle. This scenario evaluates the models’ ability to accurately localize the leading vehicle while minimizing false predictions in the surroundings. </figcaption>
                        </figure>
                        <figure id="Sx1.F11" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(4).png" id="Sx1.F11.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(1.8354%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(4).png" id="Sx1.F11.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(1.4247%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(4).png" id="Sx1.F11.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(0.0645%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(4).png" id="Sx1.F11.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(2.1428%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(4).png" id="Sx1.F11.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(1.2153%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F11.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(4).png" id="Sx1.F11.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(0.0457%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Comparison of heatmaps generated by various encoder-decoder configurations for lane-changing planning, focusing on awareness of the leading vehicle on the target lane. This scenario highlights the model’s ability to predict future positions accurately during a lane-change maneuver.</figcaption>
                        </figure>
                        <figure id="Sx1.F12" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(5).png" id="Sx1.F12.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(6.8312%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(5).png" id="Sx1.F12.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(2.6435%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(5).png" id="Sx1.F12.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(0.6234%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(5).png" id="Sx1.F12.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(4.2146%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(5).png" id="Sx1.F12.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(2.9847%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F12.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(5).png" id="Sx1.F12.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(1.1428%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Comparison of heatmaps generated by various encoder-decoder configurations for free left-turning from a single direction lane. This scenario evaluates the models’ ability to handle free turns without conflicting traffic and maintain accuracy in probabilistic occupancy prediction. </figcaption>
                        </figure>
                        <figure id="Sx1.F13" class="ltx_figure">
                            <div class="ltx_flex_figure">
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder0(6).png" id="Sx1.F13.sf1.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Encoder 0 + Decoder 0
                                            <br class="ltx_break">(19.8423%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder1(6).png" id="Sx1.F13.sf2.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Encoder 0 + Decoder 1
                                            <br class="ltx_break">(6.3746%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder0_decoder2(6).png" id="Sx1.F13.sf3.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Encoder 0 + Decoder 2
                                            <br class="ltx_break">(3.1745%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_break"></div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder0(6).png" id="Sx1.F13.sf4.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(d) </span>Encoder 1 + Decoder 0
                                            <br class="ltx_break">(23.2751%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder1(6).png" id="Sx1.F13.sf5.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(e) </span>Encoder 1 + Decoder 1
                                            <br class="ltx_break">(6.2957%)</figcaption>
                                    </figure>
                                </div>
                                <div class="ltx_flex_cell ltx_flex_size_3">
                                    <figure id="Sx1.F13.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="./pora_paper_demo_files/encoder1_decoder2(6).png" id="Sx1.F13.sf6.g1" class="ltx_graphics ltx_img_square" width="598" height="598" alt="Refer to caption">
                                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(f) </span>Encoder 1 + Decoder 2
                                            <br class="ltx_break">(3.5748%)</figcaption>
                                    </figure>
                                </div>
                            </div>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Comparison of heatmaps generated by various encoder-decoder configurations in a scenario with abnormal heading angles caused by the discrete nature of the simulator. This case results in significantly higher probabilities of non-drivable area predictions. <b>(Scenario: 2024-03-20-14-04-58, Warmup: 180)</b></figcaption>
                        </figure>

                        <h2 class="ltx_title ltx_title_section">Reproduction Demo </h2>
                        <h3 class="ltx_title ltx_title_subsection">(If your browser blocked the following demo, please use this <a href="http://128.32.156.165:8188/">Link</a>)</h3>
                        <!-- Container for the iframe and button -->
                        <div style="position: relative; width: 100%; height: 500px;">
                            <!-- Iframe -->
                            <iframe
                                    id="embedded-iframe"
                                    src="http://128.32.156.165:8188/"
                                    width="100%"
                                    height="100%"
                                    style="border: 1px solid #ccc;"
                                    title="Embedded Webpage">
                            </iframe>

                            <!-- Full-screen button -->
                            <button
                                    onclick="toggleFullScreen()"
                                    style="position: absolute; bottom: 10px; right: 10px; padding: 5px 10px; background: #007bff; color: white; border: none; cursor: pointer;">
                                Full Screen
                            </button>
                        </div>

                        <script>
                            function toggleFullScreen() {
                                const iframe = document.getElementById('embedded-iframe');

                                // Check if the iframe is already in full-screen mode
                                if (!document.fullscreenElement) {
                                    // Request full-screen mode for the iframe
                                    if (iframe.requestFullscreen) {
                                        iframe.requestFullscreen();
                                    } else if (iframe.mozRequestFullScreen) { // Firefox
                                        iframe.mozRequestFullScreen();
                                    } else if (iframe.webkitRequestFullscreen) { // Chrome, Safari, and Opera
                                        iframe.webkitRequestFullscreen();
                                    } else if (iframe.msRequestFullscreen) { // IE/Edge
                                        iframe.msRequestFullscreen();
                                    }
                                } else {
                                    // Exit full-screen mode
                                    if (document.exitFullscreen) {
                                        document.exitFullscreen();
                                    } else if (document.mozCancelFullScreen) { // Firefox
                                        document.mozCancelFullScreen();
                                    } else if (document.webkitExitFullscreen) { // Chrome, Safari, and Opera
                                        document.webkitExitFullscreen();
                                    } else if (document.msExitFullscreen) { // IE/Edge
                                        document.msExitFullscreen();
                                    }
                                }
                            }
                        </script>

                    </section>
                    <section id="bib" class="ltx_bibliography">
                        <h2 class="ltx_title ltx_title_bibliography">References</h2>

                        <ul class="ltx_biblist">
                            <li id="bib.bib1" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[1]</span>
                                <span class="ltx_bibblock">
Jonathan&nbsp;W Lee, Han Wang, Kathy Jang, Amaury Hayat, Matthew Bunting, Arwa
Alanqary, William Barbour, Zhe Fu, Xiaoqian Gong, George Gunter, et&nbsp;al.

</span>
                                <span class="ltx_bibblock">Traffic control via connected and automated vehicles: An open-road
field experiment with 100 cavs.

</span>
                                <span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">IEEE Control System Magazine, arXiv preprint arXiv:2402.17043</span>,
2024.

</span>
                            </li>
                            <li id="bib.bib2" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[2]</span>
                                <span class="ltx_bibblock">
Han Wang, Zhe Fu, Jonathan Lee, Hossein Nick&nbsp;Zinat Matin, Arwa Alanqary, Daniel
Urieli, Sharon Hornstein, Abdul&nbsp;Rahman Kreidieh, Raphael Chekroun, William
Barbour, et&nbsp;al.

</span>
                                <span class="ltx_bibblock">Hierarchical speed planner for automated vehicles: A framework for
lagrangian variable speed limit in mixed autonomy traffic.

</span>
                                <span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2402.16993</span>, 2024.

</span>
                            </li>
                            <li id="bib.bib3" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[3]</span>
                                <span class="ltx_bibblock">
Han Wang, H&nbsp;Nick&nbsp;Zinat Matin, and Maria&nbsp;Laura Delle&nbsp;Monache.

</span>
                                <span class="ltx_bibblock">Reinforcement learning-based adaptive speed controllers in mixed
autonomy condition.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">2024 European Control Conference (ECC)</span>, pages 1869–1874.
IEEE, 2024.

</span>
                            </li>
                            <li id="bib.bib4" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[4]</span>
                                <span class="ltx_bibblock">
Henggang Cui, Vladan Radosavljevic, Fang-Chieh Chou, Tsung-Han Lin, Thi
Nguyen-Tu Nguyen, Tzu-Kuo Huang, Jeff Schneider, and Nemanja Djuric.

</span>
                                <span class="ltx_bibblock">Multimodal trajectory predictions for autonomous driving using deep
convolutional networks.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 14424–14432, 2019.

</span>
                            </li>
                            <li id="bib.bib5" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[5]</span>
                                <span class="ltx_bibblock">
Yuning Chai, Benjamin Sapp, Mayank Bansal, and Dragomir Anguelov.

</span>
                                <span class="ltx_bibblock">Multipath: Multiple probabilistic anchor trajectory hypotheses for
behavior prediction.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Conference on Robot Learning</span>, pages 86–99. PMLR, 2019.

</span>
                            </li>
                            <li id="bib.bib6" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[6]</span>
                                <span class="ltx_bibblock">
Xinshuo Weng, Boris Ivanovic, Yan Wang, Yue Wang, and Marco Pavone.

</span>
                                <span class="ltx_bibblock">Para-drive: Parallelized architecture for real-time autonomous
driving.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 15449–15458, 2024.

</span>
                            </li>
                            <li id="bib.bib7" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[7]</span>
                                <span class="ltx_bibblock">
Marion Neumeier, Michael Botsch, Andreas Tollkühn, and Thomas Berberich.

</span>
                                <span class="ltx_bibblock">Variational autoencoder-based vehicle trajectory prediction with an
interpretable latent space.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">2021 IEEE International Intelligent Transportation Systems
Conference (ITSC)</span>, pages 820–827. IEEE, 2021.

</span>
                            </li>
                            <li id="bib.bib8" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[8]</span>
                                <span class="ltx_bibblock">
Boris Ivanovic and Marco Pavone.

</span>
                                <span class="ltx_bibblock">Multimodal future trajectory predictions using conditional
variational autoencoders.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">2020 IEEE International Conference on Robotics and Automation
(ICRA)</span>, pages 2774–2781. IEEE, 2020.

</span>
                            </li>
                            <li id="bib.bib9" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[9]</span>
                                <span class="ltx_bibblock">
Julian Wiederer, Julian Schmidt, Ulrich Kressel, Klaus Dietmayer, and Vasileios
Belagiannis.

</span>
                                <span class="ltx_bibblock">Joint out-of-distribution detection and uncertainty estimation for
trajectory prediction.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">2023 IEEE/RSJ International Conference on Intelligent Robots
and Systems (IROS)</span>, pages 5487–5494. IEEE, 2023.

</span>
                            </li>
                            <li id="bib.bib10" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[10]</span>
                                <span class="ltx_bibblock">
Juanwu Lu, Can Cui, Yunsheng Ma, Aniket Bera, and Ziran Wang.

</span>
                                <span class="ltx_bibblock">Quantifying uncertainty in motion prediction with variational
Bayesian mixture.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 15428–15437, 2024.

</span>
                            </li>
                            <li id="bib.bib11" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[11]</span>
                                <span class="ltx_bibblock">
Tim Salzmann, Boris Ivanovic, Punarjay Chakravarty, and Marco Pavone.

</span>
                                <span class="ltx_bibblock">Trajectron++: Dynamically-feasible trajectory forecasting with
heterogeneous data.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Computer Vision–ECCV 2020: 16th European Conference,
Glasgow, UK, August 23–28, 2020, Proceedings, Part XVIII 16</span>, pages
683–700. Springer, 2020.

</span>
                            </li>
                            <li id="bib.bib12" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[12]</span>
                                <span class="ltx_bibblock">
Amir Rasouli.

</span>
                                <span class="ltx_bibblock">Deep learning for vision-based prediction: A survey.

</span>
                                <span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.00095</span>, 2020.

</span>
                            </li>
                            <li id="bib.bib13" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[13]</span>
                                <span class="ltx_bibblock">
Han Wang, Haochen Wu, Juanwu Lu, Fang Tang, and Maria&nbsp;Laura Delle&nbsp;Monache.

</span>
                                <span class="ltx_bibblock">Communication optimization for multi-agent reinforcement
learning-based traffic control system with explainable protocol.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">2023 IEEE 26th International Conference on Intelligent
Transportation Systems (ITSC)</span>, pages 6068–6073. IEEE, 2023.

</span>
                            </li>
                            <li id="bib.bib14" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[14]</span>
                                <span class="ltx_bibblock">
Bernard Lange, Ekim Yurtsever, Seokcheon Yoon, and Mykel&nbsp;J Kochenderfer.

</span>
                                <span class="ltx_bibblock">Self-supervised multi-future occupancy forecasting for autonomous
driving.

</span>
                                <span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2407.21126</span>, 2023.

</span>
                            </li>
                            <li id="bib.bib15" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[15]</span>
                                <span class="ltx_bibblock">
Jiazhi Yang, Shenyuan Gao, Yihang Qiu, Li&nbsp;Chen, Tianyu Li, Bo&nbsp;Dai, Kashyap
Chitta, Penghao Wu, Jia Zeng, Ping Luo, et&nbsp;al.

</span>
                                <span class="ltx_bibblock">Generalized predictive model for autonomous driving.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 14662–14672, 2024.

</span>
                            </li>
                            <li id="bib.bib16" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[16]</span>
                                <span class="ltx_bibblock">
Eivind Meyer, Lars&nbsp;Frederik Peiss, and Matthias Althoff.

</span>
                                <span class="ltx_bibblock">Deep occupancy-predictive representations for autonomous driving.

</span>
                                <span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.04218</span>, 2023.

</span>
                            </li>
                            <li id="bib.bib17" class="ltx_bibitem">
                                <span class="ltx_tag ltx_tag_bibitem">[17]</span>
                                <span class="ltx_bibblock">
Benjamin Wilson, William Qi, Tanmay Agarwal, John Lambert, Jagjeet Singh,
Siddhesh Khandelwal, Bowen Pan, Ratnesh Kumar, Andrew Hartnett,
Jhony&nbsp;Kaesemodel Pontes, Deva Ramanan, Peter Carr, and James Hays.

</span>
                                <span class="ltx_bibblock">Argoverse 2: Next generation datasets for self-driving perception and
forecasting.

</span>
                                <span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the Neural Information Processing Systems
Track on Datasets and Benchmarks (NeurIPS Datasets and Benchmarks 2021)</span>,
2021.

</span>
                            </li>
                        </ul>
                    </section>
                </article>
            </div>

        </div></body>
    </div>

    <!-- Right Column: Comments -->
    <div class="right-column">
        <div class="header">
            <h1>Comments</h1>
        </div>

        <!-- Comment Collection for Introduction -->
        <div class="comment-collection" id="comment1">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Introduction</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 3</span>
                        <span class="vote-down">👎 1</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        Consider elaborating on the importance of the key areas highlighted in the introduction.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 3</span>
                            <span class="vote-down">👎 1</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                I agree. Maybe we could add examples from recent papers in the field.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by John Doe • 2 days ago</div>
                        </div>
                        <div class="comment-reply">
                            <div class="comment-body">
                                Good suggestion. I can help provide some relevant examples.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 2</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Jane Smith • 1 day ago</div>
                        </div>
                    </div>
                </div>
                <div class="comment">
                    <div class="comment-body">
                        The introduction could use more concrete examples.
                        <span class="comment-status status-solved">Solved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 1</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                I've added three examples from recent literature.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Author • 3 days ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Example of another comment collection -->
        <div class="comment-collection" id="comment2">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Background</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 4</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        The background section could benefit from a brief mention of newer studies from 2023-2024.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 4</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                Here are some relevant papers from 2023: [links to papers]
                                <span class="vote-stats">
                                    <span class="vote-up">👍 2</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Sarah Johnson • 1 day ago</div>
                        </div>
                        <div class="comment-reply">
                            <div class="comment-body">
                                Don't forget to include the breakthrough paper by Smith et al. (2024)
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Mike Brown • 12 hours ago</div>
                        </div>
                    </div>
                </div>
                <div class="comment">
                    <div class="comment-body">
                        Previous literature review is comprehensive.
                        <span class="comment-status status-solved">Solved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 2</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                Agreed, the historical context is well covered.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Reviewer 2 • 4 days ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Collection for Methodology -->
        <div class="comment-collection" id="comment3">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Methodology</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 5</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        The methodology needs more detail about sample size calculations.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 5</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                We should include power analysis results too.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 3</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Statistical Reviewer • 2 days ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Collection for Statistical Analyses -->
        <div class="comment-collection" id="comment4">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Statistical Analyses</span>
                    <span class="comment-status status-solved">Solved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 2</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        Consider adding confidence intervals to all estimates.
                        <span class="comment-status status-solved">Solved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 2</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                Added 95% CIs to all main analyses.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Author • 1 day ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Collection for Key Findings -->
        <div class="comment-collection" id="comment5">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Key Findings</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 3</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        The implications of finding #3 need more discussion.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 3</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                This could be linked to Theory X from Smith (2023).
                                <span class="vote-stats">
                                    <span class="vote-up">👍 2</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Expert Reviewer • 1 day ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Collection for Additional Insights -->
        <div class="comment-collection" id="comment6">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Additional Insights</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 2</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        The supplementary materials could be better organized.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 2</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                I suggest creating a table of contents for the appendices.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Editor • 3 hours ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comment Collection for Research Impact -->
        <div class="comment-collection" id="comment7">
            <div class="comment-collection-header">
                <div>
                    <span class="comment-header">Comment on Research Impact</span>
                    <span class="comment-status status-unsolved">Unsolved</span>
                    <span class="vote-stats">
                        <span class="vote-up">👍 4</span>
                        <span class="vote-down">👎 0</span>
                    </span>
                </div>
            </div>
            <div class="comment-collection-content">
                <div class="comment">
                    <div class="comment-body">
                        Consider adding specific industry applications.
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">👍 4</span>
                            <span class="vote-down">👎 0</span>
                        </span>
                    </div>
                    <div class="comment-replies">
                        <div class="comment-reply">
                            <div class="comment-body">
                                The automotive sector could particularly benefit from these findings.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 2</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Industry Expert • 1 day ago</div>
                        </div>
                        <div class="comment-reply">
                            <div class="comment-body">
                                Healthcare applications should also be mentioned.
                                <span class="vote-stats">
                                    <span class="vote-up">👍 1</span>
                                    <span class="vote-down">👎 0</span>
                                </span>
                            </div>
                            <div class="reply-metadata">Reply by Medical Researcher • 12 hours ago</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Update the highlight click handler
    document.querySelectorAll('.highlight').forEach(highlight => {
        highlight.addEventListener('click', () => {
            const commentId = highlight.getAttribute('data-comment');
            const commentElement = document.getElementById(commentId);
            const rightColumn = document.querySelector('.right-column');

            if (commentElement) {
                // Remove any existing flash effects
                document.querySelectorAll('.comment-collection-header').forEach(header => {
                    header.classList.remove('flash-effect');
                });

                // Add flash effect to the header instead of the whole collection
                const header = commentElement.querySelector('.comment-collection-header');
                header.classList.add('flash-effect');

                // Automatically expand the content
                const content = commentElement.querySelector('.comment-collection-content');
                content.classList.add('expanded');

                // Calculate scroll position relative to right column
                const rightColumnTop = rightColumn.getBoundingClientRect().top;
                const commentTop = commentElement.getBoundingClientRect().top;
                const scrollPosition = commentTop - rightColumnTop + rightColumn.scrollTop;

                // Scroll only the right column
                rightColumn.scrollTo({
                    top: scrollPosition,
                    behavior: 'smooth'
                });

                // Optional: Remove the flash effect after animation completes
                setTimeout(() => {
                    header.classList.remove('flash-effect');
                }, 1000);
            }
        });
    });

    // Add toggle functionality for comment collections
    document.querySelectorAll('.comment-collection-header').forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            content.classList.toggle('expanded');
        });
    });

    // Function to find the highest voted unsolved comment
    function updateCollectionHeaders() {
        document.querySelectorAll('.comment-collection').forEach(collection => {
            const comments = collection.querySelectorAll('.comment');
            let highestVoted = null;
            let maxScore = -1;

            comments.forEach(comment => {
                const status = comment.querySelector('.comment-status').textContent;
                if (status === 'Unsolved') {
                    const upVotes = parseInt(comment.querySelector('.vote-up').textContent.split(' ')[1]);
                    const downVotes = parseInt(comment.querySelector('.vote-down').textContent.split(' ')[1]);
                    const score = upVotes - downVotes;
                    if (score > maxScore) {
                        maxScore = score;
                        highestVoted = comment;
                    }
                }
            });

            if (highestVoted) {
                const header = collection.querySelector('.comment-collection-header');
                const headerStatus = header.querySelector('.comment-status');
                const headerVoteStats = header.querySelector('.vote-stats');
                const commentContent = highestVoted.querySelector('.comment-body').childNodes[0].textContent.trim();

                // Update header structure
                header.innerHTML = `
                    <div class="header-title">
                        <span class="comment-header">${collection.querySelector('.comment-header').textContent}</span>
                        <span class="comment-status status-unsolved">Unsolved</span>
                        <span class="vote-stats">
                            <span class="vote-up">${highestVoted.querySelector('.vote-up').textContent}</span>
                            <span class="vote-down">${highestVoted.querySelector('.vote-down').textContent}</span>
                        </span>
                    </div>
                    <div class="header-preview">${commentContent}</div>
                `;
            }
        });
    }

    // Initialize headers
    updateCollectionHeaders();

    // Add toggle functionality
    const toggleButton = document.getElementById('toggleComments');
    const rightColumn = document.querySelector('.right-column');
    const leftColumn = document.querySelector('.left-column');
    let isHidden = false;

    toggleButton.addEventListener('click', () => {
        isHidden = !isHidden;
        rightColumn.classList.toggle('hidden');
        leftColumn.classList.toggle('expanded');
        toggleButton.textContent = isHidden ? 'Show Comments' : 'Hide Comments';
    });
</script>
</body>

</html>
